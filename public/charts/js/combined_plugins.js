/*
 * Copyright (c) 2011 
 * ==================================
 * 
 *
 * This is part of an item on themeforest
 * You can check out the screenshots and purchase it on themeforest:
 * http://rxa.li/whitelabel
 * 
 * 
 * ===========================================
 * original filename: _combined_plugins.js
 * filesize: 859937 Bytes
 * last modified: Sun, 20 Nov 2011 21:02:08 +0100
 *
 */
(function($){$.support.touch=typeof Touch==='object';if(!$.support.touch){return}var mouseProto=$.ui.mouse.prototype,_mouseInit=mouseProto._mouseInit,_mouseDown=mouseProto._mouseDown,_mouseUp=mouseProto._mouseUp,mouseEvents={touchstart:'mousedown',touchmove:'mousemove',touchend:'mouseup'};function makeMouseEvent(event){event.stopPropagation();var touch=event.originalEvent.changedTouches[0];return $.extend(event,{type:mouseEvents[event.type],which:1,pageX:touch.pageX,pageY:touch.pageY,screenX:touch.screenX,screenY:touch.screenY,clientX:touch.clientX,clientY:touch.clientY})}mouseProto._mouseInit=function(){var self=this;self.element.bind('touchstart.'+self.widgetName,function(event){return self._mouseDown(makeMouseEvent(event))});_mouseInit.call(self)};mouseProto._mouseDown=function(event){var self=this,ret=_mouseDown.call(self,event);if(self.options.handle&&!$(event.target).is(self.options.handle)){mouseProto._mouseUp(event);return}self._touchMoveDelegate=function(event){return self._mouseMove(makeMouseEvent(event))};self._touchEndDelegate=function(event){return self._mouseUp(makeMouseEvent(event))};$(document).bind('touchmove.'+self.widgetName,self._touchMoveDelegate).bind('touchend.'+self.widgetName,self._touchEndDelegate);return ret};mouseProto._mouseUp=function(event){var self=this;$(document).unbind('touchmove.'+self.widgetName,self._touchMoveDelegate).unbind('touchend.'+self.widgetName,self._touchEndDelegate);return _mouseUp.call(self,event)}})(jQuery);(function($){$.event.special.mousewheel={setup:function(){var handler=$.event.special.mousewheel.handler;if($.browser.mozilla)$(this).bind('mousemove.mousewheel',function(event){$.data(this,'mwcursorposdata',{pageX:event.pageX,pageY:event.pageY,clientX:event.clientX,clientY:event.clientY})});if(this.addEventListener)this.addEventListener(($.browser.mozilla?'DOMMouseScroll':'mousewheel'),handler,false);else this.onmousewheel=handler},teardown:function(){var handler=$.event.special.mousewheel.handler;$(this).unbind('mousemove.mousewheel');if(this.removeEventListener)this.removeEventListener(($.browser.mozilla?'DOMMouseScroll':'mousewheel'),handler,false);else this.onmousewheel=function(){};$.removeData(this,'mwcursorposdata')},handler:function(event){var args=Array.prototype.slice.call(arguments,1);event=$.event.fix(event||window.event);$.extend(event,$.data(this,'mwcursorposdata')||{});var delta=0,returnValue=true;if(event.wheelDelta){delta=(event.wheelDelta/120)}if(event.detail){delta=(-event.detail/3)}event.data=event.data||{};event.type="mousewheel";args.unshift(delta);args.unshift(event);return $.event.handle.apply(this,args)}};$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")},unmousewheel:function(fn){return this.unbind("mousewheel",fn)}})})(jQuery);(function($){function fixTitle($ele){if($ele.attr('title')||typeof($ele.attr('original-title'))!='string'){$ele.attr('original-title',$ele.attr('title')||'').removeAttr('title')}}function Tipsy(element,options){this.$element=$(element);this.options=options;this.enabled=true;fixTitle(this.$element)}Tipsy.prototype={show:function(){var title=this.getTitle();if(title&&this.enabled){var $tip=this.tip();$tip.find('.tipsy-inner')[this.options.html?'html':'text'](title);$tip[0].className='tipsy';$tip.remove().css({top:0,left:0,visibility:'hidden',display:'block'}).appendTo(this.options.appendTo);var pos=$.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});if(this.options.appendTo!='body')pos.top=pos.left=0;var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;var gravity=(typeof this.options.gravity=='function')?this.options.gravity.call(this.$element[0]):this.options.gravity;var tp;var mp;switch(gravity.charAt(0)){case'n':tp={top:pos.top+pos.height+this.options.offset,left:pos.left+pos.width/2-actualWidth/2};mp={top:15,left:-actualWidth/2};break;case's':tp={top:pos.top-actualHeight-this.options.offset,left:pos.left+pos.width/2-actualWidth/2};mp={top:-actualHeight-15,left:-actualWidth/2};break;case'e':tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth-this.options.offset};mp={top:-actualHeight/2,left:-12-actualWidth};break;case'w':tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width+this.options.offset};mp={top:-actualHeight/2,left:12};break}if(gravity.length==2){if(gravity.charAt(1)=='w'){tp.left=pos.left-5;mp.left+=actualWidth/2-15}else{mp.left-=actualWidth/2-15;tp.left=pos.left+pos.width-actualWidth+5}}if(this.options.followMouse){$(document).bind('mousemove.tipsy',function(e){var x=e.pageX+mp.left,y=e.pageY+mp.top;$tip.css({left:x,top:y})})}$tip.css(tp).addClass('tipsy-'+gravity);if(this.options.fade){$tip.stop().css({opacity:0,display:'block',visibility:'visible'}).animate({opacity:this.options.opacity})}else{$tip.css({visibility:'visible',opacity:this.options.opacity})}}},hide:function(){if(this.options.followMouse){$(document).unbind('mousemove.tipsy')}if(this.options.fade){this.tip().stop().fadeOut(function(){$(this).remove()})}else{this.tip().remove()}},getTitle:function(){var title,$e=this.$element,o=this.options;fixTitle($e);var title,o=this.options;if(typeof o.title=='string'){title=$e.attr(o.title=='title'?'original-title':o.title)}else if(typeof o.title=='function'){title=o.title.call($e[0])}if(!title)title=o.fallback;title=(''+title).replace(/(^\s*|\s*$)/,"");return title||o.fallback},setTitel:function(title){this.options.fallback=title},tip:function(){if(!this.$tip){this.$tip=$('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-outer"><div class="tipsy-inner"/></div></div>')}return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},update:function(){var $tip=this.tip();$tip.find('.tipsy-inner')[this.options.html?'html':'text'](this.options.fallback)},toggleEnabled:function(){this.enabled=!this.enabled}};$.fn.tipsy=function(options){if(options===true){return this.data('tipsy')}else if(typeof options=='string'){return this.data('tipsy')[options](arguments[1],arguments[2])}options=$.extend({},$.fn.tipsy.defaults,options);function get(ele){var tipsy=$.data(ele,'tipsy');if(!tipsy){tipsy=new Tipsy(ele,$.fn.tipsy.elementOptions(ele,options));$.data(ele,'tipsy',tipsy)}return tipsy}function enter(){var tipsy=get(this);tipsy.hoverState='in';if(options.delayIn==0){tipsy.show()}else{setTimeout(function(){if(tipsy.hoverState=='in')tipsy.show()},options.delayIn)}};function leave(){var tipsy=get(this);tipsy.hoverState='out';if(options.delayOut==0){tipsy.hide()}else{setTimeout(function(){if(tipsy.hoverState=='out')tipsy.hide()},options.delayOut)}};if(!options.live)this.each(function(){get(this)});if(options.trigger!='manual'){var binder=options.live?'live':'bind',eventIn=options.trigger=='hover'?'mouseenter':'focus',eventOut=options.trigger=='hover'?'mouseleave':'blur';this[binder](eventIn+'.tipsy',enter)[binder](eventOut+'.tipsy',leave)}return this};$.fn.tipsy.defaults={delayIn:0,delayOut:0,fade:false,fallback:'',gravity:'n',html:false,live:false,offset:0,opacity:0.8,followMouse:false,appendTo:'body',title:'title',trigger:'hover'};$.fn.tipsy.elementOptions=function(ele,options){return $.metadata?$.extend({},options,$(ele).metadata()):options};$.fn.tipsy.autoNS=function(){return $(this).offset().top>($(document).scrollTop()+$(window).height()/2)?'s':'n'};$.fn.tipsy.autoWE=function(){return $(this).offset().left>($(document).scrollLeft()+$(window).width()/2)?'e':'w'}})(jQuery);(function($){$.uniform={options:{selectClass:'selector',radioClass:'radio',checkboxClass:'checker',fileClass:'uploader',filenameClass:'filename',fileBtnClass:'action',fileDefaultText:'No file selected',fileBtnText:'Choose File',checkedClass:'checked',focusClass:'focus',disabledClass:'disabled',buttonClass:'button',activeClass:'active',hoverClass:'hover',useID:true,idPrefix:'uniform',resetSelector:false,autoHide:true},elements:[]};if($.browser.msie&&$.browser.version<7){$.support.selectOpacity=false}else{$.support.selectOpacity=true}$.fn.uniform=function(options){options=$.extend($.uniform.options,options);var el=this;if(options.resetSelector!=false){$(options.resetSelector).mouseup(function(){function resetThis(){$.uniform.update(el)}setTimeout(resetThis,10)})}function doInput(elem){$el=$(elem);$el.addClass($el.attr("type"));storeElement(elem)}function doTextarea(elem){$(elem).addClass("uniform");storeElement(elem)}function doButton(elem){var $el=$(elem);var divTag=$("<div>"),spanTag=$("<span>");divTag.addClass(options.buttonClass);if(options.useID&&$el.attr("id")!="")divTag.attr("id",options.idPrefix+"-"+$el.attr("id"));var btnText;if($el.is("a")||$el.is("button")){btnText=$el.text()}else if($el.is(":submit")||$el.is(":reset")||$el.is("input[type=button]")){btnText=$el.attr("value")}btnText=btnText==""?$el.is(":reset")?"Reset":"Submit":btnText;spanTag.html(btnText);$el.css("opacity",0);$el.wrap(divTag);$el.wrap(spanTag);divTag=$el.closest("div");spanTag=$el.closest("span");if($el.is(":disabled"))divTag.addClass(options.disabledClass);divTag.bind({"mouseenter.uniform":function(){divTag.addClass(options.hoverClass)},"mouseleave.uniform":function(){divTag.removeClass(options.hoverClass);divTag.removeClass(options.activeClass)},"mousedown.uniform touchbegin.uniform":function(){divTag.addClass(options.activeClass)},"mouseup.uniform touchend.uniform":function(){divTag.removeClass(options.activeClass)},"click.uniform touchend.uniform":function(e){if($(e.target).is("span")||$(e.target).is("div")){if(elem[0].dispatchEvent){var ev=document.createEvent('MouseEvents');ev.initEvent('click',true,true);elem[0].dispatchEvent(ev)}else{elem[0].click()}}}});elem.bind({"focus.uniform":function(){divTag.addClass(options.focusClass)},"blur.uniform":function(){divTag.removeClass(options.focusClass)}});$.uniform.noSelect(divTag);storeElement(elem)}function doSelect(elem){var $el=$(elem);var divTag=$('<div />'),spanTag=$('<span />');if(!$el.css("display")=="none"&&options.autoHide){divTag.hide()}divTag.addClass(options.selectClass);if(options.useID&&elem.attr("id")!=""){divTag.attr("id",options.idPrefix+"-"+elem.attr("id"))}var selected=elem.find(":selected:first");if(selected.length==0){selected=elem.find("option:first")}spanTag.html(selected.html());elem.css('opacity',0);elem.wrap(divTag);elem.before(spanTag);divTag=elem.parent("div");spanTag=elem.siblings("span");elem.bind({"change.uniform":function(){spanTag.text(elem.find(":selected").html());divTag.removeClass(options.activeClass)},"focus.uniform":function(){divTag.addClass(options.focusClass)},"blur.uniform":function(){divTag.removeClass(options.focusClass);divTag.removeClass(options.activeClass)},"mousedown.uniform touchbegin.uniform":function(){divTag.addClass(options.activeClass)},"mouseup.uniform touchend.uniform":function(){divTag.removeClass(options.activeClass)},"click.uniform touchend.uniform":function(){divTag.removeClass(options.activeClass)},"mouseenter.uniform":function(){divTag.addClass(options.hoverClass)},"mouseleave.uniform":function(){divTag.removeClass(options.hoverClass);divTag.removeClass(options.activeClass)},"keyup.uniform":function(){spanTag.text(elem.find(":selected").html())}});if($(elem).attr("disabled")){divTag.addClass(options.disabledClass)}$.uniform.noSelect(spanTag);storeElement(elem)}function doCheckbox(elem){var $el=$(elem);var divTag=$('<div />'),spanTag=$('<span />');if(!$el.css("display")=="none"&&options.autoHide){divTag.hide()}divTag.addClass(options.checkboxClass);if(options.useID&&elem.attr("id")!=""){divTag.attr("id",options.idPrefix+"-"+elem.attr("id"))}$(elem).wrap(divTag);$(elem).wrap(spanTag);spanTag=elem.parent();divTag=spanTag.parent();$(elem).css("opacity",0).bind({"focus.uniform":function(){divTag.addClass(options.focusClass)},"blur.uniform":function(){divTag.removeClass(options.focusClass)},"click.uniform touchend.uniform":function(){if(!$(elem).attr("checked")){spanTag.removeClass(options.checkedClass)}else{spanTag.addClass(options.checkedClass)}},"mousedown.uniform touchbegin.uniform":function(){divTag.addClass(options.activeClass)},"mouseup.uniform touchend.uniform":function(){divTag.removeClass(options.activeClass)},"mouseenter.uniform":function(){divTag.addClass(options.hoverClass)},"mouseleave.uniform":function(){divTag.removeClass(options.hoverClass);divTag.removeClass(options.activeClass)}});if($(elem).attr("checked")){spanTag.addClass(options.checkedClass)}if($(elem).attr("disabled")){divTag.addClass(options.disabledClass)}storeElement(elem)}function doRadio(elem){var $el=$(elem);var divTag=$('<div />'),spanTag=$('<span />');if(!$el.css("display")=="none"&&options.autoHide){divTag.hide()}divTag.addClass(options.radioClass);if(options.useID&&elem.attr("id")!=""){divTag.attr("id",options.idPrefix+"-"+elem.attr("id"))}$(elem).wrap(divTag);$(elem).wrap(spanTag);spanTag=elem.parent();divTag=spanTag.parent();$(elem).css("opacity",0).bind({"focus.uniform":function(){divTag.addClass(options.focusClass)},"blur.uniform":function(){divTag.removeClass(options.focusClass)},"click.uniform touchend.uniform":function(){if(!$(elem).attr("checked")){spanTag.removeClass(options.checkedClass)}else{var classes=options.radioClass.split(" ")[0];$("."+classes+" span."+options.checkedClass+":has([name='"+$(elem).attr('name')+"'])").removeClass(options.checkedClass);spanTag.addClass(options.checkedClass)}},"mousedown.uniform touchend.uniform":function(){if(!$(elem).is(":disabled")){divTag.addClass(options.activeClass)}},"mouseup.uniform touchbegin.uniform":function(){divTag.removeClass(options.activeClass)},"mouseenter.uniform touchend.uniform":function(){divTag.addClass(options.hoverClass)},"mouseleave.uniform":function(){divTag.removeClass(options.hoverClass);divTag.removeClass(options.activeClass)}});if($(elem).attr("checked")){spanTag.addClass(options.checkedClass)}if($(elem).attr("disabled")){divTag.addClass(options.disabledClass)}storeElement(elem)}function doFile(elem){var $el=$(elem);var divTag=$('<div />'),filenameTag=$('<span>'+options.fileDefaultText+'</span>'),btnTag=$('<span>'+options.fileBtnText+'</span>');if(!$el.css("display")=="none"&&options.autoHide){divTag.hide()}divTag.addClass(options.fileClass);filenameTag.addClass(options.filenameClass);btnTag.addClass(options.fileBtnClass);if(options.useID&&$el.attr("id")!=""){divTag.attr("id",options.idPrefix+"-"+$el.attr("id"))}$el.wrap(divTag);$el.after(btnTag);$el.after(filenameTag);divTag=$el.closest("div");filenameTag=$el.siblings("."+options.filenameClass);btnTag=$el.siblings("."+options.fileBtnClass);if(!$el.attr("size")){var divWidth=divTag.width();$el.attr("size",divWidth/10)}var setFilename=function(){var filename=$el.val();if(filename===''){filename=options.fileDefaultText}else{filename=filename.split(/[\/\\]+/);filename=filename[(filename.length-1)]}filenameTag.text(filename)};setFilename();$el.css("opacity",0).bind({"focus.uniform":function(){divTag.addClass(options.focusClass)},"blur.uniform":function(){divTag.removeClass(options.focusClass)},"mousedown.uniform":function(){if(!$(elem).is(":disabled")){divTag.addClass(options.activeClass)}},"mouseup.uniform":function(){divTag.removeClass(options.activeClass)},"mouseenter.uniform":function(){divTag.addClass(options.hoverClass)},"mouseleave.uniform":function(){divTag.removeClass(options.hoverClass);divTag.removeClass(options.activeClass)}});if($.browser.msie){$el.bind('click.uniform.ie7',function(){setTimeout(setFilename,0)})}else{$el.bind('change.uniform',setFilename)}if($el.attr("disabled")){divTag.addClass(options.disabledClass)}$.uniform.noSelect(filenameTag);$.uniform.noSelect(btnTag);storeElement(elem)}$.uniform.restore=function(elem){if(elem==undefined){elem=$($.uniform.elements)}$(elem).each(function(){if($(this).is(":checkbox")){$(this).unwrap().unwrap()}else if($(this).is("select")){$(this).siblings("span").remove();$(this).unwrap()}else if($(this).is(":radio")){$(this).unwrap().unwrap()}else if($(this).is(":file")){$(this).siblings("span").remove();$(this).unwrap()}else if($(this).is("button, :submit, :reset, a, input[type='button']")){$(this).unwrap().unwrap()}$(this).unbind(".uniform");$(this).css("opacity","1");var index=$.inArray($(elem),$.uniform.elements);$.uniform.elements.splice(index,1)})};function storeElement(elem){elem=$(elem).get();if(elem.length>1){$.each(elem,function(i,val){$.uniform.elements.push(val)})}else{$.uniform.elements.push(elem)}}$.uniform.noSelect=function(elem){function f(){return false};$(elem).each(function(){this.onselectstart=this.ondragstart=f;$(this).mousedown(f).css({MozUserSelect:'none'})})};$.uniform.update=function(elem){if(elem==undefined){elem=$($.uniform.elements)}elem=$(elem);elem.each(function(){var $e=$(this);if($e.is("select")){var spanTag=$e.siblings("span");var divTag=$e.parent("div");divTag.removeClass(options.hoverClass+" "+options.focusClass+" "+options.activeClass);spanTag.html($e.find(":selected").html());if($e.is(":disabled")){divTag.addClass(options.disabledClass)}else{divTag.removeClass(options.disabledClass)}}else if($e.is(":checkbox")){var spanTag=$e.closest("span");var divTag=$e.closest("div");divTag.removeClass(options.hoverClass+" "+options.focusClass+" "+options.activeClass);spanTag.removeClass(options.checkedClass);if($e.is(":checked")){spanTag.addClass(options.checkedClass)}if($e.is(":disabled")){divTag.addClass(options.disabledClass)}else{divTag.removeClass(options.disabledClass)}}else if($e.is(":radio")){var spanTag=$e.closest("span");var divTag=$e.closest("div");divTag.removeClass(options.hoverClass+" "+options.focusClass+" "+options.activeClass);spanTag.removeClass(options.checkedClass);if($e.is(":checked")){spanTag.addClass(options.checkedClass)}if($e.is(":disabled")){divTag.addClass(options.disabledClass)}else{divTag.removeClass(options.disabledClass)}}else if($e.is(":file")){var divTag=$e.parent("div");var filenameTag=$e.siblings(options.filenameClass);btnTag=$e.siblings(options.fileBtnClass);divTag.removeClass(options.hoverClass+" "+options.focusClass+" "+options.activeClass);filenameTag.text($e.val());if($e.is(":disabled")){divTag.addClass(options.disabledClass)}else{divTag.removeClass(options.disabledClass)}}else if($e.is(":submit")||$e.is(":reset")||$e.is("button")||$e.is("a")||elem.is("input[type=button]")){var divTag=$e.closest("div");divTag.removeClass(options.hoverClass+" "+options.focusClass+" "+options.activeClass);if($e.is(":disabled")){divTag.addClass(options.disabledClass)}else{divTag.removeClass(options.disabledClass)}}})};return this.each(function(){if($.support.selectOpacity){var elem=$(this);if(elem.is("select")){if(elem.attr("multiple")!=true){if(elem.attr("size")==undefined||elem.attr("size")<=1){doSelect(elem)}}}else if(elem.is(":checkbox")){doCheckbox(elem)}else if(elem.is(":radio")){doRadio(elem)}else if(elem.is(":file")){doFile(elem)}else if(elem.is(":text, :password, input[type='email']")){doInput(elem)}else if(elem.is("textarea")){doTextarea(elem)}else if(elem.is("a")||elem.is(":submit")||elem.is(":reset")||elem.is("button")||elem.is("input[type=button]")){doButton(elem)}}})}})(jQuery);(function(jQuery){jQuery.fn.extend({elastic:function(){var mimics=['paddingTop','paddingRight','paddingBottom','paddingLeft','fontSize','lineHeight','fontFamily','width','fontWeight'];return this.each(function(){if(this.type!='textarea'){return false}var $textarea=jQuery(this),$twin=jQuery('<div />').css({'position':'absolute','display':'none','word-wrap':'break-word'}),lineHeight=parseInt($textarea.css('line-height'),10)||parseInt($textarea.css('font-size'),'10'),minheight=parseInt($textarea.css('height'),10)||lineHeight*3,maxheight=parseInt($textarea.css('max-height'),10)||Number.MAX_VALUE,goalheight=0,i=0;if(maxheight<0){maxheight=Number.MAX_VALUE}$twin.appendTo($textarea.parent());var i=mimics.length;while(i--){$twin.css(mimics[i].toString(),$textarea.css(mimics[i].toString()))}function setHeightAndOverflow(height,overflow){curratedHeight=Math.floor(parseInt(height,10));if($textarea.height()!=curratedHeight){$textarea.css({'height':curratedHeight+'px','overflow':overflow})}}function update(){var textareaContent=$textarea.val().replace(/&/g,'&amp;').replace(/  /g,'&nbsp;').replace(/<|>/g,'&gt;').replace(/\n/g,'<br />');var twinContent=$twin.html().replace(/<br>/ig,'<br />');if(textareaContent+'&nbsp;'!=twinContent){$twin.html(textareaContent+'&nbsp;');if(Math.abs($twin.height()+lineHeight-$textarea.height())>3){var goalheight=$twin.height()+lineHeight;if(goalheight>=maxheight){setHeightAndOverflow(maxheight,'auto')}else if(goalheight<=minheight){setHeightAndOverflow(minheight,'hidden')}else{setHeightAndOverflow(goalheight,'hidden')}}}}$textarea.css({'overflow':'hidden'});$textarea.bind('keyup change cut paste',function(){update()});$textarea.bind('blur',function(){if($twin.height()<maxheight){if($twin.height()>minheight){$textarea.height($twin.height())}else{$textarea.height(minheight)}}});$textarea.live('input paste',function(e){setTimeout(update,250)});update()})}})})(jQuery);(function($){$.fn.miniColors=function(o,data){var create=function(input,o,data){var color=cleanHex(input.val());if(!color)color='FFFFFF';var hsb=hex2hsb(color);var trigger=$('<a class="miniColors-trigger" style="background-color: #'+color+'" href="#"></a>');trigger.insertAfter(input);input.addClass('miniColors').attr('maxlength',7).attr('autocomplete','off');input.data('trigger',trigger);input.data('hsb',hsb);if(o.change)input.data('change',o.change);if(o.readonly)input.attr('readonly',true);if(o.disabled)disable(input);trigger.bind('click.miniColors',function(event){event.preventDefault();input.trigger('focus')});input.bind('focus.miniColors',function(event){show(input)});input.bind('blur.miniColors',function(event){var hex=cleanHex(input.val());input.val(hex?'#'+hex:'')});input.bind('keydown.miniColors',function(event){if(event.keyCode===9)hide(input)});input.bind('keyup.miniColors',function(event){var filteredHex=input.val().replace(/[^A-F0-9#]/ig,'');input.val(filteredHex);if(!setColorFromInput(input)){input.data('trigger').css('backgroundColor','#FFF')}});input.bind('paste.miniColors',function(event){setTimeout(function(){input.trigger('keyup')},5)})};var destroy=function(input){hide();input=$(input);input.data('trigger').remove();input.removeAttr('autocomplete');input.removeData('trigger');input.removeData('selector');input.removeData('hsb');input.removeData('huePicker');input.removeData('colorPicker');input.removeData('mousebutton');input.removeData('moving');input.unbind('click.miniColors');input.unbind('focus.miniColors');input.unbind('blur.miniColors');input.unbind('keyup.miniColors');input.unbind('keydown.miniColors');input.unbind('paste.miniColors');$(document).unbind('mousedown.miniColors');$(document).unbind('mousemove.miniColors')};var enable=function(input){input.attr('disabled',false);input.data('trigger').css('opacity',1)};var disable=function(input){hide(input);input.attr('disabled',true);input.data('trigger').css('opacity',.5)};var show=function(input){if(input.attr('disabled'))return false;hide();var selector=$('<div class="miniColors-selector"></div>');selector.append('<div class="miniColors-colors" style="background-color: #FFF;"><div class="miniColors-colorPicker"></div></div>');selector.append('<div class="miniColors-hues"><div class="miniColors-huePicker"></div></div>');selector.css({top:input.is(':visible')?input.offset().top+input.outerHeight():input.data('trigger').offset().top+input.data('trigger').outerHeight(),left:input.is(':visible')?input.offset().left:input.data('trigger').offset().left,display:'none'}).addClass(input.attr('class'));var hsb=input.data('hsb');selector.find('.miniColors-colors').css('backgroundColor','#'+hsb2hex({h:hsb.h,s:100,b:100}));var colorPosition=input.data('colorPosition');if(!colorPosition)colorPosition=getColorPositionFromHSB(hsb);selector.find('.miniColors-colorPicker').css('top',colorPosition.y+'px').css('left',colorPosition.x+'px');var huePosition=input.data('huePosition');if(!huePosition)huePosition=getHuePositionFromHSB(hsb);selector.find('.miniColors-huePicker').css('top',huePosition.y+'px');input.data('selector',selector);input.data('huePicker',selector.find('.miniColors-huePicker'));input.data('colorPicker',selector.find('.miniColors-colorPicker'));input.data('mousebutton',0);$('BODY').append(selector);selector.fadeIn(100);selector.bind('selectstart',function(){return false});$(document).bind('mousedown.miniColors',function(event){input.data('mousebutton',1);if($(event.target).parents().andSelf().hasClass('miniColors-colors')){event.preventDefault();input.data('moving','colors');moveColor(input,event)}if($(event.target).parents().andSelf().hasClass('miniColors-hues')){event.preventDefault();input.data('moving','hues');moveHue(input,event)}if($(event.target).parents().andSelf().hasClass('miniColors-selector')){event.preventDefault();return}if($(event.target).parents().andSelf().hasClass('miniColors'))return;hide(input)});$(document).bind('mouseup.miniColors',function(event){input.data('mousebutton',0);input.removeData('moving')});$(document).bind('mousemove.miniColors',function(event){if(input.data('mousebutton')===1){if(input.data('moving')==='colors')moveColor(input,event);if(input.data('moving')==='hues')moveHue(input,event)}})};var hide=function(input){if(!input)input='.miniColors';$(input).each(function(){var selector=$(this).data('selector');$(this).removeData('selector');$(selector).fadeOut(100,function(){$(this).remove()})});$(document).unbind('mousedown.miniColors');$(document).unbind('mousemove.miniColors')};var moveColor=function(input,event){var colorPicker=input.data('colorPicker');colorPicker.hide();var position={x:event.clientX-input.data('selector').find('.miniColors-colors').offset().left+$(document).scrollLeft()-5,y:event.clientY-input.data('selector').find('.miniColors-colors').offset().top+$(document).scrollTop()-5};if(position.x<=-5)position.x=-5;if(position.x>=144)position.x=144;if(position.y<=-5)position.y=-5;if(position.y>=144)position.y=144;input.data('colorPosition',position);colorPicker.css('left',position.x).css('top',position.y).show();var s=Math.round((position.x+5)*.67);if(s<0)s=0;if(s>100)s=100;var b=100-Math.round((position.y+5)*.67);if(b<0)b=0;if(b>100)b=100;var hsb=input.data('hsb');hsb.s=s;hsb.b=b;setColor(input,hsb,true)};var moveHue=function(input,event){var huePicker=input.data('huePicker');huePicker.hide();var position={y:event.clientY-input.data('selector').find('.miniColors-colors').offset().top+$(document).scrollTop()-1};if(position.y<=-1)position.y=-1;if(position.y>=149)position.y=149;input.data('huePosition',position);huePicker.css('top',position.y).show();var h=Math.round((150-position.y-1)*2.4);if(h<0)h=0;if(h>360)h=360;var hsb=input.data('hsb');hsb.h=h;setColor(input,hsb,true)};var setColor=function(input,hsb,updateInputValue){input.data('hsb',hsb);var hex=hsb2hex(hsb);if(updateInputValue)input.val('#'+hex);input.data('trigger').css('backgroundColor','#'+hex);if(input.data('selector'))input.data('selector').find('.miniColors-colors').css('backgroundColor','#'+hsb2hex({h:hsb.h,s:100,b:100}));if(input.data('change')){input.data('change').call(input,'#'+hex,hsb2rgb(hsb))}};var setColorFromInput=function(input){var hex=cleanHex(input.val());if(!hex)return false;var hsb=hex2hsb(hex);var currentHSB=input.data('hsb');if(hsb.h===currentHSB.h&&hsb.s===currentHSB.s&&hsb.b===currentHSB.b)return true;var colorPosition=getColorPositionFromHSB(hsb);var colorPicker=$(input.data('colorPicker'));colorPicker.css('top',colorPosition.y+'px').css('left',colorPosition.x+'px');var huePosition=getHuePositionFromHSB(hsb);var huePicker=$(input.data('huePicker'));huePicker.css('top',huePosition.y+'px');setColor(input,hsb,false);return true};var getColorPositionFromHSB=function(hsb){var x=Math.ceil(hsb.s/.67);if(x<0)x=0;if(x>150)x=150;var y=150-Math.ceil(hsb.b/.67);if(y<0)y=0;if(y>150)y=150;return{x:x-5,y:y-5}};var getHuePositionFromHSB=function(hsb){var y=150-(hsb.h/2.4);if(y<0)h=0;if(y>150)h=150;return{y:y-1}};var cleanHex=function(hex){hex=hex.replace(/[^A-Fa-f0-9]/,'');if(hex.length==3){hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]}return hex.length===6?hex:null};var hsb2rgb=function(hsb){var rgb={};var h=Math.round(hsb.h);var s=Math.round(hsb.s*255/100);var v=Math.round(hsb.b*255/100);if(s==0){rgb.r=rgb.g=rgb.b=v}else{var t1=v;var t2=(255-s)*v/255;var t3=(t1-t2)*(h%60)/60;if(h==360)h=0;if(h<60){rgb.r=t1;rgb.b=t2;rgb.g=t2+t3}else if(h<120){rgb.g=t1;rgb.b=t2;rgb.r=t1-t3}else if(h<180){rgb.g=t1;rgb.r=t2;rgb.b=t2+t3}else if(h<240){rgb.b=t1;rgb.r=t2;rgb.g=t1-t3}else if(h<300){rgb.b=t1;rgb.g=t2;rgb.r=t2+t3}else if(h<360){rgb.r=t1;rgb.g=t2;rgb.b=t1-t3}else{rgb.r=0;rgb.g=0;rgb.b=0}}return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)}};var rgb2hex=function(rgb){var hex=[rgb.r.toString(16),rgb.g.toString(16),rgb.b.toString(16)];$.each(hex,function(nr,val){if(val.length==1)hex[nr]='0'+val});return hex.join('')};var hex2rgb=function(hex){var hex=parseInt(((hex.indexOf('#')>-1)?hex.substring(1):hex),16);return{r:hex>>16,g:(hex&0x00FF00)>>8,b:(hex&0x0000FF)}};var rgb2hsb=function(rgb){var hsb={h:0,s:0,b:0};var min=Math.min(rgb.r,rgb.g,rgb.b);var max=Math.max(rgb.r,rgb.g,rgb.b);var delta=max-min;hsb.b=max;hsb.s=max!=0?255*delta/max:0;if(hsb.s!=0){if(rgb.r==max){hsb.h=(rgb.g-rgb.b)/delta}else if(rgb.g==max){hsb.h=2+(rgb.b-rgb.r)/delta}else{hsb.h=4+(rgb.r-rgb.g)/delta}}else{hsb.h=-1}hsb.h*=60;if(hsb.h<0){hsb.h+=360}hsb.s*=100/255;hsb.b*=100/255;return hsb};var hex2hsb=function(hex){var hsb=rgb2hsb(hex2rgb(hex));if(hsb.s===0)hsb.h=360;return hsb};var hsb2hex=function(hsb){return rgb2hex(hsb2rgb(hsb))};switch(o){case'readonly':$(this).each(function(){$(this).attr('readonly',data)});return $(this);break;case'disabled':$(this).each(function(){if(data){disable($(this))}else{enable($(this))}});return $(this);case'value':$(this).each(function(){if(typeof data!=='string'){data=hsb2hex(data)}$(this).val(data).trigger('keyup')});return $(this);break;case'destroy':$(this).each(function(){destroy($(this))});return $(this);default:if(!o)o={};$(this).each(function(){if($(this)[0].tagName.toLowerCase()!=='input')return;if($(this).data('trigger'))return;create($(this),o,data)});return $(this)}}})(jQuery);(function($){'use strict';var counter=0;$.ajaxTransport('iframe',function(options,originalOptions,jqXHR){if(options.type==='POST'||options.type==='GET'){var form,iframe;return{send:function(headers,completeCallback){form=$('<form style="display:none;"></form>');iframe=$('<iframe src="javascript:false;" name="iframe-transport-'+(counter+=1)+'"></iframe>').bind('load',function(){var fileInputClones;iframe.unbind('load').bind('load',function(){var response;try{response=iframe.contents()}catch(e){response=$()}completeCallback(200,'success',{'iframe':response});$('<iframe src="javascript:false;"></iframe>').appendTo(form);form.remove()});form.prop('target',iframe.prop('name')).prop('action',options.url).prop('method',options.type);if(options.formData){$.each(options.formData,function(index,field){$('<input type="hidden"/>').prop('name',field.name).val(field.value).appendTo(form)})}if(options.fileInput&&options.fileInput.length&&options.type==='POST'){fileInputClones=options.fileInput.clone();options.fileInput.after(function(index){return fileInputClones[index]});if(options.paramName){options.fileInput.each(function(){$(this).prop('name',options.paramName)})}form.append(options.fileInput).prop('enctype','multipart/form-data').prop('encoding','multipart/form-data')}form.submit();if(fileInputClones&&fileInputClones.length){options.fileInput.each(function(index,input){var clone=$(fileInputClones[index]);$(input).prop('name',clone.prop('name'));clone.replaceWith(input)})}});form.append(iframe).appendTo('body')},abort:function(){if(iframe){iframe.unbind('load').prop('src','javascript'.concat(':false;'))}if(form){form.remove()}}}}});$.ajaxSetup({converters:{'iframe text':function(iframe){return iframe.text()},'iframe json':function(iframe){return $.parseJSON(iframe.text())},'iframe html':function(iframe){return iframe.find('body').html()},'iframe script':function(iframe){return $.globalEval(iframe.text())}}})}(jQuery));(function($){'use strict';$.widget('blueimp.fileupload',{options:{namespace:undefined,dropZone:$(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,sequentialUploads:false,forceIframeTransport:false,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,formData:function(form){return form.serializeArray()},add:function(e,data){data.submit()},processData:false,contentType:false,cache:false},_refreshOptionsList:['namespace','dropZone','fileInput'],_isXHRUpload:function(options){var undef='undefined';return!options.forceIframeTransport&&typeof XMLHttpRequestUpload!==undef&&typeof File!==undef&&(!options.multipart||typeof FormData!==undef)},_getFormData:function(options){var formData;if(typeof options.formData==='function'){return options.formData(options.form)}else if($.isArray(options.formData)){return options.formData}else if(options.formData){formData=[];$.each(options.formData,function(name,value){formData.push({name:name,value:value})});return formData}return[]},_getTotal:function(files){var total=0;$.each(files,function(index,file){total+=file.size||1});return total},_onProgress:function(e,data){if(e.lengthComputable){var total=data.total||this._getTotal(data.files),loaded=parseInt(e.loaded/e.total*(data.chunkSize||total),10)+(data.uploadedBytes||0);this._loaded+=loaded-(data.loaded||data.uploadedBytes||0);data.lengthComputable=true;data.loaded=loaded;data.total=total;this._trigger('progress',e,data);this._trigger('progressall',e,{lengthComputable:true,loaded:this._loaded,total:this._total})}},_initProgressListener:function(options){var that=this,xhr=options.xhr?options.xhr():$.ajaxSettings.xhr();if(xhr.upload&&xhr.upload.addEventListener){xhr.upload.addEventListener('progress',function(e){that._onProgress(e,options)},false);options.xhr=function(){return xhr}}},_initXHRData:function(options){var formData,file=options.files[0];if(!options.multipart||options.blob){options.headers=$.extend(options.headers,{'X-File-Name':file.name,'X-File-Type':file.type,'X-File-Size':file.size});if(!options.blob){options.contentType=file.type;options.data=file}else if(!options.multipart){options.contentType='application/octet-stream';options.data=options.blob}}if(options.multipart&&typeof FormData!=='undefined'){if(options.formData instanceof FormData){formData=options.formData}else{formData=new FormData();$.each(this._getFormData(options),function(index,field){formData.append(field.name,field.value)})}if(options.blob){formData.append(options.paramName,options.blob)}else{$.each(options.files,function(index,file){if(file instanceof Blob){formData.append(options.paramName,file)}})}options.data=formData}options.blob=null},_initIframeSettings:function(options){options.dataType='iframe '+(options.dataType||'');options.formData=this._getFormData(options)},_initDataSettings:function(options){if(this._isXHRUpload(options)){if(!this._chunkedUpload(options,true)){if(!options.data){this._initXHRData(options)}this._initProgressListener(options)}}else{this._initIframeSettings(options)}},_initFormSettings:function(options){if(!options.form||!options.form.length){options.form=$(options.fileInput.prop('form'))}if(!options.paramName){options.paramName=options.fileInput.prop('name')||'files[]'}if(!options.url){options.url=options.form.prop('action')||location.href}options.type=(options.type||options.form.prop('method')||'').toUpperCase();if(options.type!=='POST'&&options.type!=='PUT'){options.type='POST'}},_getAJAXSettings:function(data){var options=$.extend({},this.options,data);this._initFormSettings(options);this._initDataSettings(options);return options},_enhancePromise:function(promise){promise.success=promise.done;promise.error=promise.fail;promise.complete=promise.always;return promise},_getXHRPromise:function(resolveOrReject,context,args){var dfd=$.Deferred(),promise=dfd.promise();context=context||this.options.context||promise;if(resolveOrReject===true){dfd.resolveWith(context,args)}else if(resolveOrReject===false){dfd.rejectWith(context,args)}promise.abort=dfd.promise;return this._enhancePromise(promise)},_chunkedUpload:function(options,testOnly){var that=this,file=options.files[0],fs=file.size,ub=options.uploadedBytes=options.uploadedBytes||0,mcs=options.maxChunkSize||fs,slice=file.webkitSlice||file.mozSlice||file.slice,upload,n,jqXHR,pipe;if(!(this._isXHRUpload(options)&&slice&&(ub||mcs<fs))||options.data){return false}if(testOnly){return true}if(ub>=fs){file.error='uploadedBytes';return this._getXHRPromise(false)}n=Math.ceil((fs-ub)/mcs);upload=function(i){if(!i){return that._getXHRPromise(true)}return upload(i-=1).pipe(function(){var o=$.extend({},options);o.blob=slice.call(file,ub+i*mcs,ub+(i+1)*mcs);o.chunkSize=o.blob.size;that._initXHRData(o);that._initProgressListener(o);jqXHR=($.ajax(o)||that._getXHRPromise(false,o.context)).done(function(){if(!o.loaded){that._onProgress($.Event('progress',{lengthComputable:true,loaded:o.chunkSize,total:o.chunkSize}),o)}options.uploadedBytes=o.uploadedBytes+=o.chunkSize});return jqXHR})};pipe=upload(n);pipe.abort=function(){return jqXHR.abort()};return this._enhancePromise(pipe)},_beforeSend:function(e,data){if(this._active===0){this._trigger('start')}this._active+=1;this._loaded+=data.uploadedBytes||0;this._total+=this._getTotal(data.files)},_onDone:function(result,textStatus,jqXHR,options){if(!this._isXHRUpload(options)){this._onProgress($.Event('progress',{lengthComputable:true,loaded:1,total:1}),options)}options.result=result;options.textStatus=textStatus;options.jqXHR=jqXHR;this._trigger('done',null,options)},_onFail:function(jqXHR,textStatus,errorThrown,options){options.jqXHR=jqXHR;options.textStatus=textStatus;options.errorThrown=errorThrown;this._trigger('fail',null,options);if(options.recalculateProgress){this._loaded-=options.loaded||options.uploadedBytes||0;this._total-=options.total||this._getTotal(options.files)}},_onAlways:function(result,textStatus,jqXHR,errorThrown,options){this._active-=1;options.result=result;options.textStatus=textStatus;options.jqXHR=jqXHR;options.errorThrown=errorThrown;this._trigger('always',null,options);if(this._active===0){this._trigger('stop');this._loaded=this._total=0}},_onSend:function(e,data){var that=this,jqXHR,pipe,options=that._getAJAXSettings(data),send=function(resolve,args){jqXHR=jqXHR||((resolve!==false&&that._trigger('send',e,options)!==false&&(that._chunkedUpload(options)||$.ajax(options)))||that._getXHRPromise(false,options.context,args)).done(function(result,textStatus,jqXHR){that._onDone(result,textStatus,jqXHR,options)}).fail(function(jqXHR,textStatus,errorThrown){that._onFail(jqXHR,textStatus,errorThrown,options)}).always(function(a1,a2,a3){if(!a3||typeof a3==='string'){that._onAlways(undefined,a2,a1,a3,options)}else{that._onAlways(a1,a2,a3,undefined,options)}});return jqXHR};this._beforeSend(e,options);if(this.options.sequentialUploads){pipe=(this._sequence=this._sequence.pipe(send,send));pipe.abort=function(){if(!jqXHR){return send(false,[undefined,'abort','abort'])}return jqXHR.abort()};return this._enhancePromise(pipe)}return send()},_onAdd:function(e,data){var that=this,result=true,options=$.extend({},this.options,data);if(options.singleFileUploads&&this._isXHRUpload(options)){$.each(data.files,function(index,file){var newData=$.extend({},data,{files:[file]});newData.submit=function(){return that._onSend(e,newData)};return(result=that._trigger('add',e,newData))});return result}else if(data.files.length){data=$.extend({},data);data.submit=function(){return that._onSend(e,data)};return this._trigger('add',e,data)}},_normalizeFile:function(index,file){if(file.name===undefined&&file.size===undefined){file.name=file.fileName;file.size=file.fileSize}},_replaceFileInput:function(input){var inputClone=input.clone(true);$('<form></form>').append(inputClone)[0].reset();input.after(inputClone).detach();this.options.fileInput=this.options.fileInput.map(function(i,el){if(el===input[0]){return inputClone[0]}return el})},_onChange:function(e){var that=e.data.fileupload,data={files:$.each($.makeArray(e.target.files),that._normalizeFile),fileInput:$(e.target),form:$(e.target.form)};if(!data.files.length){data.files=[{name:e.target.value.replace(/^.*\\/,'')}]}if(data.form.length){data.fileInput.data('blueimp.fileupload.form',data.form)}else{data.form=data.fileInput.data('blueimp.fileupload.form')}if(that.options.replaceFileInput){that._replaceFileInput(data.fileInput)}if(that._trigger('change',e,data)===false||that._onAdd(e,data)===false){return false}},_onDrop:function(e){var that=e.data.fileupload,dataTransfer=e.dataTransfer=e.originalEvent.dataTransfer,data={files:$.each($.makeArray(dataTransfer&&dataTransfer.files),that._normalizeFile)};if(that._trigger('drop',e,data)===false||that._onAdd(e,data)===false){return false}e.preventDefault()},_onDragOver:function(e){var that=e.data.fileupload,dataTransfer=e.dataTransfer=e.originalEvent.dataTransfer;if(that._trigger('dragover',e)===false){return false}if(dataTransfer){dataTransfer.dropEffect=dataTransfer.effectAllowed='copy'}e.preventDefault()},_initEventHandlers:function(){var ns=this.options.namespace||this.name;this.options.dropZone.bind('dragover.'+ns,{fileupload:this},this._onDragOver).bind('drop.'+ns,{fileupload:this},this._onDrop);this.options.fileInput.bind('change.'+ns,{fileupload:this},this._onChange)},_destroyEventHandlers:function(){var ns=this.options.namespace||this.name;this.options.dropZone.unbind('dragover.'+ns,this._onDragOver).unbind('drop.'+ns,this._onDrop);this.options.fileInput.unbind('change.'+ns,this._onChange)},_beforeSetOption:function(key,value){},_afterSetOption:function(key,value){var options=this.options;if(!options.fileInput){options.fileInput=$()}if(!options.dropZone){options.dropZone=$()}this._initEventHandlers()},_setOption:function(key,value){var refresh=$.inArray(key,this._refreshOptionsList)!==-1;if(refresh){this._beforeSetOption(key,value)}$.Widget.prototype._setOption.call(this,key,value);if(refresh){this._afterSetOption(key,value)}},_create:function(){var options=this.options;if(options.fileInput===undefined){options.fileInput=this.element.is('input:file')?this.element:this.element.find('input:file')}else if(!options.fileInput){options.fileInput=$()}if(!options.dropZone){options.dropZone=$()}this._sequence=this._getXHRPromise(true);this._active=this._loaded=this._total=0;this._initEventHandlers()},destroy:function(){},enable:function(){$.Widget.prototype.enable.call(this);this._initEventHandlers()},disable:function(){this._destroyEventHandlers();$.Widget.prototype.disable.call(this)},add:function(data){if(!data||this.options.disabled){return}data.files=$.each($.makeArray(data.files),this._normalizeFile);this._onAdd(null,data)},send:function(data){if(data&&!this.options.disabled){data.files=$.each($.makeArray(data.files),this._normalizeFile);if(data.files.length){return this._onSend(null,data)}}return this._getXHRPromise(false,data&&data.context)}})}(jQuery));(function(b){var m,t,u,f,D,j,E,n,z,A,q=0,e={},o=[],p=0,d={},l=[],G=null,v=new Image,J=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,W=/[^\.]\.(swf)\s*$/i,K,L=1,y=0,s="",r,i,h=false,B=b.extend(b("<div/>")[0],{prop:0}),M=b.browser.msie&&b.browser.version<7&&!window.XMLHttpRequest,N=function(){t.hide();v.onerror=v.onload=null;G&&G.abort();m.empty()},O=function(){if(false===e.onError(o,q,e)){t.hide();h=false}else{e.titleShow=false;e.width="auto";e.height="auto";m.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>');F()}},I=function(){var a=o[q],c,g,k,C,P,w;N();e=b.extend({},b.fn.fancybox.defaults,typeof b(a).data("fancybox")=="undefined"?e:b(a).data("fancybox"));w=e.onStart(o,q,e);if(w===false)h=false;else{if(typeof w=="object")e=b.extend(e,w);k=e.title||(a.nodeName?b(a).attr("title"):a.title)||"";if(a.nodeName&&!e.orig)e.orig=b(a).children("img:first").length?b(a).children("img:first"):b(a);if(k===""&&e.orig&&e.titleFromAlt)k=e.orig.attr("alt");c=e.href||(a.nodeName?b(a).attr("href"):a.href)||null;if(/^(?:javascript)/i.test(c)||c=="#")c=null;if(e.type){g=e.type;if(!c)c=e.content}else if(e.content)g="html";else if(c)g=c.match(J)?"image":c.match(W)?"swf":b(a).hasClass("iframe")?"iframe":c.indexOf("#")===0?"inline":"ajax";if(g){if(g=="inline"){a=c.substr(c.indexOf("#"));g=b(a).length>0?"inline":"ajax"}e.type=g;e.href=c;e.title=k;if(e.autoDimensions)if(e.type=="html"||e.type=="inline"||e.type=="ajax"){e.width="auto";e.height="auto"}else e.autoDimensions=false;if(e.modal){e.overlayShow=true;e.hideOnOverlayClick=false;e.hideOnContentClick=false;e.enableEscapeButton=false;e.showCloseButton=false}e.padding=parseInt(e.padding,10);e.margin=parseInt(e.margin,10);m.css("padding",e.padding+e.margin);b(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){b(this).replaceWith(j.children())});switch(g){case"html":m.html(e.content);F();break;case"inline":if(b(a).parent().is("#fancybox-content")===true){h=false;break}b('<div class="fancybox-inline-tmp" />').hide().insertBefore(b(a)).bind("fancybox-cleanup",function(){b(this).replaceWith(j.children())}).bind("fancybox-cancel",function(){b(this).replaceWith(m.children())});b(a).appendTo(m);F();break;case"image":h=false;b.fancybox.showActivity();v=new Image;v.onerror=function(){O()};v.onload=function(){h=true;v.onerror=v.onload=null;e.width=v.width;e.height=v.height;b("<img />").attr({id:"fancybox-img",src:v.src,alt:e.title}).appendTo(m);Q()};v.src=c;break;case"swf":e.scrolling="no";C='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+e.width+'" height="'+e.height+'"><param name="movie" value="'+c+'"></param>';P="";b.each(e.swf,function(x,H){C+='<param name="'+x+'" value="'+H+'"></param>';P+=" "+x+'="'+H+'"'});C+='<embed src="'+c+'" type="application/x-shockwave-flash" width="'+e.width+'" height="'+e.height+'"'+P+"></embed></object>";m.html(C);F();break;case"ajax":h=false;b.fancybox.showActivity();e.ajax.win=e.ajax.success;G=b.ajax(b.extend({},e.ajax,{url:c,data:e.ajax.data||{},error:function(x){x.status>0&&O()},success:function(x,H,R){if((typeof R=="object"?R:G).status==200){if(typeof e.ajax.win=="function"){w=e.ajax.win(c,x,H,R);if(w===false){t.hide();return}else if(typeof w=="string"||typeof w=="object")x=w}m.html(x);F()}}}));break;case"iframe":Q()}}else O()}},F=function(){var a=e.width,c=e.height;a=a.toString().indexOf("%")>-1?parseInt((b(window).width()-e.margin*2)*parseFloat(a)/100,10)+"px":a=="auto"?"auto":a+"px";c=c.toString().indexOf("%")>-1?parseInt((b(window).height()-e.margin*2)*parseFloat(c)/100,10)+"px":c=="auto"?"auto":c+"px";m.wrapInner('<div style="width:'+a+";height:"+c+";overflow: "+(e.scrolling=="auto"?"auto":e.scrolling=="yes"?"scroll":"hidden")+';position:relative;"></div>');e.width=m.width();e.height=m.height();Q()},Q=function(){var a,c;t.hide();if(f.is(":visible")&&false===d.onCleanup(l,p,d)){b.event.trigger("fancybox-cancel");h=false}else{h=true;b(j.add(u)).unbind();b(window).unbind("resize.fb scroll.fb");b(document).unbind("keydown.fb");f.is(":visible")&&d.titlePosition!=="outside"&&f.css("height",f.height());l=o;p=q;d=e;if(d.overlayShow){u.css({"background-color":d.overlayColor,opacity:d.overlayOpacity,cursor:d.hideOnOverlayClick?"pointer":"auto",height:b(document).height()});if(!u.is(":visible")){M&&b("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"});u.show()}}else u.hide();i=X();s=d.title||"";y=0;n.empty().removeAttr("style").removeClass();if(d.titleShow!==false){if(b.isFunction(d.titleFormat))a=d.titleFormat(s,l,p,d);else a=s&&s.length?d.titlePosition=="float"?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+s+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+d.titlePosition+'">'+s+"</div>":false;s=a;if(!(!s||s==="")){n.addClass("fancybox-title-"+d.titlePosition).html(s).appendTo("body").show();switch(d.titlePosition){case"inside":n.css({width:i.width-d.padding*2,marginLeft:d.padding,marginRight:d.padding});y=n.outerHeight(true);n.appendTo(D);i.height+=y;break;case"over":n.css({marginLeft:d.padding,width:i.width-d.padding*2,bottom:d.padding}).appendTo(D);break;case"float":n.css("left",parseInt((n.width()-i.width-40)/2,10)*-1).appendTo(f);break;default:n.css({width:i.width-d.padding*2,paddingLeft:d.padding,paddingRight:d.padding}).appendTo(f)}}}n.hide();if(f.is(":visible")){b(E.add(z).add(A)).hide();a=f.position();r={top:a.top,left:a.left,width:f.width(),height:f.height()};c=r.width==i.width&&r.height==i.height;j.fadeTo(d.changeFade,0.3,function(){var g=function(){j.html(m.contents()).fadeTo(d.changeFade,1,S)};b.event.trigger("fancybox-change");j.empty().removeAttr("filter").css({"border-width":d.padding,width:i.width-d.padding*2,height:e.autoDimensions?"auto":i.height-y-d.padding*2});if(c)g();else{B.prop=0;b(B).animate({prop:1},{duration:d.changeSpeed,easing:d.easingChange,step:T,complete:g})}})}else{f.removeAttr("style");j.css("border-width",d.padding);if(d.transitionIn=="elastic"){r=V();j.html(m.contents());f.show();if(d.opacity)i.opacity=0;B.prop=0;b(B).animate({prop:1},{duration:d.speedIn,easing:d.easingIn,step:T,complete:S})}else{d.titlePosition=="inside"&&y>0&&n.show();j.css({width:i.width-d.padding*2,height:e.autoDimensions?"auto":i.height-y-d.padding*2}).html(m.contents());f.css(i).fadeIn(d.transitionIn=="none"?0:d.speedIn,S)}}}},Y=function(){if(d.enableEscapeButton||d.enableKeyboardNav)b(document).bind("keydown.fb",function(a){if(a.keyCode==27&&d.enableEscapeButton){a.preventDefault();b.fancybox.close()}else if((a.keyCode==37||a.keyCode==39)&&d.enableKeyboardNav&&a.target.tagName!=="INPUT"&&a.target.tagName!=="TEXTAREA"&&a.target.tagName!=="SELECT"){a.preventDefault();b.fancybox[a.keyCode==37?"prev":"next"]()}});if(d.showNavArrows){if(d.cyclic&&l.length>1||p!==0)z.show();if(d.cyclic&&l.length>1||p!=l.length-1)A.show()}else{z.hide();A.hide()}},S=function(){if(!b.support.opacity){j.get(0).style.removeAttribute("filter");f.get(0).style.removeAttribute("filter")}e.autoDimensions&&j.css("height","auto");f.css("height","auto");s&&s.length&&n.show();d.showCloseButton&&E.show();Y();d.hideOnContentClick&&j.bind("click",b.fancybox.close);d.hideOnOverlayClick&&u.bind("click",b.fancybox.close);b(window).bind("resize.fb",b.fancybox.resize);d.centerOnScroll&&b(window).bind("scroll.fb",b.fancybox.center);if(d.type=="iframe")b('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(b.browser.msie?'allowtransparency="true""':"")+' scrolling="'+e.scrolling+'" src="'+d.href+'"></iframe>').appendTo(j);f.show();h=false;b.fancybox.center();d.onComplete(l,p,d);var a,c;if(l.length-1>p){a=l[p+1].href;if(typeof a!=="undefined"&&a.match(J)){c=new Image;c.src=a}}if(p>0){a=l[p-1].href;if(typeof a!=="undefined"&&a.match(J)){c=new Image;c.src=a}}},T=function(a){var c={width:parseInt(r.width+(i.width-r.width)*a,10),height:parseInt(r.height+(i.height-r.height)*a,10),top:parseInt(r.top+(i.top-r.top)*a,10),left:parseInt(r.left+(i.left-r.left)*a,10)};if(typeof i.opacity!=="undefined")c.opacity=a<0.5?0.5:a;f.css(c);j.css({width:c.width-d.padding*2,height:c.height-y*a-d.padding*2})},U=function(){return[b(window).width()-d.margin*2,b(window).height()-d.margin*2,b(document).scrollLeft()+d.margin,b(document).scrollTop()+d.margin]},X=function(){var a=U(),c={},g=d.autoScale,k=d.padding*2;c.width=d.width.toString().indexOf("%")>-1?parseInt(a[0]*parseFloat(d.width)/100,10):d.width+k;c.height=d.height.toString().indexOf("%")>-1?parseInt(a[1]*parseFloat(d.height)/100,10):d.height+k;if(g&&(c.width>a[0]||c.height>a[1]))if(e.type=="image"||e.type=="swf"){g=d.width/d.height;if(c.width>a[0]){c.width=a[0];c.height=parseInt((c.width-k)/g+k,10)}if(c.height>a[1]){c.height=a[1];c.width=parseInt((c.height-k)*g+k,10)}}else{c.width=Math.min(c.width,a[0]);c.height=Math.min(c.height,a[1])}c.top=parseInt(Math.max(a[3]-20,a[3]+(a[1]-c.height-40)*0.5),10);c.left=parseInt(Math.max(a[2]-20,a[2]+(a[0]-c.width-40)*0.5),10);return c},V=function(){var a=e.orig?b(e.orig):false,c={};if(a&&a.length){c=a.offset();c.top+=parseInt(a.css("paddingTop"),10)||0;c.left+=parseInt(a.css("paddingLeft"),10)||0;c.top+=parseInt(a.css("border-top-width"),10)||0;c.left+=parseInt(a.css("border-left-width"),10)||0;c.width=a.width();c.height=a.height();c={width:c.width+d.padding*2,height:c.height+d.padding*2,top:c.top-d.padding-20,left:c.left-d.padding-20}}else{a=U();c={width:d.padding*2,height:d.padding*2,top:parseInt(a[3]+a[1]*0.5,10),left:parseInt(a[2]+a[0]*0.5,10)}}return c},Z=function(){if(t.is(":visible")){b("div",t).css("top",L*-40+"px");L=(L+1)%12}else clearInterval(K)};b.fn.fancybox=function(a){if(!b(this).length)return this;b(this).data("fancybox",b.extend({},a,b.metadata?b(this).metadata():{})).unbind("click.fb").bind("click.fb",function(c){c.preventDefault();if(!h){h=true;b(this).blur();o=[];q=0;c=b(this).attr("rel")||"";if(!c||c==""||c==="nofollow")o.push(this);else{o=b("a[rel="+c+"], area[rel="+c+"]");q=o.index(this)}I()}});return this};b.fancybox=function(a,c){var g;if(!h){h=true;g=typeof c!=="undefined"?c:{};o=[];q=parseInt(g.index,10)||0;if(b.isArray(a)){for(var k=0,C=a.length;k<C;k++)if(typeof a[k]=="object")b(a[k]).data("fancybox",b.extend({},g,a[k]));else a[k]=b({}).data("fancybox",b.extend({content:a[k]},g));o=jQuery.merge(o,a)}else{if(typeof a=="object")b(a).data("fancybox",b.extend({},g,a));else a=b({}).data("fancybox",b.extend({content:a},g));o.push(a)}if(q>o.length||q<0)q=0;I()}};b.fancybox.showActivity=function(){clearInterval(K);t.show();K=setInterval(Z,66)};b.fancybox.hideActivity=function(){t.hide()};b.fancybox.next=function(){return b.fancybox.pos(p+1)};b.fancybox.prev=function(){return b.fancybox.pos(p-1)};b.fancybox.pos=function(a){if(!h){a=parseInt(a);o=l;if(a>-1&&a<l.length){q=a;I()}else if(d.cyclic&&l.length>1){q=a>=l.length?0:l.length-1;I()}}};b.fancybox.cancel=function(){if(!h){h=true;b.event.trigger("fancybox-cancel");N();e.onCancel(o,q,e);h=false}};b.fancybox.close=function(){function a(){u.fadeOut("fast");n.empty().hide();f.hide();b.event.trigger("fancybox-cleanup");j.empty();d.onClosed(l,p,d);l=e=[];p=q=0;d=e={};h=false}if(!(h||f.is(":hidden"))){h=true;if(d&&false===d.onCleanup(l,p,d))h=false;else{N();b(E.add(z).add(A)).hide();b(j.add(u)).unbind();b(window).unbind("resize.fb scroll.fb");b(document).unbind("keydown.fb");j.find("iframe").attr("src",M&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank");d.titlePosition!=="inside"&&n.empty();f.stop();if(d.transitionOut=="elastic"){r=V();var c=f.position();i={top:c.top,left:c.left,width:f.width(),height:f.height()};if(d.opacity)i.opacity=1;n.empty().hide();B.prop=1;b(B).animate({prop:0},{duration:d.speedOut,easing:d.easingOut,step:T,complete:a})}else f.fadeOut(d.transitionOut=="none"?0:d.speedOut,a)}}};b.fancybox.resize=function(){u.is(":visible")&&u.css("height",b(document).height());b.fancybox.center(true)};b.fancybox.center=function(a){var c,g;if(!h){g=a===true?1:0;c=U();!g&&(f.width()>c[0]||f.height()>c[1])||f.stop().animate({top:parseInt(Math.max(c[3]-20,c[3]+(c[1]-j.height()-40)*0.5-d.padding)),left:parseInt(Math.max(c[2]-20,c[2]+(c[0]-j.width()-40)*0.5-d.padding))},typeof a=="number"?a:200)}};b.fancybox.init=function(){if(!b("#fancybox-wrap").length){b("body").append(m=b('<div id="fancybox-tmp"></div>'),t=b('<div id="fancybox-loading"><div></div></div>'),u=b('<div id="fancybox-overlay"></div>'),f=b('<div id="fancybox-wrap"></div>'));D=b('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(f);D.append(j=b('<div id="fancybox-content"></div>'),E=b('<a id="fancybox-close"></a>'),n=b('<div id="fancybox-title"></div>'),z=b('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),A=b('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));E.click(b.fancybox.close);t.click(b.fancybox.cancel);z.click(function(a){a.preventDefault();b.fancybox.prev()});A.click(function(a){a.preventDefault();b.fancybox.next()});b.fn.mousewheel&&f.bind("mousewheel.fb",function(a,c){if(h)a.preventDefault();else if(b(a.target).get(0).clientHeight==0||b(a.target).get(0).scrollHeight===b(a.target).get(0).clientHeight){a.preventDefault();b.fancybox[c>0?"prev":"next"]()}});b.support.opacity||f.addClass("fancybox-ie");if(M){t.addClass("fancybox-ie6");f.addClass("fancybox-ie6");b('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(D)}}};b.fn.fancybox.defaults={padding:10,margin:40,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:0.7,overlayColor:"#777",titleShow:true,titlePosition:"float",titleFormat:null,titleFromAlt:false,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:true,showNavArrows:true,enableEscapeButton:true,enableKeyboardNav:true,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};b(document).ready(function(){b.fancybox.init()})})(jQuery);(function($){if(!$||!($.toJSON||Object.toJSON||window.JSON)&&!$.browser.msie){throw new Error("jQuery, MooTools or Prototype needs to be loaded before jStorage!")}var _storage={},_storage_service={jStorage:"{}"},_storage_elm=null,_storage_size=0,json_encode=$.toJSON||Object.toJSON||(window.JSON&&(JSON.encode||JSON.stringify)),json_decode=$.evalJSON||(window.JSON&&(JSON.decode||JSON.parse))||function(str){return String(str).evalJSON()},_backend=false;_XMLService={isXML:function(elm){var documentElement=(elm?elm.ownerDocument||elm:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false},encode:function(xmlNode){if(!this.isXML(xmlNode)){return false}try{return new XMLSerializer().serializeToString(xmlNode)}catch(E1){try{return xmlNode.xml}catch(E2){}}return false},decode:function(xmlString){var dom_parser=("DOMParser"in window&&(new DOMParser()).parseFromString)||(window.ActiveXObject&&function(_xmlString){var xml_doc=new ActiveXObject('Microsoft.XMLDOM');xml_doc.async='false';xml_doc.loadXML(_xmlString);return xml_doc}),resultXML;if(!dom_parser){return false}resultXML=dom_parser.call("DOMParser"in window&&(new DOMParser())||window,xmlString,'text/xml');return this.isXML(resultXML)?resultXML:false}};function _init(){if("localStorage"in window){try{if(window.localStorage){_storage_service=window.localStorage;_backend="localStorage"}}catch(E3){}}else if("globalStorage"in window){try{if(window.globalStorage){_storage_service=window.globalStorage[window.location.hostname];_backend="globalStorage"}}catch(E4){}}else{_storage_elm=document.createElement('link');if(_storage_elm.addBehavior){_storage_elm.style.behavior='url(#default#userData)';document.getElementsByTagName('head')[0].appendChild(_storage_elm);_storage_elm.load("jStorage");var data="{}";try{data=_storage_elm.getAttribute("jStorage")}catch(E5){}_storage_service.jStorage=data;_backend="userDataBehavior"}else{_storage_elm=null;return}}_load_storage()}function _load_storage(){if(_storage_service.jStorage){try{_storage=json_decode(String(_storage_service.jStorage))}catch(E6){_storage_service.jStorage="{}"}}else{_storage_service.jStorage="{}"}_storage_size=_storage_service.jStorage?String(_storage_service.jStorage).length:0}function _save(){try{_storage_service.jStorage=json_encode(_storage);if(_storage_elm){_storage_elm.setAttribute("jStorage",_storage_service.jStorage);_storage_elm.save("jStorage")}_storage_size=_storage_service.jStorage?String(_storage_service.jStorage).length:0}catch(E7){}}function _checkKey(key){if(!key||(typeof key!="string"&&typeof key!="number")){throw new TypeError('Key name must be string or numeric')}return true}$.jStorage={version:"0.1.5.2",set:function(key,value){_checkKey(key);if(_XMLService.isXML(value)){value={_is_xml:true,xml:_XMLService.encode(value)}}_storage[key]=value;_save();return value},get:function(key,def){_checkKey(key);if(key in _storage){if(_storage[key]&&typeof _storage[key]=="object"&&_storage[key]._is_xml&&_storage[key]._is_xml){return _XMLService.decode(_storage[key].xml)}else{return _storage[key]}}return typeof(def)=='undefined'?null:def},deleteKey:function(key){_checkKey(key);if(key in _storage){delete _storage[key];_save();return true}return false},flush:function(){_storage={};_save();return true},storageObj:function(){function F(){}F.prototype=_storage;return new F()},index:function(){var index=[],i;for(i in _storage){if(_storage.hasOwnProperty(i)){index.push(i)}}return index},storageSize:function(){return _storage_size},currentBackend:function(){return _backend},storageAvailable:function(){return!!_backend},reInit:function(){var new_storage_elm,data;if(_storage_elm&&_storage_elm.addBehavior){new_storage_elm=document.createElement('link');_storage_elm.parentNode.replaceChild(new_storage_elm,_storage_elm);_storage_elm=new_storage_elm;_storage_elm.style.behavior='url(#default#userData)';document.getElementsByTagName('head')[0].appendChild(_storage_elm);_storage_elm.load("jStorage");data="{}";try{data=_storage_elm.getAttribute("jStorage")}catch(E5){}_storage_service.jStorage=data;_backend="userDataBehavior"}_load_storage()}};_init()})(window.jQuery||window.$);(function($){var CB=function(e){if(!e)var e=window.event;e.cancelBubble=true;if(e.stopPropagation)e.stopPropagation()};$.fn.checkbox=function(options){var settings={cls:'jquery-checkbox'};settings=$.extend(settings,options||{});var addEvents=function(object){var checked=object.checked;var disabled=object.disabled;var $object=$(object);if(object.stateInterval)clearInterval(object.stateInterval);object.stateInterval=setInterval(function(){if(object.disabled!=disabled)$object.trigger((disabled=!!object.disabled)?'disable':'enable');if(object.checked!=checked)$object.trigger((checked=!!object.checked)?'check':'uncheck')},10);return $object};return this.each(function(){var ch=this;var $ch=addEvents(ch),elClass=($(ch).is(':radio'))?'radio':'checkbox';if(ch.wrapper)ch.wrapper.remove();ch.wrapper=$('<span class="'+settings.cls+' '+elClass+'"><span><span class="checkboxplaceholder"></span></span></span>');ch.wrapperInner=ch.wrapper.children('span:eq(0)');ch.wrapper.bind({"click":function(e){$ch.trigger('click');return false},"mouseover":function(e){ch.wrapperInner.addClass('hover')},"mouseout":function(e){ch.wrapperInner.removeClass('hover')},"mousedown":function(e){ch.wrapperInner.addClass('pressed')},"mouseup":function(e){ch.wrapperInner.removeClass('pressed')}});$ch.css({position:'absolute',zIndex:-1,visibility:'hidden'}).after(ch.wrapper);var label=false;if(!label){label=$ch.closest('label');if(!label.length)label=false}if(label){label.bind({"click":function(e){$ch.trigger('click');return false},"mouseover":function(e){ch.wrapper.trigger('mouseover')},"mouseout":function(e){ch.wrapper.trigger('mouseout')},"mousedown":function(e){ch.wrapper.addClass('pressed')},"mouseup":function(e){ch.wrapper.removeClass('pressed')}})}$ch.bind('disable',function(){ch.wrapperInner.addClass('disabled')}).bind('enable',function(){ch.wrapperInner.removeClass('disabled')});$ch.bind('check',function(){ch.wrapper.addClass('checked')}).bind('uncheck',function(){ch.wrapper.removeClass('checked')});if(window.getSelection)ch.wrapper.css('MozUserSelect','none');if(ch.checked)ch.wrapper.addClass('checked');if(ch.disabled)ch.wrapperInner.addClass('disabled')})}})(jQuery);$(document).ready(function(){(function($){"use strict";var console=window.console?window.console:{log:$.noop,error:function(msg){$.error(msg)}};var supportsProp=(('prop'in $.fn)&&('removeProp'in $.fn));function Wysiwyg(){this.controls={bold:{groupIndex:0,visible:false,tags:["b","strong"],css:{fontWeight:"bold"},tooltip:"Bold",hotkey:{"ctrl":1,"key":66}},copy:{groupIndex:8,visible:false,tooltip:"Copy"},colorpicker:{visible:false,groupIndex:1,tooltip:"Colorpicker",exec:function(){$.wysiwyg.controls.colorpicker.init(this)}},createLink:{groupIndex:6,visible:false,exec:function(){var self=this;if($.wysiwyg.controls&&$.wysiwyg.controls.link){$.wysiwyg.controls.link.init(this)}else if($.wysiwyg.autoload){$.wysiwyg.autoload.control("wysiwyg.link.js",function(){self.controls.createLink.exec.apply(self)})}else{console.error("$.wysiwyg.controls.link not defined. You need to include wysiwyg.link.js file")}},tags:["a"],tooltip:"Create link"},cut:{groupIndex:8,visible:false,tooltip:"Cut"},decreaseFontSize:{groupIndex:9,visible:false,tags:["small"],tooltip:"Decrease font size",exec:function(){this.decreaseFontSize()}},h1:{groupIndex:7,visible:false,className:"h1",command:($.browser.msie||$.browser.safari||$.browser.opera)?"FormatBlock":"heading","arguments":($.browser.msie||$.browser.safari||$.browser.opera)?"<h1>":"h1",tags:["h1"],tooltip:"Header 1"},h2:{groupIndex:7,visible:false,className:"h2",command:($.browser.msie||$.browser.safari||$.browser.opera)?"FormatBlock":"heading","arguments":($.browser.msie||$.browser.safari||$.browser.opera)?"<h2>":"h2",tags:["h2"],tooltip:"Header 2"},h3:{groupIndex:7,visible:false,className:"h3",command:($.browser.msie||$.browser.safari||$.browser.opera)?"FormatBlock":"heading","arguments":($.browser.msie||$.browser.safari||$.browser.opera)?"<h3>":"h3",tags:["h3"],tooltip:"Header 3"},h4:{groupIndex:7,visible:false,className:"h4",command:($.browser.msie||$.browser.safari||$.browser.opera)?"FormatBlock":"heading","arguments":($.browser.msie||$.browser.safari||$.browser.opera)?"<h4>":"h4",tags:["h4"],tooltip:"Header 4"},h5:{groupIndex:7,visible:false,className:"h5",command:($.browser.msie||$.browser.safari||$.browser.opera)?"FormatBlock":"heading","arguments":($.browser.msie||$.browser.safari||$.browser.opera)?"<h5>":"h5",tags:["h5"],tooltip:"Header 5"},h6:{groupIndex:7,visible:false,className:"h6",command:($.browser.msie||$.browser.safari||$.browser.opera)?"FormatBlock":"heading","arguments":($.browser.msie||$.browser.safari||$.browser.opera)?"<h6>":"h6",tags:["h6"],tooltip:"Header 6"},highlight:{tooltip:"Highlight",className:"highlight",groupIndex:1,visible:false,css:{backgroundColor:"rgb(255, 255, 102)"},exec:function(){var command,node,selection,args;if($.browser.msie||$.browser.safari){command="backcolor"}else{command="hilitecolor"}if($.browser.msie){node=this.getInternalRange().parentElement()}else{selection=this.getInternalSelection();node=selection.extentNode||selection.focusNode;while(node.style===undefined){node=node.parentNode;if(node.tagName&&node.tagName.toLowerCase()==="body"){return}}}if(node.style.backgroundColor==="rgb(255, 255, 102)"||node.style.backgroundColor==="#ffff66"){args="#ffffff"}else{args="#ffff66"}this.editorDoc.execCommand(command,false,args)}},html:{groupIndex:10,visible:false,exec:function(){var elementHeight;if(this.options.resizeOptions&&$.fn.resizable){elementHeight=this.element.height()}if(this.viewHTML){this.setContent(this.original.value);$(this.original).hide();this.editor.show();if(this.options.resizeOptions&&$.fn.resizable){if(elementHeight===this.element.height()){this.element.height(elementHeight+this.editor.height())}this.element.resizable($.extend(true,{alsoResize:this.editor},this.options.resizeOptions))}this.ui.toolbar.find("li").each(function(){var li=$(this);if(li.hasClass("html")){li.removeClass("active")}else{li.removeClass('disabled')}})}else{this.saveContent();$(this.original).css({width:this.element.outerWidth()-6,height:this.element.height()-this.ui.toolbar.height()-6,resize:"none"}).show();this.editor.hide();if(this.options.resizeOptions&&$.fn.resizable){if(elementHeight===this.element.height()){this.element.height(this.ui.toolbar.height())}this.element.resizable("destroy")}this.ui.toolbar.find("li").each(function(){var li=$(this);if(li.hasClass("html")){li.addClass("active")}else{if(false===li.hasClass("fullscreen")){li.removeClass("active").addClass('disabled')}}})}this.viewHTML=!(this.viewHTML)},tooltip:"View source code"},increaseFontSize:{groupIndex:9,visible:false,tags:["big"],tooltip:"Increase font size",exec:function(){this.increaseFontSize()}},insertImage:{groupIndex:6,visible:false,exec:function(){var self=this;if($.wysiwyg.controls&&$.wysiwyg.controls.image){$.wysiwyg.controls.image.init(this)}else if($.wysiwyg.autoload){$.wysiwyg.autoload.control("wysiwyg.image.js",function(){self.controls.insertImage.exec.apply(self)})}else{console.error("$.wysiwyg.controls.image not defined. You need to include wysiwyg.image.js file")}},tags:["img"],tooltip:"Insert image"},insertOrderedList:{groupIndex:5,visible:false,tags:["ol"],tooltip:"Insert Ordered List"},insertTable:{groupIndex:6,visible:false,exec:function(){var self=this;if($.wysiwyg.controls&&$.wysiwyg.controls.table){$.wysiwyg.controls.table(this)}else if($.wysiwyg.autoload){$.wysiwyg.autoload.control("wysiwyg.table.js",function(){self.controls.insertTable.exec.apply(self)})}else{console.error("$.wysiwyg.controls.table not defined. You need to include wysiwyg.table.js file")}},tags:["table"],tooltip:"Insert table"},insertUnorderedList:{groupIndex:5,visible:false,tags:["ul"],tooltip:"Insert Unordered List"},italic:{groupIndex:0,visible:false,tags:["i","em"],css:{fontStyle:"italic"},tooltip:"Italic",hotkey:{"ctrl":1,"key":73}},justifyLeft:{visible:false,groupIndex:1,css:{textAlign:"left"},tooltip:"Justify Left"},justifyCenter:{groupIndex:1,visible:false,tags:["center"],css:{textAlign:"center"},tooltip:"Justify Center"},justifyRight:{groupIndex:1,visible:false,css:{textAlign:"right"},tooltip:"Justify Right"},justifyFull:{groupIndex:1,visible:false,css:{textAlign:"justify"},tooltip:"Justify Full"},ltr:{groupIndex:9,visible:false,exec:function(){var p=this.dom.getElement("p");if(!p){return false}$(p).attr("dir","ltr");return true},tooltip:"Left to Right"},rtl:{groupIndex:9,visible:false,exec:function(){var p=this.dom.getElement("p");if(!p){return false}$(p).attr("dir","rtl");return true},tooltip:"Right to Left"},indent:{groupIndex:2,visible:false,tooltip:"Indent"},outdent:{groupIndex:2,visible:false,tooltip:"Outdent"},insertHorizontalRule:{groupIndex:5,visible:false,tags:["hr"],tooltip:"Insert Horizontal Rule"},paragraph:{groupIndex:7,visible:false,className:"paragraph",command:"FormatBlock","arguments":($.browser.msie||$.browser.safari||$.browser.opera)?"<p>":"p",tags:["p"],tooltip:"Paragraph"},paste:{groupIndex:8,visible:false,tooltip:"Paste"},undo:{groupIndex:4,visible:false,tooltip:"Undo"},redo:{groupIndex:4,visible:false,tooltip:"Redo"},removeFormat:{groupIndex:10,visible:false,exec:function(){this.removeFormat()},tooltip:"Remove formatting"},underline:{groupIndex:0,visible:false,tags:["u"],css:{textDecoration:"underline"},tooltip:"Underline",hotkey:{"ctrl":1,"key":85}},strikeThrough:{groupIndex:0,visible:false,tags:["s","strike"],css:{textDecoration:"line-through"},tooltip:"Strike-through"},subscript:{groupIndex:3,visible:false,tags:["sub"],tooltip:"Subscript"},superscript:{groupIndex:3,visible:false,tags:["sup"],tooltip:"Superscript"},code:{visible:false,groupIndex:6,tooltip:"Code snippet",exec:function(){var range=this.getInternalRange(),common=$(range.commonAncestorContainer),$nodeName=range.commonAncestorContainer.nodeName.toLowerCase();if(common.parent("code").length){common.unwrap()}else{if($nodeName!=="body"){common.wrap("<code/>")}}}},cssWrap:{visible:false,groupIndex:6,tooltip:"CSS Wrapper",exec:function(){$.wysiwyg.controls.cssWrap.init(this)}}};this.defaults={html:'<!DOCTYPE html><html><head><meta charset="utf-8"></head><body>INITIAL_CONTENT</body></html>',debug:false,controls:{},css:{},events:{},autoGrow:false,autoSave:true,brIE:true,formHeight:270,formWidth:440,iFrameClass:null,initialContent:"<p>Initial content</p>",maxHeight:10000,maxLength:0,messages:{nonSelection:"Select the text you wish to link"},toolbarHtml:'<ul role="menu" class="toolbar"></ul>',removeHeadings:false,replaceDivWithP:false,resizeOptions:false,rmUnusedControls:false,rmUnwantedBr:true,tableFiller:null,initialMinHeight:null,controlImage:{forceRelativeUrls:false},controlLink:{forceRelativeUrls:false},plugins:{autoload:false,i18n:false,rmFormat:{rmMsWordMarkup:false}}};this.availableControlProperties=["arguments","callback","className","command","css","custom","exec","groupIndex","hotkey","icon","tags","tooltip","visible"];this.editor=null;this.editorDoc=null;this.element=null;this.options={};this.original=null;this.savedRange=null;this.timers=[];this.validKeyCodes=[8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,46];this.isDestroyed=false;this.dom={ie:{parent:null},w3c:{parent:null}};this.dom.parent=this;this.dom.ie.parent=this.dom;this.dom.w3c.parent=this.dom;this.ui={};this.ui.self=this;this.ui.toolbar=null;this.ui.initialHeight=null;this.dom.getAncestor=function(element,filterTagName){filterTagName=filterTagName.toLowerCase();while(element&&"body"!==element.tagName.toLowerCase()){if(filterTagName===element.tagName.toLowerCase()){return element}element=element.parentNode}return null};this.dom.getElement=function(filterTagName){var dom=this;if(window.getSelection){return dom.w3c.getElement(filterTagName)}else{return dom.ie.getElement(filterTagName)}};this.dom.ie.getElement=function(filterTagName){var dom=this.parent,selection=dom.parent.getInternalSelection(),range=selection.createRange(),element;if("Control"===selection.type){if(1===range.length){element=range.item(0)}else{return null}}else{element=range.parentElement()}return dom.getAncestor(element,filterTagName)};this.dom.w3c.getElement=function(filterTagName){var dom=this.parent,range=dom.parent.getInternalRange(),element;if(!range){return null}element=range.commonAncestorContainer;if(3===element.nodeType){element=element.parentNode}if(element===range.startContainer){element=element.childNodes[range.startOffset]}return dom.getAncestor(element,filterTagName)};this.ui.addHoverClass=function(){$(this).addClass("wysiwyg-button-hover")};this.ui.appendControls=function(){var ui=this,self=this.self,controls=self.parseControls(),hasVisibleControls=true,groups=[],controlsByGroup={},i,currentGroupIndex,iterateGroup=function(controlName,control){if(control.groupIndex&&currentGroupIndex!==control.groupIndex){currentGroupIndex=control.groupIndex;hasVisibleControls=false}if(!control.visible){return}if(!hasVisibleControls){ui.appendItemSeparator();hasVisibleControls=true}if(control.custom){ui.appendItemCustom(controlName,control)}else{ui.appendItem(controlName,control)}};$.each(controls,function(name,c){var index="empty";if(undefined!==c.groupIndex){if(""===c.groupIndex){index="empty"}else{index=c.groupIndex}}if(undefined===controlsByGroup[index]){groups.push(index);controlsByGroup[index]={}}controlsByGroup[index][name]=c});groups.sort(function(a,b){if("number"===typeof(a)&&typeof(a)===typeof(b)){return(a-b)}else{a=a.toString();b=b.toString();if(a>b){return 1}if(a===b){return 0}return-1}});if(0<groups.length){currentGroupIndex=groups[0]}for(i=0;i<groups.length;i+=1){$.each(controlsByGroup[groups[i]],iterateGroup)}};this.ui.appendItem=function(name,control){var self=this.self,className=control.className||control.command||name||"empty",tooltip=control.tooltip||control.command||name||"";return $('<li role="menuitem" unselectable="on">'+(className)+"</li>").addClass(className).attr("title",tooltip).hover(this.addHoverClass,this.removeHoverClass).click(function(){if($(this).hasClass("disabled")){return false}self.triggerControl.apply(self,[name,control]);this.blur();self.ui.returnRange();self.ui.focus();return true}).appendTo(self.ui.toolbar)};this.ui.appendItemCustom=function(name,control){var self=this.self,tooltip=control.tooltip||control.command||name||"";if(control.callback){$(window).bind("trigger-"+name+".wysiwyg",control.callback)}return $('<li role="menuitem" unselectable="on" style="background: url(\''+control.icon+'\') no-repeat;"></li>').addClass("custom-command-"+name).addClass("wysiwyg-custom-command").addClass(name).attr("title",tooltip).hover(this.addHoverClass,this.removeHoverClass).click(function(){if($(this).hasClass("disabled")){return false}self.triggerControl.apply(self,[name,control]);this.blur();self.ui.returnRange();self.ui.focus();self.triggerControlCallback(name);return true}).appendTo(self.ui.toolbar)};this.ui.appendItemSeparator=function(){var self=this.self;return $('<li role="separator" class="separator"></li>').appendTo(self.ui.toolbar)};this.autoSaveFunction=function(){this.saveContent()};this.ui.checkTargets=function(element){var self=this.self;$.each(self.options.controls,function(name,control){var className=control.className||control.command||name||"empty",tags,elm,css,el,checkActiveStatus=function(cssProperty,cssValue){var handler;if("function"===typeof(cssValue)){handler=cssValue;if(handler(el.css(cssProperty).toString().toLowerCase(),self)){self.ui.toolbar.find("."+className).addClass("active")}}else{if(el.css(cssProperty).toString().toLowerCase()===cssValue){self.ui.toolbar.find("."+className).addClass("active")}}};if("fullscreen"!==className){self.ui.toolbar.find("."+className).removeClass("active")}if(control.tags||(control.options&&control.options.tags)){tags=control.tags||(control.options&&control.options.tags);elm=element;while(elm){if(elm.nodeType!==1){break}if($.inArray(elm.tagName.toLowerCase(),tags)!==-1){self.ui.toolbar.find("."+className).addClass("active")}elm=elm.parentNode}}if(control.css||(control.options&&control.options.css)){css=control.css||(control.options&&control.options.css);el=$(element);while(el){if(el[0].nodeType!==1){break}$.each(css,checkActiveStatus);el=el.parent()}}})};this.ui.designMode=function(){var attempts=3,self=this.self,runner;runner=function(attempts){if("on"===self.editorDoc.designMode){if(self.timers.designMode){window.clearTimeout(self.timers.designMode)}if(self.innerDocument()!==self.editorDoc){self.ui.initFrame()}return}try{self.editorDoc.designMode="on"}catch(e){}attempts-=1;if(attempts>0){self.timers.designMode=window.setTimeout(function(){runner(attempts)},100)}};runner(attempts)};this.destroy=function(){this.isDestroyed=true;var i,$form=this.element.closest("form");for(i=0;i<this.timers.length;i+=1){window.clearTimeout(this.timers[i])}$form.unbind(".wysiwyg");this.element.remove();$.removeData(this.original,"wysiwyg");$(this.original).show();return this};this.getRangeText=function(){var r=this.getInternalRange();if(r.toString){r=r.toString()}else if(r.text){r=r.text}return r};this.execute=function(command,arg){if(typeof(arg)==="undefined"){arg=null}this.editorDoc.execCommand(command,false,arg)};this.extendOptions=function(options){var controls={};if("object"===typeof options.controls){controls=options.controls;delete options.controls}options=$.extend(true,{},this.defaults,options);options.controls=$.extend(true,{},controls,this.controls,controls);if(options.rmUnusedControls){$.each(options.controls,function(controlName){if(!controls[controlName]){delete options.controls[controlName]}})}return options};this.ui.focus=function(){var self=this.self;self.editor.get(0).contentWindow.focus();return self};this.ui.returnRange=function(){var self=this.self,sel;if(self.savedRange!==null){if(window.getSelection){sel=window.getSelection();if(sel.rangeCount>0){sel.removeAllRanges()}try{sel.addRange(self.savedRange)}catch(e){console.error(e)}}else if(window.document.createRange){window.getSelection().addRange(self.savedRange)}else if(window.document.selection){self.savedRange.select()}self.savedRange=null}};this.increaseFontSize=function(){if($.browser.mozilla||$.browser.opera){this.editorDoc.execCommand('increaseFontSize',false,null)}else if($.browser.safari){var newNode=this.editorDoc.createElement('big');this.getInternalRange().surroundContents(newNode)}else{console.error("Internet Explorer?")}};this.decreaseFontSize=function(){if($.browser.mozilla||$.browser.opera){this.editorDoc.execCommand('decreaseFontSize',false,null)}else if($.browser.safari){var newNode=this.editorDoc.createElement('small');this.getInternalRange().surroundContents(newNode)}else{console.error("Internet Explorer?")}};this.getContent=function(){if(this.viewHTML){this.setContent(this.original.value)}return this.events.filter('getContent',this.editorDoc.body.innerHTML)};this.events={_events:{},bind:function(eventName,callback){if(typeof(this._events.eventName)!=="object"){this._events[eventName]=[]}this._events[eventName].push(callback)},trigger:function(eventName,args){if(typeof(this._events.eventName)==="object"){var editor=this.editor;$.each(this._events[eventName],function(k,v){if(typeof(v)==="function"){v.apply(editor,args)}})}},filter:function(eventName,originalText){if(typeof(this._events[eventName])==="object"){var editor=this.editor,args=Array.prototype.slice.call(arguments,1);$.each(this._events[eventName],function(k,v){if(typeof(v)==="function"){originalText=v.apply(editor,args)}})}return originalText}};this.getElementByAttributeValue=function(tagName,attributeName,attributeValue){var i,value,elements=this.editorDoc.getElementsByTagName(tagName);for(i=0;i<elements.length;i+=1){value=elements[i].getAttribute(attributeName);if($.browser.msie){value=value.substr(value.length-attributeValue.length)}if(value===attributeValue){return elements[i]}}return false};this.getInternalRange=function(){var selection=this.getInternalSelection();if(!selection){return null}if(selection.rangeCount&&selection.rangeCount>0){return selection.getRangeAt(0)}else if(selection.createRange){return selection.createRange()}return null};this.getInternalSelection=function(){if(this.editor.get(0).contentWindow){if(this.editor.get(0).contentWindow.getSelection){return this.editor.get(0).contentWindow.getSelection()}if(this.editor.get(0).contentWindow.selection){return this.editor.get(0).contentWindow.selection}}if(this.editorDoc.getSelection){return this.editorDoc.getSelection()}if(this.editorDoc.selection){return this.editorDoc.selection}return null};this.getRange=function(){var selection=this.getSelection();if(!selection){return null}if(selection.rangeCount&&selection.rangeCount>0){selection.getRangeAt(0)}else if(selection.createRange){return selection.createRange()}return null};this.getSelection=function(){return(window.getSelection)?window.getSelection():window.document.selection};this.ui.grow=function(){var self=this.self,innerBody=$(self.editorDoc.body),innerHeight=$.browser.msie?innerBody[0].scrollHeight:innerBody.height()+2+20,minHeight=self.ui.initialHeight,height=Math.max(innerHeight,minHeight);height=Math.min(height,self.options.maxHeight);self.editor.attr("scrolling",height<self.options.maxHeight?"no":"auto");innerBody.css("overflow",height<self.options.maxHeight?"hidden":"");self.editor.get(0).height=height;return self};this.init=function(element,options){var self=this,$form=$(element).closest("form"),newX=element.width||element.clientWidth||0,newY=element.height||element.clientHeight||0;this.options=this.extendOptions(options);this.original=element;this.ui.toolbar=$(this.options.toolbarHtml);if($.browser.msie&&parseInt($.browser.version,10)<8){this.options.autoGrow=false}if(newX===0&&element.cols){newX=(element.cols*8)+21}if(newY===0&&element.rows){newY=(element.rows*16)+16}this.editor=$(window.location.protocol==="https:"?'<iframe src="javascript:false;"></iframe>':"<iframe></iframe>").attr("frameborder","0");if(this.options.iFrameClass){this.editor.addClass(this.options.iFrameClass)}else{this.editor.css({minHeight:(newY-6).toString()+"px",width:(newX>50)?(newX-8).toString()+"px":""});if($.browser.msie&&parseInt($.browser.version,10)<7){this.editor.css("height",newY.toString()+"px")}}this.editor.attr("tabindex",$(element).attr("tabindex"));this.element=$("<div/>").addClass("wysiwyg");if(!this.options.iFrameClass){this.element.css({width:(newX>0)?newX.toString()+"px":"100%"})}$(element).hide().before(this.element);this.viewHTML=false;this.initialContent=$(element).val();this.ui.initFrame();if(this.options.resizeOptions&&$.fn.resizable){this.element.resizable($.extend(true,{alsoResize:this.editor},this.options.resizeOptions))}if(this.options.autoSave){$form.bind("submit.wysiwyg",function(){self.autoSaveFunction()})}$form.bind("reset.wysiwyg",function(){self.resetFunction()})};this.ui.initFrame=function(){var self=this.self,stylesheet,growHandler,saveHandler;self.ui.appendControls();self.element.append(self.ui.toolbar).append($("<div><!-- --></div>").css({clear:"both"})).append(self.editor);self.editorDoc=self.innerDocument();if(self.isDestroyed){return null}self.ui.designMode();self.editorDoc.open();self.editorDoc.write(self.options.html.replace(/INITIAL_CONTENT/,function(){return self.wrapInitialContent()}));self.editorDoc.close();$.wysiwyg.plugin.bind(self);$(self.editorDoc).trigger("initFrame.wysiwyg");$(self.editorDoc).bind("click.wysiwyg",function(event){self.ui.checkTargets(event.target?event.target:event.srcElement)});$(self.original).focus(function(){if($(this).filter(":visible")){return}self.ui.focus()});$(self.editorDoc).keydown(function(event){var emptyContentRegex;if(event.keyCode===8){emptyContentRegex=/^<([\w]+)[^>]*>(<br\/?>)?<\/\1>$/;if(emptyContentRegex.test(self.getContent())){event.stopPropagation();return false}}return true});if(!$.browser.msie){$(self.editorDoc).keydown(function(event){var controlName;if(event.ctrlKey||event.metaKey){for(controlName in self.controls){if(self.controls[controlName].hotkey&&self.controls[controlName].hotkey.ctrl){if(event.keyCode===self.controls[controlName].hotkey.key){self.triggerControl.apply(self,[controlName,self.controls[controlName]]);return false}}}}return true})}else if(self.options.brIE){$(self.editorDoc).keydown(function(event){if(event.keyCode===13){var rng=self.getRange();rng.pasteHTML("<br/>");rng.collapse(false);rng.select();return false}return true})}if(self.options.plugins.rmFormat.rmMsWordMarkup){$(self.editorDoc).bind("keyup.wysiwyg",function(event){if(event.ctrlKey||event.metaKey){if(86===event.keyCode){if($.wysiwyg.rmFormat){if("object"===typeof(self.options.plugins.rmFormat.rmMsWordMarkup)){$.wysiwyg.rmFormat.run(self,{rules:{msWordMarkup:self.options.plugins.rmFormat.rmMsWordMarkup}})}else{$.wysiwyg.rmFormat.run(self,{rules:{msWordMarkup:{enabled:true}}})}}}}})}if(self.options.autoSave){$(self.editorDoc).keydown(function(){self.autoSaveFunction()}).keyup(function(){self.autoSaveFunction()}).mousedown(function(){self.autoSaveFunction()}).bind($.support.noCloneEvent?"input.wysiwyg":"paste.wysiwyg",function(){self.autoSaveFunction()})}if(self.options.autoGrow){if(self.options.initialMinHeight!==null){self.ui.initialHeight=self.options.initialMinHeight}else{self.ui.initialHeight=$(self.editorDoc).height()}$(self.editorDoc.body).css("border","1px solid white");growHandler=function(){self.ui.grow()};$(self.editorDoc).keyup(growHandler);$(self.editorDoc).bind("editorRefresh.wysiwyg",growHandler);self.ui.grow()}if(self.options.css){if(String===self.options.css.constructor){if($.browser.msie){stylesheet=self.editorDoc.createStyleSheet(self.options.css);$(stylesheet).attr({"media":"all"})}else{stylesheet=$("<link/>").attr({"href":self.options.css,"media":"all","rel":"stylesheet","type":"text/css"});$(self.editorDoc).find("head").append(stylesheet)}}else{self.timers.initFrame_Css=window.setTimeout(function(){$(self.editorDoc.body).css(self.options.css)},0)}}if(self.initialContent.length===0){if("function"===typeof(self.options.initialContent)){self.setContent(self.options.initialContent())}else{self.setContent(self.options.initialContent)}}if(self.options.maxLength>0){$(self.editorDoc).keydown(function(event){if($(self.editorDoc).text().length>=self.options.maxLength&&$.inArray(event.which,self.validKeyCodes)===-1){event.preventDefault()}})}$.each(self.options.events,function(key,handler){$(self.editorDoc).bind(key+".wysiwyg",function(event){handler.apply(self.editorDoc,[event,self])})});if($.browser.msie){$(self.editorDoc).bind("beforedeactivate.wysiwyg",function(){self.savedRange=self.getInternalRange()})}else{$(self.editorDoc).bind("blur.wysiwyg",function(){self.savedRange=self.getInternalRange()})}$(self.editorDoc.body).addClass("wysiwyg");if(self.options.events&&self.options.events.save){saveHandler=self.options.events.save;$(self.editorDoc).bind("keyup.wysiwyg",saveHandler);$(self.editorDoc).bind("change.wysiwyg",saveHandler);if($.support.noCloneEvent){$(self.editorDoc).bind("input.wysiwyg",saveHandler)}else{$(self.editorDoc).bind("paste.wysiwyg",saveHandler);$(self.editorDoc).bind("cut.wysiwyg",saveHandler)}}if(self.options.xhtml5&&self.options.unicode){var replacements={ne:8800,le:8804,para:182,xi:958,darr:8595,nu:957,oacute:243,Uacute:218,omega:969,prime:8242,pound:163,igrave:236,thorn:254,forall:8704,emsp:8195,lowast:8727,brvbar:166,alefsym:8501,nbsp:160,delta:948,clubs:9827,lArr:8656,Omega:937,Auml:196,cedil:184,and:8743,plusmn:177,ge:8805,raquo:187,uml:168,equiv:8801,laquo:171,rdquo:8221,Epsilon:917,divide:247,fnof:402,chi:967,Dagger:8225,iacute:237,rceil:8969,sigma:963,Oslash:216,acute:180,frac34:190,lrm:8206,upsih:978,Scaron:352,part:8706,exist:8707,nabla:8711,image:8465,prop:8733,zwj:8205,omicron:959,aacute:225,Yuml:376,Yacute:221,weierp:8472,rsquo:8217,otimes:8855,kappa:954,thetasym:977,harr:8596,Ouml:214,Iota:921,ograve:242,sdot:8901,copy:169,oplus:8853,acirc:226,sup:8835,zeta:950,Iacute:205,Oacute:211,crarr:8629,Nu:925,bdquo:8222,lsquo:8216,apos:39,Beta:914,eacute:233,egrave:232,lceil:8968,Kappa:922,piv:982,Ccedil:199,ldquo:8220,Xi:926,cent:162,uarr:8593,hellip:8230,Aacute:193,ensp:8194,sect:167,Ugrave:217,aelig:230,ordf:170,curren:164,sbquo:8218,macr:175,Phi:934,Eta:919,rho:961,Omicron:927,sup2:178,euro:8364,aring:229,Theta:920,mdash:8212,uuml:252,otilde:245,eta:951,uacute:250,rArr:8658,nsub:8836,agrave:224,notin:8713,ndash:8211,Psi:936,Ocirc:212,sube:8838,szlig:223,micro:181,not:172,sup1:185,middot:183,iota:953,ecirc:234,lsaquo:8249,thinsp:8201,sum:8721,ntilde:241,scaron:353,cap:8745,atilde:227,lang:10216,__replacement:65533,isin:8712,gamma:947,Euml:203,ang:8736,upsilon:965,Ntilde:209,hearts:9829,Alpha:913,Tau:932,spades:9824,dagger:8224,THORN:222,"int":8747,lambda:955,Eacute:201,Uuml:220,infin:8734,rlm:8207,Aring:197,ugrave:249,Egrave:200,Acirc:194,rsaquo:8250,ETH:208,oslash:248,alpha:945,Ograve:210,Prime:8243,mu:956,ni:8715,real:8476,bull:8226,beta:946,icirc:238,eth:240,prod:8719,larr:8592,ordm:186,perp:8869,Gamma:915,reg:174,ucirc:251,Pi:928,psi:968,tilde:732,asymp:8776,zwnj:8204,Agrave:192,deg:176,AElig:198,times:215,Delta:916,sim:8764,Otilde:213,Mu:924,uArr:8657,circ:710,theta:952,Rho:929,sup3:179,diams:9830,tau:964,Chi:935,frac14:188,oelig:339,shy:173,or:8744,dArr:8659,phi:966,iuml:239,Lambda:923,rfloor:8971,iexcl:161,cong:8773,ccedil:231,Icirc:206,frac12:189,loz:9674,rarr:8594,cup:8746,radic:8730,frasl:8260,euml:235,OElig:338,hArr:8660,Atilde:195,Upsilon:933,there4:8756,ouml:246,oline:8254,Ecirc:202,yacute:253,auml:228,permil:8240,sigmaf:962,iquest:191,empty:8709,pi:960,Ucirc:219,supe:8839,Igrave:204,yen:165,rang:10217,trade:8482,lfloor:8970,minus:8722,Zeta:918,sub:8834,epsilon:949,yuml:255,Sigma:931,Iuml:207,ocirc:244};self.events.bind("getContent",function(text){return text.replace(/&(?:amp;)?(?!amp|lt|gt|quot)([a-z][a-z0-9]*);/gi,function(str,p1){if(!replacements[p1]){p1=p1.toLowerCase();if(!replacements[p1]){p1="__replacement"}}var num=replacements[p1];return String.fromCharCode(num)})})}};this.innerDocument=function(){var element=this.editor.get(0);if(element.nodeName.toLowerCase()==="iframe"){if(element.contentDocument){return element.contentDocument}else if(element.contentWindow){return element.contentWindow.document}if(this.isDestroyed){return null}console.error("Unexpected error in innerDocument")}return element};this.insertHtml=function(szHTML){var img,range;if(!szHTML||szHTML.length===0){return this}if($.browser.msie){this.ui.focus();this.editorDoc.execCommand("insertImage",false,"#jwysiwyg#");img=this.getElementByAttributeValue("img","src","#jwysiwyg#");if(img){$(img).replaceWith(szHTML)}}else{if($.browser.mozilla){if(1===$(szHTML).length){range=this.getInternalRange();range.deleteContents();range.insertNode($(szHTML).get(0))}else{this.editorDoc.execCommand("insertHTML",false,szHTML)}}else{if(!this.editorDoc.execCommand("insertHTML",false,szHTML)){this.editor.focus();this.editorDoc.execCommand("insertHTML",false,szHTML)}}}this.saveContent();return this};this.parseControls=function(){var self=this;$.each(this.options.controls,function(controlName,control){$.each(control,function(propertyName){if(-1===$.inArray(propertyName,self.availableControlProperties)){throw controlName+'["'+propertyName+'"]: property "'+propertyName+'" not exists in Wysiwyg.availableControlProperties'}})});if(this.options.parseControls){return this.options.parseControls.call(this)}return this.options.controls};this.removeFormat=function(){if($.browser.msie){this.ui.focus()}if(this.options.removeHeadings){this.editorDoc.execCommand("formatBlock",false,"<p>")}this.editorDoc.execCommand("removeFormat",false,null);this.editorDoc.execCommand("unlink",false,null);if($.wysiwyg.rmFormat&&$.wysiwyg.rmFormat.enabled){if("object"===typeof(this.options.plugins.rmFormat.rmMsWordMarkup)){$.wysiwyg.rmFormat.run(this,{rules:{msWordMarkup:this.options.plugins.rmFormat.rmMsWordMarkup}})}else{$.wysiwyg.rmFormat.run(this,{rules:{msWordMarkup:{enabled:true}}})}}return this};this.ui.removeHoverClass=function(){$(this).removeClass("wysiwyg-button-hover")};this.resetFunction=function(){this.setContent(this.initialContent)};this.saveContent=function(){if(this.viewHTML){return}if(this.original){var content,newContent;content=this.getContent();if(this.options.rmUnwantedBr){content=content.replace(/<br\/?>$/,"")}if(this.options.replaceDivWithP){newContent=$("<div/>").addClass("temp").append(content);newContent.children("div").each(function(){var element=$(this),p=element.find("p"),i;if(0===p.length){p=$("<p></p>");if(this.attributes.length>0){for(i=0;i<this.attributes.length;i+=1){p.attr(this.attributes[i].name,element.attr(this.attributes[i].name))}}p.append(element.html());element.replaceWith(p)}});content=newContent.html()}$(this.original).val(content);if(this.options.events&&this.options.events.save){this.options.events.save.call(this)}}return this};this.setContent=function(newContent){this.editorDoc.body.innerHTML=newContent;this.saveContent();return this};this.triggerControl=function(name,control){var cmd=control.command||name,args=control["arguments"]||[];if(control.exec){control.exec.apply(this)}else{this.ui.focus();this.ui.withoutCss();try{this.editorDoc.execCommand(cmd,false,args)}catch(e){console.error(e)}}if(this.options.autoSave){this.autoSaveFunction()}};this.triggerControlCallback=function(name){$(window).trigger("trigger-"+name+".wysiwyg",[this])};this.ui.withoutCss=function(){var self=this.self;if($.browser.mozilla){try{self.editorDoc.execCommand("styleWithCSS",false,false)}catch(e){try{self.editorDoc.execCommand("useCSS",false,true)}catch(e2){}}}return self};this.wrapInitialContent=function(){var content=this.initialContent,found=content.match(/<\/?p>/gi);if(!found){return"<p>"+content+"</p>"}else{}return content}}$.wysiwyg={messages:{noObject:"Something goes wrong, check object"},addControl:function(object,name,settings){return object.each(function(){var oWysiwyg=$(this).data("wysiwyg"),customControl={},toolbar;if(!oWysiwyg){return this}customControl[name]=$.extend(true,{visible:true,custom:true},settings);$.extend(true,oWysiwyg.options.controls,customControl);toolbar=$(oWysiwyg.options.toolbarHtml);oWysiwyg.ui.toolbar.replaceWith(toolbar);oWysiwyg.ui.toolbar=toolbar;oWysiwyg.ui.appendControls()})},clear:function(object){return object.each(function(){var oWysiwyg=$(this).data("wysiwyg");if(!oWysiwyg){return this}oWysiwyg.setContent("")})},console:console,destroy:function(object){return object.each(function(){var oWysiwyg=$(this).data("wysiwyg");if(!oWysiwyg){return this}oWysiwyg.destroy()})},"document":function(object){var oWysiwyg=object.data("wysiwyg");if(!oWysiwyg){return undefined}return $(oWysiwyg.editorDoc)},getContent:function(object){var oWysiwyg=object.data("wysiwyg");if(!oWysiwyg){return undefined}return oWysiwyg.getContent()},init:function(object,options){return object.each(function(){var opts=$.extend(true,{},options),obj;if(("textarea"!==this.nodeName.toLowerCase())||$(this).data("wysiwyg")){return}obj=new Wysiwyg();obj.init(this,opts);$.data(this,"wysiwyg",obj);$(obj.editorDoc).trigger("afterInit.wysiwyg")})},insertHtml:function(object,szHTML){return object.each(function(){var oWysiwyg=$(this).data("wysiwyg");if(!oWysiwyg){return this}oWysiwyg.insertHtml(szHTML)})},plugin:{listeners:{},bind:function(Wysiwyg){var self=this;$.each(this.listeners,function(action,handlers){var i,plugin;for(i=0;i<handlers.length;i+=1){plugin=self.parseName(handlers[i]);$(Wysiwyg.editorDoc).bind(action+".wysiwyg",{plugin:plugin},function(event){$.wysiwyg[event.data.plugin.name][event.data.plugin.method].apply($.wysiwyg[event.data.plugin.name],[Wysiwyg])})}})},exists:function(name){var plugin;if("string"!==typeof(name)){return false}plugin=this.parseName(name);if(!$.wysiwyg[plugin.name]||!$.wysiwyg[plugin.name][plugin.method]){return false}return true},listen:function(action,handler){var plugin;plugin=this.parseName(handler);if(!$.wysiwyg[plugin.name]||!$.wysiwyg[plugin.name][plugin.method]){return false}if(!this.listeners[action]){this.listeners[action]=[]}this.listeners[action].push(handler);return true},parseName:function(name){var elements;if("string"!==typeof(name)){return false}elements=name.split(".");if(2>elements.length){return false}return{name:elements[0],method:elements[1]}},register:function(data){if(!data.name){console.error("Plugin name missing")}$.each($.wysiwyg,function(pluginName){if(pluginName===data.name){console.error("Plugin with name '"+data.name+"' was already registered")}});$.wysiwyg[data.name]=data;return true}},removeFormat:function(object){return object.each(function(){var oWysiwyg=$(this).data("wysiwyg");if(!oWysiwyg){return this}oWysiwyg.removeFormat()})},save:function(object){return object.each(function(){var oWysiwyg=$(this).data("wysiwyg");if(!oWysiwyg){return this}oWysiwyg.saveContent()})},selectAll:function(object){var oWysiwyg=object.data("wysiwyg"),oBody,oRange,selection;if(!oWysiwyg){return this}oBody=oWysiwyg.editorDoc.body;if(window.getSelection){selection=oWysiwyg.getInternalSelection();selection.selectAllChildren(oBody)}else{oRange=oBody.createTextRange();oRange.moveToElementText(oBody);oRange.select()}},setContent:function(object,newContent){return object.each(function(){var oWysiwyg=$(this).data("wysiwyg");if(!oWysiwyg){return this}oWysiwyg.setContent(newContent)})},triggerControl:function(object,controlName){return object.each(function(){var oWysiwyg=$(this).data("wysiwyg");if(!oWysiwyg){return this}if(!oWysiwyg.controls[controlName]){console.error("Control '"+controlName+"' not exists")}oWysiwyg.triggerControl.apply(oWysiwyg,[controlName,oWysiwyg.controls[controlName]])})},support:{prop:supportsProp},utils:{extraSafeEntities:[["<",">","'",'"'," "],[32]],encodeEntities:function(str){var self=this,aStr,aRet=[];if(this.extraSafeEntities[1].length===0){$.each(this.extraSafeEntities[0],function(i,ch){self.extraSafeEntities[1].push(ch.charCodeAt(0))})}aStr=str.split("");$.each(aStr,function(i){var iC=aStr[i].charCodeAt(0);if($.inArray(iC,self.extraSafeEntities[1])&&(iC<65||iC>127||(iC>90&&iC<97))){aRet.push('&#'+iC+';')}else{aRet.push(aStr[i])}});return aRet.join('')}}};$.fn.wysiwyg=function(method){var args=arguments,plugin;if("undefined"!==typeof $.wysiwyg[method]){args=Array.prototype.concat.call([args[0]],[this],Array.prototype.slice.call(args,1));return $.wysiwyg[method].apply($.wysiwyg,Array.prototype.slice.call(args,1))}else if("object"===typeof method||!method){Array.prototype.unshift.call(args,this);return $.wysiwyg.init.apply($.wysiwyg,args)}else if($.wysiwyg.plugin.exists(method)){plugin=$.wysiwyg.plugin.parseName(method);args=Array.prototype.concat.call([args[0]],[this],Array.prototype.slice.call(args,1));return $.wysiwyg[plugin.name][plugin.method].apply($.wysiwyg[plugin.name],Array.prototype.slice.call(args,1))}else{console.error("Method '"+method+"' does not exist on jQuery.wysiwyg.\nTry to include some extra controls or plugins")}};$.fn.getWysiwyg=function(){return $.data(this,"wysiwyg")}})(jQuery);(function($){if(undefined===$.wysiwyg){throw"wysiwyg.image.js depends on $.wysiwyg"}if(!$.wysiwyg.controls){$.wysiwyg.controls={}}$.wysiwyg.controls.image={init:function(Wysiwyg){var self=this,elements,dialog,formImageHtml,dialogReplacements,key,translation,img={alt:"",self:Wysiwyg.dom.getElement("img"),src:"http://",title:""};dialogReplacements={legend:"Insert Image",preview:"Preview",url:"URL",title:"Title",description:"Description",width:"Width",height:"Height",original:"Original W x H","float":"Float",floatNone:"None",floatLeft:"Left",floatRight:"Right",submit:"Insert Image",loading:"loading",reset:"Cancel"};formImageHtml='<form class="wysiwyg" title="{legend}">'+'<img src="" alt="{preview}" width="100%"><br>'+'{url}: <input type="text" name="src" value=""><br>'+'{title}: <input type="text" name="imgtitle" value=""><br>'+'{description}: <input type="text" name="description" value=""><br>'+'{width} x {height}: <input type="text" name="width" value="" class="width integer"> x <input type="text" name="height" value="" class="height integer"><br>'+'{float}: <select name="float">'+'<option value="">{floatNone}</option>'+'<option value="left">{floatLeft}</option>'+'<option value="right">{floatRight}</option></select></label><hr>'+'<button class="button" id="wysiwyg_submit">{submit}</button> '+'<button class="button" id="wysiwyg_reset">{reset}</button></form>';for(key in dialogReplacements){if($.wysiwyg.i18n){translation=$.wysiwyg.i18n.t(dialogReplacements[key],"dialogs.image");if(translation===dialogReplacements[key]){translation=$.wysiwyg.i18n.t(dialogReplacements[key],"dialogs")}dialogReplacements[key]=translation}formImageHtml=formImageHtml.replace("{"+key+"}",dialogReplacements[key])}if(img.self){img.src=img.self.src?img.self.src:"";img.alt=img.self.alt?img.self.alt:"";img.title=img.self.title?img.self.title:"";img.width=img.self.width?img.self.width:"";img.height=img.self.height?img.self.height:"";img.asp=img.width/img.width}elements=$(formImageHtml);elements=self.makeForm(elements,img);dialog=elements.appendTo("body");dialog.dialog({modal:true,resizable:false,open:function(ev,ui){$("#wysiwyg_submit",dialog).click(function(e){self.processInsert(dialog.container,Wysiwyg,img);$(dialog).dialog("close");return false});$("#wysiwyg_reset",dialog).click(function(e){$(dialog).dialog("close");return false});$('fieldset',dialog).click(function(e){e.stopPropagation()});$("select, input[type=text]",dialog).uniform();$('.width',dialog).wl_Number({step:10,onChange:function(value){$('.height',dialog).val(Math.ceil(value/(img.asp||1)))}});$('.height',dialog).wl_Number({step:10,onChange:function(value){$('.width',dialog).val(Math.floor(value*(img.asp||1)))}});$('input[name="src"]',dialog).wl_URL()},close:function(ev,ui){dialog.dialog("destroy");dialog.remove()}});$(Wysiwyg.editorDoc).trigger("editorRefresh.wysiwyg")},processInsert:function(context,Wysiwyg,img){var image,url=$('input[name="src"]',context).val(),title=$('input[name="imgtitle"]',context).val(),description=$('input[name="description"]',context).val(),width=$('input[name="width"]',context).val(),height=$('input[name="height"]',context).val(),styleFloat=$('select[name="float"]',context).val(),style=[],found,baseUrl;if(Wysiwyg.options.controlImage.forceRelativeUrls){baseUrl=window.location.protocol+"//"+window.location.hostname;if(0===url.indexOf(baseUrl)){url=url.substr(baseUrl.length)}}if(img.self){$(img.self).attr("src",url).attr("title",title).attr("alt",description).css("float",styleFloat);if(width.toString().match(/^[0-9]+(px|%)?$/)){$(img.self).css("width",width)}else{$(img.self).css("width","")}if(height.toString().match(/^[0-9]+(px|%)?$/)){$(img.self).css("height",height)}else{$(img.self).css("height","")}Wysiwyg.saveContent()}else{found=width.toString().match(/^[0-9]+(px|%)?$/);if(found){if(found[1]){style.push("width: "+width+";")}else{style.push("width: "+width+"px;")}}found=height.toString().match(/^[0-9]+(px|%)?$/);if(found){if(found[1]){style.push("height: "+height+";")}else{style.push("height: "+height+"px;")}}if(styleFloat.length>0){style.push("float: "+styleFloat+";")}if(style.length>0){style=' style="'+style.join(" ")+'"'}image="<img src='"+url+"' title='"+title+"' alt='"+description+"'"+style+"/>";Wysiwyg.insertHtml(image)}},makeForm:function(form,img){form.find("input[name=src]").val(img.src);form.find("input[name=imgtitle]").val(img.title);form.find("input[name=description]").val(img.alt);form.find('input[name="width"]').val(img.width);form.find('input[name="height"]').val(img.height);form.find('img').attr("src",img.src);img.asp=img.width/img.height;form.find("input[name=src]").bind("change",function(){var image=new Image();var text=$('#wysiwyg_submit',form).find('span').text();form.find('img').removeAttr("src");$('#wysiwyg_submit',form).prop('disabled',true).find('span').text('wait...');image.onload=function(){form.find('img').attr("src",image.src);img.asp=image.width/image.height;form.find('input[name="width"]').val(image.width);form.find('input[name="height"]').val(image.height);$('#wysiwyg_submit',form).find('span').text(text);$('#wysiwyg_submit',form).prop('disabled',false)};image.src=this.value});return form}};$.wysiwyg.insertImage=function(object,url,attributes){return object.each(function(){var Wysiwyg=$(this).data("wysiwyg"),image,attribute;if(!Wysiwyg){return this}if(!url||url.length===0){return this}if($.browser.msie){Wysiwyg.ui.focus()}if(attributes){Wysiwyg.editorDoc.execCommand("insertImage",false,"#jwysiwyg#");image=Wysiwyg.getElementByAttributeValue("img","src","#jwysiwyg#");if(image){image.src=url;for(attribute in attributes){if(attributes.hasOwnProperty(attribute)){image.setAttribute(attribute,attributes[attribute])}}}}else{Wysiwyg.editorDoc.execCommand("insertImage",false,url)}Wysiwyg.saveContent();$(Wysiwyg.editorDoc).trigger("editorRefresh.wysiwyg");return this})}})(jQuery);(function($){if(undefined===$.wysiwyg){throw"wysiwyg.table.js depends on $.wysiwyg"}if(!$.wysiwyg.controls){$.wysiwyg.controls={}}var insertTable=function(colCount,rowCount,filler){if(isNaN(rowCount)||isNaN(colCount)||rowCount===null||colCount===null){return}var i,j,html=['<table border="1" style="width: 100%;"><tbody>'];colCount=parseInt(colCount,10);rowCount=parseInt(rowCount,10);if(filler===null){filler="&nbsp;"}filler="<td>"+filler+"</td>";for(i=rowCount;i>0;i-=1){html.push("<tr>");for(j=colCount;j>0;j-=1){html.push(filler)}html.push("</tr>")}html.push("</tbody></table>");return this.insertHtml(html.join(""))};$.wysiwyg.controls.table=function(Wysiwyg){var dialog,colCount,rowCount,formTableHtml,formTextLegend="Insert table",formTextCols="Count of columns",formTextRows="Count of rows",formTextSubmit="Insert table",formTextReset="Cancel";if($.wysiwyg.i18n){formTextLegend=$.wysiwyg.i18n.t(formTextLegend,"dialogs.table");formTextCols=$.wysiwyg.i18n.t(formTextCols,"dialogs.table");formTextRows=$.wysiwyg.i18n.t(formTextRows,"dialogs.table");formTextSubmit=$.wysiwyg.i18n.t(formTextSubmit,"dialogs.table");formTextReset=$.wysiwyg.i18n.t(formTextReset,"dialogs")}formTableHtml='<form class="wysiwyg" title="'+formTextLegend+'">'+formTextCols+': <input type="text" name="colCount" value="3" class="integer" ><br>'+formTextRows+': <input type="text" name="rowCount" value="3" class="integer" ><hr>'+'<button class="button" id="wysiwyg_submit">'+formTextSubmit+'</button> '+'<button class="button" id="wysiwyg_reset">'+formTextReset+'</button></form>';if(!Wysiwyg.insertTable){Wysiwyg.insertTable=insertTable}dialog=$(formTableHtml).appendTo("body");dialog.dialog({modal:true,resizable:false,open:function(event,ui){$("#wysiwyg_submit",dialog).click(function(e){e.preventDefault();rowCount=$('input[name="rowCount"]',dialog).val();colCount=$('input[name="colCount"]',dialog).val();Wysiwyg.insertTable(colCount,rowCount,Wysiwyg.defaults.tableFiller);$(dialog).dialog("close")});$("#wysiwyg_reset",dialog).click(function(e){e.preventDefault();$(dialog).dialog("close")});$("select, input[type=text]",dialog).uniform();$('.integer',dialog).wl_Number()},close:function(event,ui){dialog.dialog("destroy");dialog.remove()}});$(Wysiwyg.editorDoc).trigger("editorRefresh.wysiwyg")};$.wysiwyg.insertTable=function(object,colCount,rowCount,filler){return object.each(function(){var Wysiwyg=$(this).data("wysiwyg");if(!Wysiwyg.insertTable){Wysiwyg.insertTable=insertTable}if(!Wysiwyg){return this}Wysiwyg.insertTable(colCount,rowCount,filler);$(Wysiwyg.editorDoc).trigger("editorRefresh.wysiwyg");return this})}})(jQuery);(function($){if(undefined===$.wysiwyg){throw"wysiwyg.link.js depends on $.wysiwyg"}if(!$.wysiwyg.controls){$.wysiwyg.controls={}}$.wysiwyg.controls.link={init:function(Wysiwyg){var self=this,elements,dialog,url,a,selection,formLinkHtml,formTextLegend,formTextUrl,formTextTitle,formTextTarget,formTextSubmit,formTextReset,baseUrl;formTextLegend="Insert Link";formTextUrl="Link URL";formTextTitle="Link Title";formTextTarget="Link Target";formTextSubmit="Insert Link";formTextReset="Cancel";if($.wysiwyg.i18n){formTextLegend=$.wysiwyg.i18n.t(formTextLegend,"dialogs.link");formTextUrl=$.wysiwyg.i18n.t(formTextUrl,"dialogs.link");formTextTitle=$.wysiwyg.i18n.t(formTextTitle,"dialogs.link");formTextTarget=$.wysiwyg.i18n.t(formTextTarget,"dialogs.link");formTextSubmit=$.wysiwyg.i18n.t(formTextSubmit,"dialogs.link");formTextReset=$.wysiwyg.i18n.t(formTextReset,"dialogs")}formLinkHtml='<form class="wysiwyg" title="'+formTextLegend+'">'+formTextUrl+': <input type="text" name="linkhref" value="">'+formTextTitle+': <input type="text" name="linktitle" value="">'+formTextTarget+': <input type="text" name="linktarget" value=""><hr>'+'<button class="button" id="wysiwyg_submit">'+formTextSubmit+'</button> '+'<button class="button" id="wysiwyg_reset">'+formTextReset+'</button></form>';a={self:Wysiwyg.dom.getElement("a"),href:"http://",title:"",target:""};if(a.self){a.href=a.self.href?a.self.href:a.href;a.title=a.self.title?a.self.title:"";a.target=a.self.target?a.self.target:""}elements=$(formLinkHtml);elements.find("input[name=linkhref]").val(a.href);elements.find("input[name=linktitle]").val(a.title);elements.find("input[name=linktarget]").val(a.target);if($.browser.msie){dialog=elements.appendTo(Wysiwyg.editorDoc.body)}else{dialog=elements.appendTo("body")}dialog.dialog({modal:true,resizable:false,open:function(ev,ui){$("#wysiwyg_submit",dialog).click(function(e){e.preventDefault();var url=$('input[name="linkhref"]',dialog).val(),title=$('input[name="linktitle"]',dialog).val(),target=$('input[name="linktarget"]',dialog).val(),baseUrl;if(Wysiwyg.options.controlLink.forceRelativeUrls){baseUrl=window.location.protocol+"//"+window.location.hostname;if(0===url.indexOf(baseUrl)){url=url.substr(baseUrl.length)}}if(a.self){if("string"===typeof(url)){if(url.length>0){$(a.self).attr("href",url).attr("title",title).attr("target",target)}else{$(a.self).replaceWith(a.self.innerHTML)}}}else{if($.browser.msie){Wysiwyg.ui.returnRange()}selection=Wysiwyg.getRangeText();img=Wysiwyg.dom.getElement("img");if((selection&&selection.length>0)||img){if($.browser.msie){Wysiwyg.ui.focus()}if("string"===typeof(url)){if(url.length>0){Wysiwyg.editorDoc.execCommand("createLink",false,url)}else{Wysiwyg.editorDoc.execCommand("unlink",false,null)}}a.self=Wysiwyg.dom.getElement("a");$(a.self).attr("href",url).attr("title",title);$(a.self).attr("target",target)}else if(Wysiwyg.options.messages.nonSelection){$.dialog(Wysiwyg.options.messages.nonSelection)}}Wysiwyg.saveContent();$(dialog).dialog("close")});$("#wysiwyg_reset",dialog).click(function(e){e.preventDefault();$(dialog).dialog("close")});$("select, input",dialog).uniform();$('input[name="linkhref"]',dialog).wl_URL()},close:function(ev,ui){dialog.dialog("destroy");dialog.remove()}});$(Wysiwyg.editorDoc).trigger("editorRefresh.wysiwyg")}};$.wysiwyg.createLink=function(object,url){return object.each(function(){var oWysiwyg=$(this).data("wysiwyg"),selection;if(!oWysiwyg){return this}if(!url||url.length===0){return this}selection=oWysiwyg.getRangeText();if(selection&&selection.length>0){if($.browser.msie){oWysiwyg.ui.focus()}oWysiwyg.editorDoc.execCommand("unlink",false,null);oWysiwyg.editorDoc.execCommand("createLink",false,url)}else if(oWysiwyg.options.messages.nonSelection){window.alert(oWysiwyg.options.messages.nonSelection)}})}})(jQuery);(function($){if(undefined===$.wysiwyg){throw"wysiwyg.cssWrap.js depends on $.wysiwyg"}if(!$.wysiwyg.controls){$.wysiwyg.controls={}}$.wysiwyg.controls.cssWrap={init:function(Wysiwyg){var self=this,formWrapHtml,key,translation,dialogReplacements={legend:"Wrap Element",wrapperType:"Wrapper Type",ID:"ID","class":"Class",wrap:"Wrap",unwrap:"Unwrap",cancel:"Cancel"};formWrapHtml='<form class="wysiwyg" title="{legend}"><fieldset>'+'{wrapperType}: <select name="type"><option value="span">Span</option><option value="div">Div</option></select><br>'+'{ID}: <input name="id" type="text"><br>'+'{class}: <input name="class" type="text" ><hr>'+'<button class="cssWrap-unwrap" style="display:none;">{unwrap}</button> '+'<button class="cssWrap-submit">{wrap}</button> '+'<button class="cssWrap-cancel">{cancel}</button></fieldset></form>';for(key in dialogReplacements){if($.wysiwyg.i18n){translation=$.wysiwyg.i18n.t(dialogReplacements[key]);if(translation===dialogReplacements[key]){translation=$.wysiwyg.i18n.t(dialogReplacements[key],"dialogs")}dialogReplacements[key]=translation}formWrapHtml=formWrapHtml.replace("{"+key+"}",dialogReplacements[key])}if(!$(".wysiwyg-dialog-wrapper").length){$(formWrapHtml).appendTo("body");$("form.wysiwyg").dialog({modal:true,resizable:false,open:function(ev,ui){$this=$(this);var range=Wysiwyg.getInternalRange(),common;if(range){if($.browser.msie){Wysiwyg.ui.focus()}common=$(range.commonAncestorContainer)}else{alert("You must select some elements before you can wrap them.");$this.dialog("close");return 0}var $nodeName=range.commonAncestorContainer.nodeName.toLowerCase();if(common.parent(".wysiwygCssWrapper").length){alert(common.parent(".wysiwygCssWrapper").get(0).nodeName.toLowerCase());$this.find("select[name=type]").val(common.parent(".wysiwygCssWrapper").get(0).nodeName.toLowerCase());$this.find("select[name=type]").attr("disabled","disabled");$this.find("input[name=id]").val(common.parent(".wysiwygCssWrapper").attr("id"));$this.find("input[name=class]").val(common.parent(".wysiwygCssWrapper").attr("class").replace('wysiwygCssWrapper ',''));$("form.wysiwyg").find(".cssWrap-unwrap").show();$("form.wysiwyg").find(".cssWrap-unwrap").click(function(e){e.preventDefault();if($nodeName!=="body"){common.unwrap()}$this.dialog("close");return 1})}$("form.wysiwyg").find(".cssWrap-submit").click(function(e){e.preventDefault();var $wrapper=$("form.wysiwyg").find("select[name=type]").val();var $id=$("form.wysiwyg").find("input[name=id]").val();var $class=$("form.wysiwyg").find("input[name=class]").val();if($nodeName!=="body"){if(common.parent(".wysiwygCssWrapper").length){common.parent(".wysiwygCssWrapper").attr("id",$class);common.parent(".wysiwygCssWrapper").attr("class",$class)}else{common.wrap('<'+$wrapper+' id="'+$id+'" class="'+"wysiwygCssWrapper "+$class+'"/>')}}else{}$this.dialog("close")});$("form.wysiwyg").find(".cssWrap-cancel").click(function(e){e.preventDefault();$this.dialog("close");return 1});$("form.wysiwyg").find("select, input[type=text]").uniform()},close:function(){$(this).dialog("destroy");$(this).remove()}});Wysiwyg.saveContent()}$(Wysiwyg.editorDoc).trigger("editorRefresh.wysiwyg");return 1}}})(jQuery);(function($){"use strict";if(undefined===$.wysiwyg){throw"wysiwyg.colorpicker.js depends on $.wysiwyg"}if(!$.wysiwyg.controls){$.wysiwyg.controls={}}$.wysiwyg.controls.colorpicker={modalOpen:false,init:function(Wysiwyg){if($.wysiwyg.controls.colorpicker.modalOpen===true){return false}else{$.wysiwyg.controls.colorpicker.modalOpen=true}var self=this,elements,dialog,colorpickerHtml,dialogReplacements,key,translation;dialogReplacements={legend:"Colorpicker",color:"Color",submit:"Apply",cancel:"Cancel"};colorpickerHtml='<form class="wysiwyg" title="{legend}">'+'{color}: <input type="text" class="color" id="wysiwyg_colorpicker" name="wysiwyg_colorpicker" value=""><hr>'+'<button id="wysiwyg_colorpicker-submit">{submit}</button> '+'<button id="wysiwyg_colorpicker-cancel">{cancel}</button></form>';for(key in dialogReplacements){if($.wysiwyg.i18n){translation=$.wysiwyg.i18n.t(dialogReplacements[key],"dialogs.colorpicker");if(translation===dialogReplacements[key]){translation=$.wysiwyg.i18n.t(dialogReplacements[key],"dialogs")}dialogReplacements[key]=translation}colorpickerHtml=colorpickerHtml.replace("{"+key+"}",dialogReplacements[key])}elements=$(colorpickerHtml);dialog=elements.appendTo("body");dialog.dialog({modal:true,resizable:false,open:function(event,ui){if($.browser.msie){Wysiwyg.ui.returnRange()}var selection=Wysiwyg.getRangeText(),content=Wysiwyg.getContent(),color='',regexp=/#([a-fA-F0-9]{3,6})/;if(content.match(regexp)){regexp.exec(content);color=RegExp.$1}else{regexp=/rgb\((\d+), (\d+), (\d+)\)/;if(content.match(regexp)){regexp.exec(content);var r=RegExp.$1,g=RegExp.$2,b=RegExp.$3;color=parseInt(r).toString(16)+parseInt(g).toString(16)+parseInt(b).toString(16)}}$('#wysiwyg_colorpicker').val('#'+color).wl_Color();$("#wysiwyg_colorpicker-submit").click(function(e){e.preventDefault();var color=$('#wysiwyg_colorpicker').val();if($.browser.msie){Wysiwyg.ui.returnRange();Wysiwyg.ui.focus()}if(color)Wysiwyg.editorDoc.execCommand('ForeColor',false,color);Wysiwyg.saveContent();$(dialog).dialog("close");return false});$("#wysiwyg_colorpicker-cancel").click(function(e){e.preventDefault();if($.browser.msie){Wysiwyg.ui.returnRange()}$(dialog).dialog("close");return false})},close:function(event,ui){$.wysiwyg.controls.colorpicker.modalOpen=false;dialog.dialog("destroy");dialog.remove()}})}}})(jQuery)});$(document).ready(function(){(function($,undefined){var defaults={defaultView:'month',aspectRatio:1.35,header:{left:'title',center:'',right:'today prev,next'},weekends:true,allDayDefault:true,ignoreTimezone:true,lazyFetching:true,startParam:'start',endParam:'end',titleFormat:{month:'MMMM yyyy',week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:'dddd, MMM d, yyyy'},columnFormat:{month:'ddd',week:'ddd M/d',day:'dddd M/d'},timeFormat:{'':'h(:mm)t'},isRTL:false,firstDay:0,monthNames:['January','February','March','April','May','June','July','August','September','October','November','December'],monthNamesShort:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],dayNames:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],dayNamesShort:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],buttonText:{prev:'&nbsp;&#9668;&nbsp;',next:'&nbsp;&#9658;&nbsp;',prevYear:'&nbsp;&lt;&lt;&nbsp;',nextYear:'&nbsp;&gt;&gt;&nbsp;',today:'today',month:'month',week:'week',day:'day'},theme:false,buttonIcons:{prev:'circle-triangle-w',next:'circle-triangle-e'},unselectAuto:true,dropAccept:'*'};var rtlDefaults={header:{left:'next,prev today',center:'',right:'title'},buttonText:{prev:'&nbsp;&#9658;&nbsp;',next:'&nbsp;&#9668;&nbsp;',prevYear:'&nbsp;&gt;&gt;&nbsp;',nextYear:'&nbsp;&lt;&lt;&nbsp;'},buttonIcons:{prev:'circle-triangle-e',next:'circle-triangle-w'}};var fc=$.fullCalendar={version:"1.5.1"};var fcViews=fc.views={};$.fn.fullCalendar=function(options){if(typeof options=='string'){var args=Array.prototype.slice.call(arguments,1);var res;this.each(function(){var calendar=$.data(this,'fullCalendar');if(calendar&&$.isFunction(calendar[options])){var r=calendar[options].apply(calendar,args);if(res===undefined){res=r}if(options=='destroy'){$.removeData(this,'fullCalendar')}}});if(res!==undefined){return res}return this}var eventSources=options.eventSources||[];delete options.eventSources;if(options.events){eventSources.push(options.events);delete options.events}options=$.extend(true,{},defaults,(options.isRTL||options.isRTL===undefined&&defaults.isRTL)?rtlDefaults:{},options);this.each(function(i,_element){var element=$(_element);var calendar=new Calendar(element,options,eventSources);element.data('fullCalendar',calendar);calendar.render()});return this};function setDefaults(d){$.extend(true,defaults,d)}function Calendar(element,options,eventSources){var t=this;t.options=options;t.render=render;t.destroy=destroy;t.refetchEvents=refetchEvents;t.reportEvents=reportEvents;t.reportEventChange=reportEventChange;t.rerenderEvents=rerenderEvents;t.changeView=changeView;t.select=select;t.unselect=unselect;t.prev=prev;t.next=next;t.prevYear=prevYear;t.nextYear=nextYear;t.today=today;t.gotoDate=gotoDate;t.incrementDate=incrementDate;t.formatDate=function(format,date){return formatDate(format,date,options)};t.formatDates=function(format,date1,date2){return formatDates(format,date1,date2,options)};t.getDate=getDate;t.getView=getView;t.option=option;t.trigger=trigger;EventManager.call(t,options,eventSources);var isFetchNeeded=t.isFetchNeeded;var fetchEvents=t.fetchEvents;var _element=element[0];var header;var headerElement;var content;var tm;var currentView;var viewInstances={};var elementOuterWidth;var suggestedViewHeight;var absoluteViewElement;var resizeUID=0;var ignoreWindowResize=0;var date=new Date();var events=[];var _dragElement;setYMD(date,options.year,options.month,options.date);function render(inc){if(!content){initialRender()}else{calcSize();markSizesDirty();markEventsDirty();renderView(inc)}}function initialRender(){tm=options.theme?'ui':'fc';element.addClass('fc');if(options.isRTL){element.addClass('fc-rtl')}if(options.theme){element.addClass('ui-widget')}content=$("<div class='fc-content' style='position:relative'/>").prependTo(element);header=new Header(t,options);headerElement=header.render();if(headerElement){element.prepend(headerElement)}changeView(options.defaultView);$(window).resize(windowResize);if(!bodyVisible()){lateRender()}}function lateRender(){setTimeout(function(){if(!currentView.start&&bodyVisible()){renderView()}},0)}function destroy(){$(window).unbind('resize',windowResize);header.destroy();content.remove();element.removeClass('fc fc-rtl ui-widget')}function elementVisible(){return _element.offsetWidth!==0}function bodyVisible(){return $('body')[0].offsetWidth!==0}function changeView(newViewName){if(!currentView||newViewName!=currentView.name){ignoreWindowResize++;unselect();var oldView=currentView;var newViewElement;if(oldView){(oldView.beforeHide||noop)();setMinHeight(content,content.height());oldView.element.hide()}else{setMinHeight(content,1)}content.css('overflow','hidden');currentView=viewInstances[newViewName];if(currentView){currentView.element.show()}else{currentView=viewInstances[newViewName]=new fcViews[newViewName](newViewElement=absoluteViewElement=$("<div class='fc-view fc-view-"+newViewName+"' style='position:absolute'/>").appendTo(content),t)}if(oldView){header.deactivateButton(oldView.name)}header.activateButton(newViewName);renderView();content.css('overflow','');if(oldView){setMinHeight(content,1)}if(!newViewElement){(currentView.afterShow||noop)()}ignoreWindowResize--}}function renderView(inc){if(elementVisible()){ignoreWindowResize++;unselect();if(suggestedViewHeight===undefined){calcSize()}var forceEventRender=false;if(!currentView.start||inc||date<currentView.start||date>=currentView.end){currentView.render(date,inc||0);setSize(true);forceEventRender=true}else if(currentView.sizeDirty){currentView.clearEvents();setSize();forceEventRender=true}else if(currentView.eventsDirty){currentView.clearEvents();forceEventRender=true}currentView.sizeDirty=false;currentView.eventsDirty=false;updateEvents(forceEventRender);elementOuterWidth=element.outerWidth();header.updateTitle(currentView.title);var today=new Date();if(today>=currentView.start&&today<currentView.end){header.disableButton('today')}else{header.enableButton('today')}ignoreWindowResize--;currentView.trigger('viewDisplay',_element)}}function updateSize(){markSizesDirty();if(elementVisible()){calcSize();setSize();unselect();currentView.clearEvents();currentView.renderEvents(events);currentView.sizeDirty=false}}function markSizesDirty(){$.each(viewInstances,function(i,inst){inst.sizeDirty=true})}function calcSize(){if(options.contentHeight){suggestedViewHeight=options.contentHeight}else if(options.height){suggestedViewHeight=options.height-(headerElement?headerElement.height():0)-vsides(content)}else{suggestedViewHeight=Math.round(content.width()/Math.max(options.aspectRatio,.5))}}function setSize(dateChanged){ignoreWindowResize++;currentView.setHeight(suggestedViewHeight,dateChanged);if(absoluteViewElement){absoluteViewElement.css('position','relative');absoluteViewElement=null}currentView.setWidth(content.width(),dateChanged);ignoreWindowResize--}function windowResize(){if(!ignoreWindowResize){if(currentView.start){var uid=++resizeUID;setTimeout(function(){if(uid==resizeUID&&!ignoreWindowResize&&elementVisible()){if(elementOuterWidth!=(elementOuterWidth=element.outerWidth())){ignoreWindowResize++;updateSize();currentView.trigger('windowResize',_element);ignoreWindowResize--}}},200)}else{lateRender()}}}function updateEvents(forceRender){if(!options.lazyFetching||isFetchNeeded(currentView.visStart,currentView.visEnd)){refetchEvents()}else if(forceRender){rerenderEvents()}}function refetchEvents(){fetchEvents(currentView.visStart,currentView.visEnd)}function reportEvents(_events){events=_events;rerenderEvents()}function reportEventChange(eventID){rerenderEvents(eventID)}function rerenderEvents(modifiedEventID){markEventsDirty();if(elementVisible()){currentView.clearEvents();currentView.renderEvents(events,modifiedEventID);currentView.eventsDirty=false}}function markEventsDirty(){$.each(viewInstances,function(i,inst){inst.eventsDirty=true})}function select(start,end,allDay){currentView.select(start,end,allDay===undefined?true:allDay)}function unselect(){if(currentView){currentView.unselect()}}function prev(){renderView(-1)}function next(){renderView(1)}function prevYear(){addYears(date,-1);renderView()}function nextYear(){addYears(date,1);renderView()}function today(){date=new Date();renderView()}function gotoDate(year,month,dateOfMonth){if(year instanceof Date){date=cloneDate(year)}else{setYMD(date,year,month,dateOfMonth)}renderView()}function incrementDate(years,months,days){if(years!==undefined){addYears(date,years)}if(months!==undefined){addMonths(date,months)}if(days!==undefined){addDays(date,days)}renderView()}function getDate(){return cloneDate(date)}function getView(){return currentView}function option(name,value){if(value===undefined){return options[name]}if(name=='height'||name=='contentHeight'||name=='aspectRatio'){options[name]=value;updateSize()}}function trigger(name,thisObj){if(options[name]){return options[name].apply(thisObj||_element,Array.prototype.slice.call(arguments,2))}}if(options.droppable){$(document).bind('dragstart',function(ev,ui){var _e=ev.target;var e=$(_e);if(!e.parents('.fc').length){var accept=options.dropAccept;if($.isFunction(accept)?accept.call(_e,e):e.is(accept)){_dragElement=_e;currentView.dragStart(_dragElement,ev,ui)}}}).bind('dragstop',function(ev,ui){if(_dragElement){currentView.dragStop(_dragElement,ev,ui);_dragElement=null}})}}function Header(calendar,options){var t=this;t.render=render;t.destroy=destroy;t.updateTitle=updateTitle;t.activateButton=activateButton;t.deactivateButton=deactivateButton;t.disableButton=disableButton;t.enableButton=enableButton;var element=$([]);var tm;function render(){tm=options.theme?'ui':'fc';var sections=options.header;if(sections){element=$("<table class='fc-header' style='width:100%'/>").append($("<tr/>").append(renderSection('left')).append(renderSection('center')).append(renderSection('right')));return element}}function destroy(){element.remove()}function renderSection(position){var e=$("<td class='fc-header-"+position+"'/>");var buttonStr=options.header[position];if(buttonStr){$.each(buttonStr.split(' '),function(i){if(i>0){e.append("<span class='fc-header-space'/>")}var prevButton;$.each(this.split(','),function(j,buttonName){if(buttonName=='title'){e.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>");if(prevButton){prevButton.addClass(tm+'-corner-right')}prevButton=null}else{var buttonClick;if(calendar[buttonName]){buttonClick=calendar[buttonName]}else if(fcViews[buttonName]){buttonClick=function(){button.removeClass(tm+'-state-hover');calendar.changeView(buttonName)}}if(buttonClick){var icon=options.theme?smartProperty(options.buttonIcons,buttonName):null;var text=smartProperty(options.buttonText,buttonName);var button=$("<span class='fc-button fc-button-"+buttonName+" "+tm+"-state-default'>"+"<span class='fc-button-inner'>"+"<span class='fc-button-content'>"+(icon?"<span class='fc-icon-wrap'>"+"<span class='ui-icon ui-icon-"+icon+"'/>"+"</span>":text)+"</span>"+"<span class='fc-button-effect'><span></span></span>"+"</span>"+"</span>");if(button){button.click(function(){if(!button.hasClass(tm+'-state-disabled')){buttonClick()}}).mousedown(function(){button.not('.'+tm+'-state-active').not('.'+tm+'-state-disabled').addClass(tm+'-state-down')}).mouseup(function(){button.removeClass(tm+'-state-down')}).hover(function(){button.not('.'+tm+'-state-active').not('.'+tm+'-state-disabled').addClass(tm+'-state-hover')},function(){button.removeClass(tm+'-state-hover').removeClass(tm+'-state-down')}).appendTo(e);if(!prevButton){button.addClass(tm+'-corner-left')}prevButton=button}}}});if(prevButton){prevButton.addClass(tm+'-corner-right')}})}return e}function updateTitle(html){element.find('h2').html(html)}function activateButton(buttonName){element.find('span.fc-button-'+buttonName).addClass(tm+'-state-active')}function deactivateButton(buttonName){element.find('span.fc-button-'+buttonName).removeClass(tm+'-state-active')}function disableButton(buttonName){element.find('span.fc-button-'+buttonName).addClass(tm+'-state-disabled')}function enableButton(buttonName){element.find('span.fc-button-'+buttonName).removeClass(tm+'-state-disabled')}}fc.sourceNormalizers=[];fc.sourceFetchers=[];var ajaxDefaults={dataType:'json',cache:false};var eventGUID=1;function EventManager(options,_sources){var t=this;t.isFetchNeeded=isFetchNeeded;t.fetchEvents=fetchEvents;t.addEventSource=addEventSource;t.removeEventSource=removeEventSource;t.updateEvent=updateEvent;t.renderEvent=renderEvent;t.removeEvents=removeEvents;t.clientEvents=clientEvents;t.normalizeEvent=normalizeEvent;var trigger=t.trigger;var getView=t.getView;var reportEvents=t.reportEvents;var stickySource={events:[]};var sources=[stickySource];var rangeStart,rangeEnd;var currentFetchID=0;var pendingSourceCnt=0;var loadingLevel=0;var cache=[];for(var i=0;i<_sources.length;i++){_addEventSource(_sources[i])}function isFetchNeeded(start,end){return!rangeStart||start<rangeStart||end>rangeEnd}function fetchEvents(start,end){rangeStart=start;rangeEnd=end;cache=[];var fetchID=++currentFetchID;var len=sources.length;pendingSourceCnt=len;for(var i=0;i<len;i++){fetchEventSource(sources[i],fetchID)}}function fetchEventSource(source,fetchID){_fetchEventSource(source,function(events){if(fetchID==currentFetchID){if(events){for(var i=0;i<events.length;i++){events[i].source=source;normalizeEvent(events[i])}cache=cache.concat(events)}pendingSourceCnt--;if(!pendingSourceCnt){reportEvents(cache)}}})}function _fetchEventSource(source,callback){var i;var fetchers=fc.sourceFetchers;var res;for(i=0;i<fetchers.length;i++){res=fetchers[i](source,rangeStart,rangeEnd,callback);if(res===true){return}else if(typeof res=='object'){_fetchEventSource(res,callback);return}}var events=source.events;if(events){if($.isFunction(events)){pushLoading();events(cloneDate(rangeStart),cloneDate(rangeEnd),function(events){callback(events);popLoading()})}else if($.isArray(events)){callback(events)}else{callback()}}else{var url=source.url;if(url){var success=source.success;var error=source.error;var complete=source.complete;var data=$.extend({},source.data||{});var startParam=firstDefined(source.startParam,options.startParam);var endParam=firstDefined(source.endParam,options.endParam);if(startParam){data[startParam]=Math.round(+rangeStart/1000)}if(endParam){data[endParam]=Math.round(+rangeEnd/1000)}pushLoading();$.ajax($.extend({},ajaxDefaults,source,{data:data,success:function(events){events=events||[];var res=applyAll(success,this,arguments);if($.isArray(res)){events=res}callback(events)},error:function(){applyAll(error,this,arguments);callback()},complete:function(){applyAll(complete,this,arguments);popLoading()}}))}else{callback()}}}function addEventSource(source){source=_addEventSource(source);if(source){pendingSourceCnt++;fetchEventSource(source,currentFetchID)}}function _addEventSource(source){if($.isFunction(source)||$.isArray(source)){source={events:source}}else if(typeof source=='string'){source={url:source}}if(typeof source=='object'){normalizeSource(source);sources.push(source);return source}}function removeEventSource(source){sources=$.grep(sources,function(src){return!isSourcesEqual(src,source)});cache=$.grep(cache,function(e){return!isSourcesEqual(e.source,source)});reportEvents(cache)}function updateEvent(event){var i,len=cache.length,e,defaultEventEnd=getView().defaultEventEnd,startDelta=event.start-event._start,endDelta=event.end?(event.end-(event._end||defaultEventEnd(event))):0;for(i=0;i<len;i++){e=cache[i];if(e._id==event._id&&e!=event){e.start=new Date(+e.start+startDelta);if(event.end){if(e.end){e.end=new Date(+e.end+endDelta)}else{e.end=new Date(+defaultEventEnd(e)+endDelta)}}else{e.end=null}e.title=event.title;e.url=event.url;e.allDay=event.allDay;e.className=event.className;e.editable=event.editable;e.color=event.color;e.backgroudColor=event.backgroudColor;e.borderColor=event.borderColor;e.textColor=event.textColor;normalizeEvent(e)}}normalizeEvent(event);reportEvents(cache)}function renderEvent(event,stick){normalizeEvent(event);if(!event.source){if(stick){stickySource.events.push(event);event.source=stickySource}cache.push(event)}reportEvents(cache)}function removeEvents(filter){if(!filter){cache=[];for(var i=0;i<sources.length;i++){if($.isArray(sources[i].events)){sources[i].events=[]}}}else{if(!$.isFunction(filter)){var id=filter+'';filter=function(e){return e._id==id}}cache=$.grep(cache,filter,true);for(var i=0;i<sources.length;i++){if($.isArray(sources[i].events)){sources[i].events=$.grep(sources[i].events,filter,true)}}}reportEvents(cache)}function clientEvents(filter){if($.isFunction(filter)){return $.grep(cache,filter)}else if(filter){filter+='';return $.grep(cache,function(e){return e._id==filter})}return cache}function pushLoading(){if(!loadingLevel++){trigger('loading',null,true)}}function popLoading(){if(!--loadingLevel){trigger('loading',null,false)}}function normalizeEvent(event){var source=event.source||{};var ignoreTimezone=firstDefined(source.ignoreTimezone,options.ignoreTimezone);event._id=event._id||(event.id===undefined?'_fc'+eventGUID++:event.id+'');if(event.date){if(!event.start){event.start=event.date}delete event.date}event._start=cloneDate(event.start=parseDate(event.start,ignoreTimezone));event.end=parseDate(event.end,ignoreTimezone);if(event.end&&event.end<=event.start){event.end=null}event._end=event.end?cloneDate(event.end):null;if(event.allDay===undefined){event.allDay=firstDefined(source.allDayDefault,options.allDayDefault)}if(event.className){if(typeof event.className=='string'){event.className=event.className.split(/\s+/)}}else{event.className=[]}}function normalizeSource(source){if(source.className){if(typeof source.className=='string'){source.className=source.className.split(/\s+/)}}else{source.className=[]}var normalizers=fc.sourceNormalizers;for(var i=0;i<normalizers.length;i++){normalizers[i](source)}}function isSourcesEqual(source1,source2){return source1&&source2&&getSourcePrimitive(source1)==getSourcePrimitive(source2)}function getSourcePrimitive(source){return((typeof source=='object')?(source.events||source.url):'')||source}}fc.addDays=addDays;fc.cloneDate=cloneDate;fc.parseDate=parseDate;fc.parseISO8601=parseISO8601;fc.parseTime=parseTime;fc.formatDate=formatDate;fc.formatDates=formatDates;var dayIDs=['sun','mon','tue','wed','thu','fri','sat'],DAY_MS=86400000,HOUR_MS=3600000,MINUTE_MS=60000;function addYears(d,n,keepTime){d.setFullYear(d.getFullYear()+n);if(!keepTime){clearTime(d)}return d}function addMonths(d,n,keepTime){if(+d){var m=d.getMonth()+n,check=cloneDate(d);check.setDate(1);check.setMonth(m);d.setMonth(m);if(!keepTime){clearTime(d)}while(d.getMonth()!=check.getMonth()){d.setDate(d.getDate()+(d<check?1:-1))}}return d}function addDays(d,n,keepTime){if(+d){var dd=d.getDate()+n,check=cloneDate(d);check.setHours(9);check.setDate(dd);d.setDate(dd);if(!keepTime){clearTime(d)}fixDate(d,check)}return d}function fixDate(d,check){if(+d){while(d.getDate()!=check.getDate()){d.setTime(+d+(d<check?1:-1)*HOUR_MS)}}}function addMinutes(d,n){d.setMinutes(d.getMinutes()+n);return d}function clearTime(d){d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setMilliseconds(0);return d}function cloneDate(d,dontKeepTime){if(dontKeepTime){return clearTime(new Date(+d))}return new Date(+d)}function zeroDate(){var i=0,d;do{d=new Date(1970,i++,1)}while(d.getHours());return d}function skipWeekend(date,inc,excl){inc=inc||1;while(!date.getDay()||(excl&&date.getDay()==1||!excl&&date.getDay()==6)){addDays(date,inc)}return date}function dayDiff(d1,d2){return Math.round((cloneDate(d1,true)-cloneDate(d2,true))/DAY_MS)}function setYMD(date,y,m,d){if(y!==undefined&&y!=date.getFullYear()){date.setDate(1);date.setMonth(0);date.setFullYear(y)}if(m!==undefined&&m!=date.getMonth()){date.setDate(1);date.setMonth(m)}if(d!==undefined){date.setDate(d)}}function parseDate(s,ignoreTimezone){if(typeof s=='object'){return s}if(typeof s=='number'){return new Date(s*1000)}if(typeof s=='string'){if(s.match(/^\d+(\.\d+)?$/)){return new Date(parseFloat(s)*1000)}if(ignoreTimezone===undefined){ignoreTimezone=true}return parseISO8601(s,ignoreTimezone)||(s?new Date(s):null)}return null}function parseISO8601(s,ignoreTimezone){var m=s.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!m){return null}var date=new Date(m[1],0,1);if(ignoreTimezone||!m[14]){var check=new Date(m[1],0,1,9,0);if(m[3]){date.setMonth(m[3]-1);check.setMonth(m[3]-1)}if(m[5]){date.setDate(m[5]);check.setDate(m[5])}fixDate(date,check);if(m[7]){date.setHours(m[7])}if(m[8]){date.setMinutes(m[8])}if(m[10]){date.setSeconds(m[10])}if(m[12]){date.setMilliseconds(Number("0."+m[12])*1000)}fixDate(date,check)}else{date.setUTCFullYear(m[1],m[3]?m[3]-1:0,m[5]||1);date.setUTCHours(m[7]||0,m[8]||0,m[10]||0,m[12]?Number("0."+m[12])*1000:0);var offset=Number(m[16])*60+(m[18]?Number(m[18]):0);offset*=m[15]=='-'?1:-1;date=new Date(+date+(offset*60*1000))}return date}function parseTime(s){if(typeof s=='number'){return s*60}if(typeof s=='object'){return s.getHours()*60+s.getMinutes()}var m=s.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(m){var h=parseInt(m[1],10);if(m[3]){h%=12;if(m[3].toLowerCase().charAt(0)=='p'){h+=12}}return h*60+(m[2]?parseInt(m[2],10):0)}}function formatDate(date,format,options){return formatDates(date,null,format,options)}function formatDates(date1,date2,format,options){options=options||defaults;var date=date1,otherDate=date2,i,len=format.length,c,i2,formatter,res='';for(i=0;i<len;i++){c=format.charAt(i);if(c=="'"){for(i2=i+1;i2<len;i2++){if(format.charAt(i2)=="'"){if(date){if(i2==i+1){res+="'"}else{res+=format.substring(i+1,i2)}i=i2}break}}}else if(c=='('){for(i2=i+1;i2<len;i2++){if(format.charAt(i2)==')'){var subres=formatDate(date,format.substring(i+1,i2),options);if(parseInt(subres.replace(/\D/,''),10)){res+=subres}i=i2;break}}}else if(c=='['){for(i2=i+1;i2<len;i2++){if(format.charAt(i2)==']'){var subformat=format.substring(i+1,i2);var subres=formatDate(date,subformat,options);if(subres!=formatDate(otherDate,subformat,options)){res+=subres}i=i2;break}}}else if(c=='{'){date=date2;otherDate=date1}else if(c=='}'){date=date1;otherDate=date2}else{for(i2=len;i2>i;i2--){if(formatter=dateFormatters[format.substring(i,i2)]){if(date){res+=formatter(date,options)}i=i2-1;break}}if(i2==i){if(date){res+=c}}}}return res};var dateFormatters={s:function(d){return d.getSeconds()},ss:function(d){return zeroPad(d.getSeconds())},m:function(d){return d.getMinutes()},mm:function(d){return zeroPad(d.getMinutes())},h:function(d){return d.getHours()%12||12},hh:function(d){return zeroPad(d.getHours()%12||12)},H:function(d){return d.getHours()},HH:function(d){return zeroPad(d.getHours())},d:function(d){return d.getDate()},dd:function(d){return zeroPad(d.getDate())},ddd:function(d,o){return o.dayNamesShort[d.getDay()]},dddd:function(d,o){return o.dayNames[d.getDay()]},M:function(d){return d.getMonth()+1},MM:function(d){return zeroPad(d.getMonth()+1)},MMM:function(d,o){return o.monthNamesShort[d.getMonth()]},MMMM:function(d,o){return o.monthNames[d.getMonth()]},yy:function(d){return(d.getFullYear()+'').substring(2)},yyyy:function(d){return d.getFullYear()},t:function(d){return d.getHours()<12?'a':'p'},tt:function(d){return d.getHours()<12?'am':'pm'},T:function(d){return d.getHours()<12?'A':'P'},TT:function(d){return d.getHours()<12?'AM':'PM'},u:function(d){return formatDate(d,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(d){var date=d.getDate();if(date>10&&date<20){return'th'}return['st','nd','rd'][date%10-1]||'th'}};fc.applyAll=applyAll;function exclEndDay(event){if(event.end){return _exclEndDay(event.end,event.allDay)}else{return addDays(cloneDate(event.start),1)}}function _exclEndDay(end,allDay){end=cloneDate(end);return allDay||end.getHours()||end.getMinutes()?addDays(end,1):clearTime(end)}function segCmp(a,b){return(b.msLength-a.msLength)*100+(a.event.start-b.event.start)}function segsCollide(seg1,seg2){return seg1.end>seg2.start&&seg1.start<seg2.end}function sliceSegs(events,visEventEnds,start,end){var segs=[],i,len=events.length,event,eventStart,eventEnd,segStart,segEnd,isStart,isEnd;for(i=0;i<len;i++){event=events[i];eventStart=event.start;eventEnd=visEventEnds[i];if(eventEnd>start&&eventStart<end){if(eventStart<start){segStart=cloneDate(start);isStart=false}else{segStart=eventStart;isStart=true}if(eventEnd>end){segEnd=cloneDate(end);isEnd=false}else{segEnd=eventEnd;isEnd=true}segs.push({event:event,start:segStart,end:segEnd,isStart:isStart,isEnd:isEnd,msLength:segEnd-segStart})}}return segs.sort(segCmp)}function stackSegs(segs){var levels=[],i,len=segs.length,seg,j,collide,k;for(i=0;i<len;i++){seg=segs[i];j=0;while(true){collide=false;if(levels[j]){for(k=0;k<levels[j].length;k++){if(segsCollide(levels[j][k],seg)){collide=true;break}}}if(collide){j++}else{break}}if(levels[j]){levels[j].push(seg)}else{levels[j]=[seg]}}return levels}function lazySegBind(container,segs,bindHandlers){container.unbind('mouseover').mouseover(function(ev){var parent=ev.target,e,i,seg;while(parent!=this){e=parent;parent=parent.parentNode}if((i=e._fci)!==undefined){e._fci=undefined;seg=segs[i];bindHandlers(seg.event,seg.element,seg);$(ev.target).trigger(ev)}ev.stopPropagation()})}function setOuterWidth(element,width,includeMargins){for(var i=0,e;i<element.length;i++){e=$(element[i]);e.width(Math.max(0,width-hsides(e,includeMargins)))}}function setOuterHeight(element,height,includeMargins){for(var i=0,e;i<element.length;i++){e=$(element[i]);e.height(Math.max(0,height-vsides(e,includeMargins)))}}function hsides(element,includeMargins){return hpadding(element)+hborders(element)+(includeMargins?hmargins(element):0)}function hpadding(element){return(parseFloat($.curCSS(element[0],'paddingLeft',true))||0)+(parseFloat($.curCSS(element[0],'paddingRight',true))||0)}function hmargins(element){return(parseFloat($.curCSS(element[0],'marginLeft',true))||0)+(parseFloat($.curCSS(element[0],'marginRight',true))||0)}function hborders(element){return(parseFloat($.curCSS(element[0],'borderLeftWidth',true))||0)+(parseFloat($.curCSS(element[0],'borderRightWidth',true))||0)}function vsides(element,includeMargins){return vpadding(element)+vborders(element)+(includeMargins?vmargins(element):0)}function vpadding(element){return(parseFloat($.curCSS(element[0],'paddingTop',true))||0)+(parseFloat($.curCSS(element[0],'paddingBottom',true))||0)}function vmargins(element){return(parseFloat($.curCSS(element[0],'marginTop',true))||0)+(parseFloat($.curCSS(element[0],'marginBottom',true))||0)}function vborders(element){return(parseFloat($.curCSS(element[0],'borderTopWidth',true))||0)+(parseFloat($.curCSS(element[0],'borderBottomWidth',true))||0)}function setMinHeight(element,height){height=(typeof height=='number'?height+'px':height);element.each(function(i,_element){_element.style.cssText+=';min-height:'+height+';_height:'+height})}function noop(){}function cmp(a,b){return a-b}function arrayMax(a){return Math.max.apply(Math,a)}function zeroPad(n){return(n<10?'0':'')+n}function smartProperty(obj,name){if(obj[name]!==undefined){return obj[name]}var parts=name.split(/(?=[A-Z])/),i=parts.length-1,res;for(;i>=0;i--){res=obj[parts[i].toLowerCase()];if(res!==undefined){return res}}return obj['']}function htmlEscape(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/'/g,'&#039;').replace(/"/g,'&quot;').replace(/\n/g,'<br />')}function cssKey(_element){return _element.id+'/'+_element.className+'/'+_element.style.cssText.replace(/(^|;)\s*(top|left|width|height)\s*:[^;]*/ig,'')}function disableTextSelection(element){element.attr('unselectable','on').css('MozUserSelect','none').bind('selectstart.ui',function(){return false})}function markFirstLast(e){e.children().removeClass('fc-first fc-last').filter(':first-child').addClass('fc-first').end().filter(':last-child').addClass('fc-last')}function setDayID(cell,date){cell.each(function(i,_cell){_cell.className=_cell.className.replace(/^fc-\w*/,'fc-'+dayIDs[date.getDay()])})}function getSkinCss(event,opt){var source=event.source||{};var eventColor=event.color;var sourceColor=source.color;var optionColor=opt('eventColor');var backgroundColor=event.backgroundColor||eventColor||source.backgroundColor||sourceColor||opt('eventBackgroundColor')||optionColor;var borderColor=event.borderColor||eventColor||source.borderColor||sourceColor||opt('eventBorderColor')||optionColor;var textColor=event.textColor||source.textColor||opt('eventTextColor');var statements=[];if(backgroundColor){statements.push('background-color:'+backgroundColor)}if(borderColor){statements.push('border-color:'+borderColor)}if(textColor){statements.push('color:'+textColor)}return statements.join(';')}function applyAll(functions,thisObj,args){if($.isFunction(functions)){functions=[functions]}if(functions){var i;var ret;for(i=0;i<functions.length;i++){ret=functions[i].apply(thisObj,args)||ret}return ret}}function firstDefined(){for(var i=0;i<arguments.length;i++){if(arguments[i]!==undefined){return arguments[i]}}}fcViews.month=MonthView;function MonthView(element,calendar){var t=this;t.render=render;BasicView.call(t,element,calendar,'month');var opt=t.opt;var renderBasic=t.renderBasic;var formatDate=calendar.formatDate;function render(date,delta){if(delta){addMonths(date,delta);date.setDate(1)}var start=cloneDate(date,true);start.setDate(1);var end=addMonths(cloneDate(start),1);var visStart=cloneDate(start);var visEnd=cloneDate(end);var firstDay=opt('firstDay');var nwe=opt('weekends')?0:1;if(nwe){skipWeekend(visStart);skipWeekend(visEnd,-1,true)}addDays(visStart,-((visStart.getDay()-Math.max(firstDay,nwe)+7)%7));addDays(visEnd,(7-visEnd.getDay()+Math.max(firstDay,nwe))%7);var rowCnt=Math.round((visEnd-visStart)/(DAY_MS*7));if(opt('weekMode')=='fixed'){addDays(visEnd,(6-rowCnt)*7);rowCnt=6}t.title=formatDate(start,opt('titleFormat'));t.start=start;t.end=end;t.visStart=visStart;t.visEnd=visEnd;renderBasic(6,rowCnt,nwe?5:7,true)}}fcViews.basicWeek=BasicWeekView;function BasicWeekView(element,calendar){var t=this;t.render=render;BasicView.call(t,element,calendar,'basicWeek');var opt=t.opt;var renderBasic=t.renderBasic;var formatDates=calendar.formatDates;function render(date,delta){if(delta){addDays(date,delta*7)}var start=addDays(cloneDate(date),-((date.getDay()-opt('firstDay')+7)%7));var end=addDays(cloneDate(start),7);var visStart=cloneDate(start);var visEnd=cloneDate(end);var weekends=opt('weekends');if(!weekends){skipWeekend(visStart);skipWeekend(visEnd,-1,true)}t.title=formatDates(visStart,addDays(cloneDate(visEnd),-1),opt('titleFormat'));t.start=start;t.end=end;t.visStart=visStart;t.visEnd=visEnd;renderBasic(1,1,weekends?7:5,false)}}fcViews.basicDay=BasicDayView;function BasicDayView(element,calendar){var t=this;t.render=render;BasicView.call(t,element,calendar,'basicDay');var opt=t.opt;var renderBasic=t.renderBasic;var formatDate=calendar.formatDate;function render(date,delta){if(delta){addDays(date,delta);if(!opt('weekends')){skipWeekend(date,delta<0?-1:1)}}t.title=formatDate(date,opt('titleFormat'));t.start=t.visStart=cloneDate(date,true);t.end=t.visEnd=addDays(cloneDate(t.start),1);renderBasic(1,1,1,false)}}setDefaults({weekMode:'fixed'});function BasicView(element,calendar,viewName){var t=this;t.renderBasic=renderBasic;t.setHeight=setHeight;t.setWidth=setWidth;t.renderDayOverlay=renderDayOverlay;t.defaultSelectionEnd=defaultSelectionEnd;t.renderSelection=renderSelection;t.clearSelection=clearSelection;t.reportDayClick=reportDayClick;t.dragStart=dragStart;t.dragStop=dragStop;t.defaultEventEnd=defaultEventEnd;t.getHoverListener=function(){return hoverListener};t.colContentLeft=colContentLeft;t.colContentRight=colContentRight;t.dayOfWeekCol=dayOfWeekCol;t.dateCell=dateCell;t.cellDate=cellDate;t.cellIsAllDay=function(){return true};t.allDayRow=allDayRow;t.allDayBounds=allDayBounds;t.getRowCnt=function(){return rowCnt};t.getColCnt=function(){return colCnt};t.getColWidth=function(){return colWidth};t.getDaySegmentContainer=function(){return daySegmentContainer};View.call(t,element,calendar,viewName);OverlayManager.call(t);SelectionManager.call(t);BasicEventRenderer.call(t);var opt=t.opt;var trigger=t.trigger;var clearEvents=t.clearEvents;var renderOverlay=t.renderOverlay;var clearOverlays=t.clearOverlays;var daySelectionMousedown=t.daySelectionMousedown;var formatDate=calendar.formatDate;var head;var headCells;var body;var bodyRows;var bodyCells;var bodyFirstCells;var bodyCellTopInners;var daySegmentContainer;var viewWidth;var viewHeight;var colWidth;var rowCnt,colCnt;var coordinateGrid;var hoverListener;var colContentPositions;var rtl,dis,dit;var firstDay;var nwe;var tm;var colFormat;disableTextSelection(element.addClass('fc-grid'));function renderBasic(maxr,r,c,showNumbers){rowCnt=r;colCnt=c;updateOptions();var firstTime=!body;if(firstTime){buildSkeleton(maxr,showNumbers)}else{clearEvents()}updateCells(firstTime)}function updateOptions(){rtl=opt('isRTL');if(rtl){dis=-1;dit=colCnt-1}else{dis=1;dit=0}firstDay=opt('firstDay');nwe=opt('weekends')?0:1;tm=opt('theme')?'ui':'fc';colFormat=opt('columnFormat')}function buildSkeleton(maxRowCnt,showNumbers){var s;var headerClass=tm+"-widget-header";var contentClass=tm+"-widget-content";var i,j;var table;s="<table class='fc-border-separate' style='width:100%' cellspacing='0'>"+"<thead>"+"<tr>";for(i=0;i<colCnt;i++){s+="<th class='fc- "+headerClass+"'/>"}s+="</tr>"+"</thead>"+"<tbody>";for(i=0;i<maxRowCnt;i++){s+="<tr class='fc-week"+i+"'>";for(j=0;j<colCnt;j++){s+="<td class='fc- "+contentClass+" fc-day"+(i*colCnt+j)+"'>"+"<div>"+(showNumbers?"<div class='fc-day-number'/>":'')+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>"}s+="</tr>"}s+="</tbody>"+"</table>";table=$(s).appendTo(element);head=table.find('thead');headCells=head.find('th');body=table.find('tbody');bodyRows=body.find('tr');bodyCells=body.find('td');bodyFirstCells=bodyCells.filter(':first-child');bodyCellTopInners=bodyRows.eq(0).find('div.fc-day-content div');markFirstLast(head.add(head.find('tr')));markFirstLast(bodyRows);bodyRows.eq(0).addClass('fc-first');dayBind(bodyCells);daySegmentContainer=$("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(element)}function updateCells(firstTime){var dowDirty=firstTime||rowCnt==1;var month=t.start.getMonth();var today=clearTime(new Date());var cell;var date;var row;if(dowDirty){headCells.each(function(i,_cell){cell=$(_cell);date=indexDate(i);cell.html(formatDate(date,colFormat));setDayID(cell,date)})}bodyCells.each(function(i,_cell){cell=$(_cell);date=indexDate(i);if(date.getMonth()==month){cell.removeClass('fc-other-month')}else{cell.addClass('fc-other-month')}if(+date==+today){cell.addClass(tm+'-state-highlight fc-today')}else{cell.removeClass(tm+'-state-highlight fc-today')}cell.find('div.fc-day-number').text(date.getDate());if(dowDirty){setDayID(cell,date)}});bodyRows.each(function(i,_row){row=$(_row);if(i<rowCnt){row.show();if(i==rowCnt-1){row.addClass('fc-last')}else{row.removeClass('fc-last')}}else{row.hide()}})}function setHeight(height){viewHeight=height;var bodyHeight=viewHeight-head.height();var rowHeight;var rowHeightLast;var cell;if(opt('weekMode')=='variable'){rowHeight=rowHeightLast=Math.floor(bodyHeight/(rowCnt==1?2:6))}else{rowHeight=Math.floor(bodyHeight/rowCnt);rowHeightLast=bodyHeight-rowHeight*(rowCnt-1)}bodyFirstCells.each(function(i,_cell){if(i<rowCnt){cell=$(_cell);setMinHeight(cell.find('> div'),(i==rowCnt-1?rowHeightLast:rowHeight)-vsides(cell))}})}function setWidth(width){viewWidth=width;colContentPositions.clear();colWidth=Math.floor(viewWidth/colCnt);setOuterWidth(headCells.slice(0,-1),colWidth)}function dayBind(days){days.click(dayClick).mousedown(daySelectionMousedown)}function dayClick(ev){if(!opt('selectable')){var index=parseInt(this.className.match(/fc\-day(\d+)/)[1]);var date=indexDate(index);trigger('dayClick',this,date,true,ev)}}function renderDayOverlay(overlayStart,overlayEnd,refreshCoordinateGrid){if(refreshCoordinateGrid){coordinateGrid.build()}var rowStart=cloneDate(t.visStart);var rowEnd=addDays(cloneDate(rowStart),colCnt);for(var i=0;i<rowCnt;i++){var stretchStart=new Date(Math.max(rowStart,overlayStart));var stretchEnd=new Date(Math.min(rowEnd,overlayEnd));if(stretchStart<stretchEnd){var colStart,colEnd;if(rtl){colStart=dayDiff(stretchEnd,rowStart)*dis+dit+1;colEnd=dayDiff(stretchStart,rowStart)*dis+dit+1}else{colStart=dayDiff(stretchStart,rowStart);colEnd=dayDiff(stretchEnd,rowStart)}dayBind(renderCellOverlay(i,colStart,i,colEnd-1))}addDays(rowStart,7);addDays(rowEnd,7)}}function renderCellOverlay(row0,col0,row1,col1){var rect=coordinateGrid.rect(row0,col0,row1,col1,element);return renderOverlay(rect,element)}function defaultSelectionEnd(startDate,allDay){return cloneDate(startDate)}function renderSelection(startDate,endDate,allDay){renderDayOverlay(startDate,addDays(cloneDate(endDate),1),true)}function clearSelection(){clearOverlays()}function reportDayClick(date,allDay,ev){var cell=dateCell(date);var _element=bodyCells[cell.row*colCnt+cell.col];trigger('dayClick',_element,date,allDay,ev)}function dragStart(_dragElement,ev,ui){hoverListener.start(function(cell){clearOverlays();if(cell){renderCellOverlay(cell.row,cell.col,cell.row,cell.col)}},ev)}function dragStop(_dragElement,ev,ui){var cell=hoverListener.stop();clearOverlays();if(cell){var d=cellDate(cell);trigger('drop',_dragElement,d,true,ev,ui)}}function defaultEventEnd(event){return cloneDate(event.start)}coordinateGrid=new CoordinateGrid(function(rows,cols){var e,n,p;headCells.each(function(i,_e){e=$(_e);n=e.offset().left;if(i){p[1]=n}p=[n];cols[i]=p});p[1]=n+e.outerWidth();bodyRows.each(function(i,_e){if(i<rowCnt){e=$(_e);n=e.offset().top;if(i){p[1]=n}p=[n];rows[i]=p}});p[1]=n+e.outerHeight()});hoverListener=new HoverListener(coordinateGrid);colContentPositions=new HorizontalPositionCache(function(col){return bodyCellTopInners.eq(col)});function colContentLeft(col){return colContentPositions.left(col)}function colContentRight(col){return colContentPositions.right(col)}function dateCell(date){return{row:Math.floor(dayDiff(date,t.visStart)/7),col:dayOfWeekCol(date.getDay())}}function cellDate(cell){return _cellDate(cell.row,cell.col)}function _cellDate(row,col){return addDays(cloneDate(t.visStart),row*7+col*dis+dit)}function indexDate(index){return _cellDate(Math.floor(index/colCnt),index%colCnt)}function dayOfWeekCol(dayOfWeek){return((dayOfWeek-Math.max(firstDay,nwe)+colCnt)%colCnt)*dis+dit}function allDayRow(i){return bodyRows.eq(i)}function allDayBounds(i){return{left:0,right:viewWidth}}}function BasicEventRenderer(){var t=this;t.renderEvents=renderEvents;t.compileDaySegs=compileSegs;t.clearEvents=clearEvents;t.bindDaySeg=bindDaySeg;DayEventRenderer.call(t);var opt=t.opt;var trigger=t.trigger;var isEventDraggable=t.isEventDraggable;var isEventResizable=t.isEventResizable;var reportEvents=t.reportEvents;var reportEventClear=t.reportEventClear;var eventElementHandlers=t.eventElementHandlers;var showEvents=t.showEvents;var hideEvents=t.hideEvents;var eventDrop=t.eventDrop;var getDaySegmentContainer=t.getDaySegmentContainer;var getHoverListener=t.getHoverListener;var renderDayOverlay=t.renderDayOverlay;var clearOverlays=t.clearOverlays;var getRowCnt=t.getRowCnt;var getColCnt=t.getColCnt;var renderDaySegs=t.renderDaySegs;var resizableDayEvent=t.resizableDayEvent;function renderEvents(events,modifiedEventId){reportEvents(events);renderDaySegs(compileSegs(events),modifiedEventId)}function clearEvents(){reportEventClear();getDaySegmentContainer().empty()}function compileSegs(events){var rowCnt=getRowCnt(),colCnt=getColCnt(),d1=cloneDate(t.visStart),d2=addDays(cloneDate(d1),colCnt),visEventsEnds=$.map(events,exclEndDay),i,row,j,level,k,seg,segs=[];for(i=0;i<rowCnt;i++){row=stackSegs(sliceSegs(events,visEventsEnds,d1,d2));for(j=0;j<row.length;j++){level=row[j];for(k=0;k<level.length;k++){seg=level[k];seg.row=i;seg.level=j;segs.push(seg)}}addDays(d1,7);addDays(d2,7)}return segs}function bindDaySeg(event,eventElement,seg){if(isEventDraggable(event)){draggableDayEvent(event,eventElement)}if(seg.isEnd&&isEventResizable(event)){resizableDayEvent(event,eventElement,seg)}eventElementHandlers(event,eventElement)}function draggableDayEvent(event,eventElement){var hoverListener=getHoverListener();var dayDelta;eventElement.draggable({zIndex:9,delay:50,opacity:opt('dragOpacity'),revertDuration:opt('dragRevertDuration'),start:function(ev,ui){trigger('eventDragStart',eventElement,event,ev,ui);hideEvents(event,eventElement);hoverListener.start(function(cell,origCell,rowDelta,colDelta){eventElement.draggable('option','revert',!cell||!rowDelta&&!colDelta);clearOverlays();if(cell){dayDelta=rowDelta*7+colDelta*(opt('isRTL')?-1:1);renderDayOverlay(addDays(cloneDate(event.start),dayDelta),addDays(exclEndDay(event),dayDelta))}else{dayDelta=0}},ev,'drag')},stop:function(ev,ui){hoverListener.stop();clearOverlays();trigger('eventDragStop',eventElement,event,ev,ui);if(dayDelta){eventDrop(this,event,dayDelta,0,event.allDay,ev,ui)}else{eventElement.css('filter','');showEvents(event,eventElement)}}})}}fcViews.agendaWeek=AgendaWeekView;function AgendaWeekView(element,calendar){var t=this;t.render=render;AgendaView.call(t,element,calendar,'agendaWeek');var opt=t.opt;var renderAgenda=t.renderAgenda;var formatDates=calendar.formatDates;function render(date,delta){if(delta){addDays(date,delta*7)}var start=addDays(cloneDate(date),-((date.getDay()-opt('firstDay')+7)%7));var end=addDays(cloneDate(start),7);var visStart=cloneDate(start);var visEnd=cloneDate(end);var weekends=opt('weekends');if(!weekends){skipWeekend(visStart);skipWeekend(visEnd,-1,true)}t.title=formatDates(visStart,addDays(cloneDate(visEnd),-1),opt('titleFormat'));t.start=start;t.end=end;t.visStart=visStart;t.visEnd=visEnd;renderAgenda(weekends?7:5)}}fcViews.agendaDay=AgendaDayView;function AgendaDayView(element,calendar){var t=this;t.render=render;AgendaView.call(t,element,calendar,'agendaDay');var opt=t.opt;var renderAgenda=t.renderAgenda;var formatDate=calendar.formatDate;function render(date,delta){if(delta){addDays(date,delta);if(!opt('weekends')){skipWeekend(date,delta<0?-1:1)}}var start=cloneDate(date,true);var end=addDays(cloneDate(start),1);t.title=formatDate(date,opt('titleFormat'));t.start=t.visStart=start;t.end=t.visEnd=end;renderAgenda(1)}}setDefaults({allDaySlot:true,allDayText:'all-day',firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:'h(:mm)tt',timeFormat:{agenda:'h:mm{ - h:mm}'},dragOpacity:{agenda:.5},minTime:0,maxTime:24});function AgendaView(element,calendar,viewName){var t=this;t.renderAgenda=renderAgenda;t.setWidth=setWidth;t.setHeight=setHeight;t.beforeHide=beforeHide;t.afterShow=afterShow;t.defaultEventEnd=defaultEventEnd;t.timePosition=timePosition;t.dayOfWeekCol=dayOfWeekCol;t.dateCell=dateCell;t.cellDate=cellDate;t.cellIsAllDay=cellIsAllDay;t.allDayRow=getAllDayRow;t.allDayBounds=allDayBounds;t.getHoverListener=function(){return hoverListener};t.colContentLeft=colContentLeft;t.colContentRight=colContentRight;t.getDaySegmentContainer=function(){return daySegmentContainer};t.getSlotSegmentContainer=function(){return slotSegmentContainer};t.getMinMinute=function(){return minMinute};t.getMaxMinute=function(){return maxMinute};t.getBodyContent=function(){return slotContent};t.getRowCnt=function(){return 1};t.getColCnt=function(){return colCnt};t.getColWidth=function(){return colWidth};t.getSlotHeight=function(){return slotHeight};t.defaultSelectionEnd=defaultSelectionEnd;t.renderDayOverlay=renderDayOverlay;t.renderSelection=renderSelection;t.clearSelection=clearSelection;t.reportDayClick=reportDayClick;t.dragStart=dragStart;t.dragStop=dragStop;View.call(t,element,calendar,viewName);OverlayManager.call(t);SelectionManager.call(t);AgendaEventRenderer.call(t);var opt=t.opt;var trigger=t.trigger;var clearEvents=t.clearEvents;var renderOverlay=t.renderOverlay;var clearOverlays=t.clearOverlays;var reportSelection=t.reportSelection;var unselect=t.unselect;var daySelectionMousedown=t.daySelectionMousedown;var slotSegHtml=t.slotSegHtml;var formatDate=calendar.formatDate;var dayTable;var dayHead;var dayHeadCells;var dayBody;var dayBodyCells;var dayBodyCellInners;var dayBodyFirstCell;var dayBodyFirstCellStretcher;var slotLayer;var daySegmentContainer;var allDayTable;var allDayRow;var slotScroller;var slotContent;var slotSegmentContainer;var slotTable;var slotTableFirstInner;var axisFirstCells;var gutterCells;var selectionHelper;var viewWidth;var viewHeight;var axisWidth;var colWidth;var gutterWidth;var slotHeight;var savedScrollTop;var colCnt;var slotCnt;var coordinateGrid;var hoverListener;var colContentPositions;var slotTopCache={};var tm;var firstDay;var nwe;var rtl,dis,dit;var minMinute,maxMinute;var colFormat;disableTextSelection(element.addClass('fc-agenda'));function renderAgenda(c){colCnt=c;updateOptions();if(!dayTable){buildSkeleton()}else{clearEvents()}updateCells()}function updateOptions(){tm=opt('theme')?'ui':'fc';nwe=opt('weekends')?0:1;firstDay=opt('firstDay');if(rtl=opt('isRTL')){dis=-1;dit=colCnt-1}else{dis=1;dit=0}minMinute=parseTime(opt('minTime'));maxMinute=parseTime(opt('maxTime'));colFormat=opt('columnFormat')}function buildSkeleton(){var headerClass=tm+"-widget-header";var contentClass=tm+"-widget-content";var s;var i;var d;var maxd;var minutes;var slotNormal=opt('slotMinutes')%15==0;s="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'>"+"<thead>"+"<tr>"+"<th class='fc-agenda-axis "+headerClass+"'>&nbsp;</th>";for(i=0;i<colCnt;i++){s+="<th class='fc- fc-col"+i+' '+headerClass+"'/>"}s+="<th class='fc-agenda-gutter "+headerClass+"'>&nbsp;</th>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+"<th class='fc-agenda-axis "+headerClass+"'>&nbsp;</th>";for(i=0;i<colCnt;i++){s+="<td class='fc- fc-col"+i+' '+contentClass+"'>"+"<div>"+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>"}s+="<td class='fc-agenda-gutter "+contentClass+"'>&nbsp;</td>"+"</tr>"+"</tbody>"+"</table>";dayTable=$(s).appendTo(element);dayHead=dayTable.find('thead');dayHeadCells=dayHead.find('th').slice(1,-1);dayBody=dayTable.find('tbody');dayBodyCells=dayBody.find('td').slice(0,-1);dayBodyCellInners=dayBodyCells.find('div.fc-day-content div');dayBodyFirstCell=dayBodyCells.eq(0);dayBodyFirstCellStretcher=dayBodyFirstCell.find('> div');markFirstLast(dayHead.add(dayHead.find('tr')));markFirstLast(dayBody.add(dayBody.find('tr')));axisFirstCells=dayHead.find('th:first');gutterCells=dayTable.find('.fc-agenda-gutter');slotLayer=$("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(element);if(opt('allDaySlot')){daySegmentContainer=$("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(slotLayer);s="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'>"+"<tr>"+"<th class='"+headerClass+" fc-agenda-axis'>"+opt('allDayText')+"</th>"+"<td>"+"<div class='fc-day-content'><div style='position:relative'/></div>"+"</td>"+"<th class='"+headerClass+" fc-agenda-gutter'>&nbsp;</th>"+"</tr>"+"</table>";allDayTable=$(s).appendTo(slotLayer);allDayRow=allDayTable.find('tr');dayBind(allDayRow.find('td'));axisFirstCells=axisFirstCells.add(allDayTable.find('th:first'));gutterCells=gutterCells.add(allDayTable.find('th.fc-agenda-gutter'));slotLayer.append("<div class='fc-agenda-divider "+headerClass+"'>"+"<div class='fc-agenda-divider-inner'/>"+"</div>")}else{daySegmentContainer=$([])}slotScroller=$("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(slotLayer);slotContent=$("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(slotScroller);slotSegmentContainer=$("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(slotContent);s="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'>"+"<tbody>";d=zeroDate();maxd=addMinutes(cloneDate(d),maxMinute);addMinutes(d,minMinute);slotCnt=0;for(i=0;d<maxd;i++){minutes=d.getMinutes();s+="<tr class='fc-slot"+i+' '+(!minutes?'':'fc-minor')+"'>"+"<th class='fc-agenda-axis "+headerClass+"'>"+((!slotNormal||!minutes)?formatDate(d,opt('axisFormat')):'&nbsp;')+"</th>"+"<td class='"+contentClass+"'>"+"<div style='position:relative'>&nbsp;</div>"+"</td>"+"</tr>";addMinutes(d,opt('slotMinutes'));slotCnt++}s+="</tbody>"+"</table>";slotTable=$(s).appendTo(slotContent);slotTableFirstInner=slotTable.find('div:first');slotBind(slotTable.find('td'));axisFirstCells=axisFirstCells.add(slotTable.find('th:first'))}function updateCells(){var i;var headCell;var bodyCell;var date;var today=clearTime(new Date());for(i=0;i<colCnt;i++){date=colDate(i);headCell=dayHeadCells.eq(i);headCell.html(formatDate(date,colFormat));bodyCell=dayBodyCells.eq(i);if(+date==+today){bodyCell.addClass(tm+'-state-highlight fc-today')}else{bodyCell.removeClass(tm+'-state-highlight fc-today')}setDayID(headCell.add(bodyCell),date)}}function setHeight(height,dateChanged){if(height===undefined){height=viewHeight}viewHeight=height;slotTopCache={};var headHeight=dayBody.position().top;var allDayHeight=slotScroller.position().top;var bodyHeight=Math.min(height-headHeight,slotTable.height()+allDayHeight+1);dayBodyFirstCellStretcher.height(bodyHeight-vsides(dayBodyFirstCell));slotLayer.css('top',headHeight);slotScroller.height(bodyHeight-allDayHeight-1);slotHeight=slotTableFirstInner.height()+1;if(dateChanged){resetScroll()}}function setWidth(width){viewWidth=width;colContentPositions.clear();axisWidth=0;setOuterWidth(axisFirstCells.width('').each(function(i,_cell){axisWidth=Math.max(axisWidth,$(_cell).outerWidth())}),axisWidth);var slotTableWidth=slotScroller[0].clientWidth;gutterWidth=slotScroller.width()-slotTableWidth;if(gutterWidth){setOuterWidth(gutterCells,gutterWidth);gutterCells.show().prev().removeClass('fc-last')}else{gutterCells.hide().prev().addClass('fc-last')}colWidth=Math.floor((slotTableWidth-axisWidth)/colCnt);setOuterWidth(dayHeadCells.slice(0,-1),colWidth)}function resetScroll(){var d0=zeroDate();var scrollDate=cloneDate(d0);scrollDate.setHours(opt('firstHour'));var top=timePosition(d0,scrollDate)+1;function scroll(){slotScroller.scrollTop(top)}scroll();setTimeout(scroll,0)}function beforeHide(){savedScrollTop=slotScroller.scrollTop()}function afterShow(){slotScroller.scrollTop(savedScrollTop)}function dayBind(cells){cells.click(slotClick).mousedown(daySelectionMousedown)}function slotBind(cells){cells.click(slotClick).mousedown(slotSelectionMousedown)}function slotClick(ev){if(!opt('selectable')){var col=Math.min(colCnt-1,Math.floor((ev.pageX-dayTable.offset().left-axisWidth)/colWidth));var date=colDate(col);var rowMatch=this.parentNode.className.match(/fc-slot(\d+)/);if(rowMatch){var mins=parseInt(rowMatch[1])*opt('slotMinutes');var hours=Math.floor(mins/60);date.setHours(hours);date.setMinutes(mins%60+minMinute);trigger('dayClick',dayBodyCells[col],date,false,ev)}else{trigger('dayClick',dayBodyCells[col],date,true,ev)}}}function renderDayOverlay(startDate,endDate,refreshCoordinateGrid){if(refreshCoordinateGrid){coordinateGrid.build()}var visStart=cloneDate(t.visStart);var startCol,endCol;if(rtl){startCol=dayDiff(endDate,visStart)*dis+dit+1;endCol=dayDiff(startDate,visStart)*dis+dit+1}else{startCol=dayDiff(startDate,visStart);endCol=dayDiff(endDate,visStart)}startCol=Math.max(0,startCol);endCol=Math.min(colCnt,endCol);if(startCol<endCol){dayBind(renderCellOverlay(0,startCol,0,endCol-1))}}function renderCellOverlay(row0,col0,row1,col1){var rect=coordinateGrid.rect(row0,col0,row1,col1,slotLayer);return renderOverlay(rect,slotLayer)}function renderSlotOverlay(overlayStart,overlayEnd){var dayStart=cloneDate(t.visStart);var dayEnd=addDays(cloneDate(dayStart),1);for(var i=0;i<colCnt;i++){var stretchStart=new Date(Math.max(dayStart,overlayStart));var stretchEnd=new Date(Math.min(dayEnd,overlayEnd));if(stretchStart<stretchEnd){var col=i*dis+dit;var rect=coordinateGrid.rect(0,col,0,col,slotContent);var top=timePosition(dayStart,stretchStart);var bottom=timePosition(dayStart,stretchEnd);rect.top=top;rect.height=bottom-top;slotBind(renderOverlay(rect,slotContent))}addDays(dayStart,1);addDays(dayEnd,1)}}coordinateGrid=new CoordinateGrid(function(rows,cols){var e,n,p;dayHeadCells.each(function(i,_e){e=$(_e);n=e.offset().left;if(i){p[1]=n}p=[n];cols[i]=p});p[1]=n+e.outerWidth();if(opt('allDaySlot')){e=allDayRow;n=e.offset().top;rows[0]=[n,n+e.outerHeight()]}var slotTableTop=slotContent.offset().top;var slotScrollerTop=slotScroller.offset().top;var slotScrollerBottom=slotScrollerTop+slotScroller.outerHeight();function constrain(n){return Math.max(slotScrollerTop,Math.min(slotScrollerBottom,n))}for(var i=0;i<slotCnt;i++){rows.push([constrain(slotTableTop+slotHeight*i),constrain(slotTableTop+slotHeight*(i+1))])}});hoverListener=new HoverListener(coordinateGrid);colContentPositions=new HorizontalPositionCache(function(col){return dayBodyCellInners.eq(col)});function colContentLeft(col){return colContentPositions.left(col)}function colContentRight(col){return colContentPositions.right(col)}function dateCell(date){return{row:Math.floor(dayDiff(date,t.visStart)/7),col:dayOfWeekCol(date.getDay())}}function cellDate(cell){var d=colDate(cell.col);var slotIndex=cell.row;if(opt('allDaySlot')){slotIndex--}if(slotIndex>=0){addMinutes(d,minMinute+slotIndex*opt('slotMinutes'))}return d}function colDate(col){return addDays(cloneDate(t.visStart),col*dis+dit)}function cellIsAllDay(cell){return opt('allDaySlot')&&!cell.row}function dayOfWeekCol(dayOfWeek){return((dayOfWeek-Math.max(firstDay,nwe)+colCnt)%colCnt)*dis+dit}function timePosition(day,time){day=cloneDate(day,true);if(time<addMinutes(cloneDate(day),minMinute)){return 0}if(time>=addMinutes(cloneDate(day),maxMinute)){return slotTable.height()}var slotMinutes=opt('slotMinutes'),minutes=time.getHours()*60+time.getMinutes()-minMinute,slotI=Math.floor(minutes/slotMinutes),slotTop=slotTopCache[slotI];if(slotTop===undefined){slotTop=slotTopCache[slotI]=slotTable.find('tr:eq('+slotI+') td div')[0].offsetTop}return Math.max(0,Math.round(slotTop-1+slotHeight*((minutes%slotMinutes)/slotMinutes)))}function allDayBounds(){return{left:axisWidth,right:viewWidth-gutterWidth}}function getAllDayRow(index){return allDayRow}function defaultEventEnd(event){var start=cloneDate(event.start);if(event.allDay){return start}return addMinutes(start,opt('defaultEventMinutes'))}function defaultSelectionEnd(startDate,allDay){if(allDay){return cloneDate(startDate)}return addMinutes(cloneDate(startDate),opt('slotMinutes'))}function renderSelection(startDate,endDate,allDay){if(allDay){if(opt('allDaySlot')){renderDayOverlay(startDate,addDays(cloneDate(endDate),1),true)}}else{renderSlotSelection(startDate,endDate)}}function renderSlotSelection(startDate,endDate){var helperOption=opt('selectHelper');coordinateGrid.build();if(helperOption){var col=dayDiff(startDate,t.visStart)*dis+dit;if(col>=0&&col<colCnt){var rect=coordinateGrid.rect(0,col,0,col,slotContent);var top=timePosition(startDate,startDate);var bottom=timePosition(startDate,endDate);if(bottom>top){rect.top=top;rect.height=bottom-top;rect.left+=2;rect.width-=5;if($.isFunction(helperOption)){var helperRes=helperOption(startDate,endDate);if(helperRes){rect.position='absolute';rect.zIndex=8;selectionHelper=$(helperRes).css(rect).appendTo(slotContent)}}else{rect.isStart=true;rect.isEnd=true;selectionHelper=$(slotSegHtml({title:'',start:startDate,end:endDate,className:['fc-select-helper'],editable:false},rect));selectionHelper.css('opacity',opt('dragOpacity'))}if(selectionHelper){slotBind(selectionHelper);slotContent.append(selectionHelper);setOuterWidth(selectionHelper,rect.width,true);setOuterHeight(selectionHelper,rect.height,true)}}}}else{renderSlotOverlay(startDate,endDate)}}function clearSelection(){clearOverlays();if(selectionHelper){selectionHelper.remove();selectionHelper=null}}function slotSelectionMousedown(ev){if(ev.which==1&&opt('selectable')){unselect(ev);var dates;hoverListener.start(function(cell,origCell){clearSelection();if(cell&&cell.col==origCell.col&&!cellIsAllDay(cell)){var d1=cellDate(origCell);var d2=cellDate(cell);dates=[d1,addMinutes(cloneDate(d1),opt('slotMinutes')),d2,addMinutes(cloneDate(d2),opt('slotMinutes'))].sort(cmp);renderSlotSelection(dates[0],dates[3])}else{dates=null}},ev);$(document).one('mouseup',function(ev){hoverListener.stop();if(dates){if(+dates[0]==+dates[1]){reportDayClick(dates[0],false,ev)}reportSelection(dates[0],dates[3],false,ev)}})}}function reportDayClick(date,allDay,ev){trigger('dayClick',dayBodyCells[dayOfWeekCol(date.getDay())],date,allDay,ev)}function dragStart(_dragElement,ev,ui){hoverListener.start(function(cell){clearOverlays();if(cell){if(cellIsAllDay(cell)){renderCellOverlay(cell.row,cell.col,cell.row,cell.col)}else{var d1=cellDate(cell);var d2=addMinutes(cloneDate(d1),opt('defaultEventMinutes'));renderSlotOverlay(d1,d2)}}},ev)}function dragStop(_dragElement,ev,ui){var cell=hoverListener.stop();clearOverlays();if(cell){trigger('drop',_dragElement,cellDate(cell),cellIsAllDay(cell),ev,ui)}}}function AgendaEventRenderer(){var t=this;t.renderEvents=renderEvents;t.compileDaySegs=compileDaySegs;t.clearEvents=clearEvents;t.slotSegHtml=slotSegHtml;t.bindDaySeg=bindDaySeg;DayEventRenderer.call(t);var opt=t.opt;var trigger=t.trigger;var isEventDraggable=t.isEventDraggable;var isEventResizable=t.isEventResizable;var eventEnd=t.eventEnd;var reportEvents=t.reportEvents;var reportEventClear=t.reportEventClear;var eventElementHandlers=t.eventElementHandlers;var setHeight=t.setHeight;var getDaySegmentContainer=t.getDaySegmentContainer;var getSlotSegmentContainer=t.getSlotSegmentContainer;var getHoverListener=t.getHoverListener;var getMaxMinute=t.getMaxMinute;var getMinMinute=t.getMinMinute;var timePosition=t.timePosition;var colContentLeft=t.colContentLeft;var colContentRight=t.colContentRight;var renderDaySegs=t.renderDaySegs;var resizableDayEvent=t.resizableDayEvent;var getColCnt=t.getColCnt;var getColWidth=t.getColWidth;var getSlotHeight=t.getSlotHeight;var getBodyContent=t.getBodyContent;var reportEventElement=t.reportEventElement;var showEvents=t.showEvents;var hideEvents=t.hideEvents;var eventDrop=t.eventDrop;var eventResize=t.eventResize;var renderDayOverlay=t.renderDayOverlay;var clearOverlays=t.clearOverlays;var calendar=t.calendar;var formatDate=calendar.formatDate;var formatDates=calendar.formatDates;function renderEvents(events,modifiedEventId){reportEvents(events);var i,len=events.length,dayEvents=[],slotEvents=[];for(i=0;i<len;i++){if(events[i].allDay){dayEvents.push(events[i])}else{slotEvents.push(events[i])}}if(opt('allDaySlot')){renderDaySegs(compileDaySegs(dayEvents),modifiedEventId);setHeight()}renderSlotSegs(compileSlotSegs(slotEvents),modifiedEventId)}function clearEvents(){reportEventClear();getDaySegmentContainer().empty();getSlotSegmentContainer().empty()}function compileDaySegs(events){var levels=stackSegs(sliceSegs(events,$.map(events,exclEndDay),t.visStart,t.visEnd)),i,levelCnt=levels.length,level,j,seg,segs=[];for(i=0;i<levelCnt;i++){level=levels[i];for(j=0;j<level.length;j++){seg=level[j];seg.row=0;seg.level=i;segs.push(seg)}}return segs}function compileSlotSegs(events){var colCnt=getColCnt(),minMinute=getMinMinute(),maxMinute=getMaxMinute(),d=addMinutes(cloneDate(t.visStart),minMinute),visEventEnds=$.map(events,slotEventEnd),i,col,j,level,k,seg,segs=[];for(i=0;i<colCnt;i++){col=stackSegs(sliceSegs(events,visEventEnds,d,addMinutes(cloneDate(d),maxMinute-minMinute)));countForwardSegs(col);for(j=0;j<col.length;j++){level=col[j];for(k=0;k<level.length;k++){seg=level[k];seg.col=i;seg.level=j;segs.push(seg)}}addDays(d,1,true)}return segs}function slotEventEnd(event){if(event.end){return cloneDate(event.end)}else{return addMinutes(cloneDate(event.start),opt('defaultEventMinutes'))}}function renderSlotSegs(segs,modifiedEventId){var i,segCnt=segs.length,seg,event,classes,top,bottom,colI,levelI,forward,leftmost,availWidth,outerWidth,left,html='',eventElements,eventElement,triggerRes,vsideCache={},hsideCache={},key,val,contentElement,height,slotSegmentContainer=getSlotSegmentContainer(),rtl,dis,dit,colCnt=getColCnt();if(rtl=opt('isRTL')){dis=-1;dit=colCnt-1}else{dis=1;dit=0}for(i=0;i<segCnt;i++){seg=segs[i];event=seg.event;top=timePosition(seg.start,seg.start);bottom=timePosition(seg.start,seg.end);colI=seg.col;levelI=seg.level;forward=seg.forward||0;leftmost=colContentLeft(colI*dis+dit);availWidth=colContentRight(colI*dis+dit)-leftmost;availWidth=Math.min(availWidth-6,availWidth*.95);if(levelI){outerWidth=availWidth/(levelI+forward+1)}else{if(forward){outerWidth=((availWidth/(forward+1))-(12/2))*2}else{outerWidth=availWidth}}left=leftmost+(availWidth/(levelI+forward+1)*levelI) *dis+(rtl?availWidth-outerWidth:0);seg.top=top;seg.left=left;seg.outerWidth=outerWidth;seg.outerHeight=bottom-top;html+=slotSegHtml(event,seg)}slotSegmentContainer[0].innerHTML=html;eventElements=slotSegmentContainer.children();for(i=0;i<segCnt;i++){seg=segs[i];event=seg.event;eventElement=$(eventElements[i]);triggerRes=trigger('eventRender',event,event,eventElement);if(triggerRes===false){eventElement.remove()}else{if(triggerRes&&triggerRes!==true){eventElement.remove();eventElement=$(triggerRes).css({position:'absolute',top:seg.top,left:seg.left}).appendTo(slotSegmentContainer)}seg.element=eventElement;if(event._id===modifiedEventId){bindSlotSeg(event,eventElement,seg)}else{eventElement[0]._fci=i}reportEventElement(event,eventElement)}}lazySegBind(slotSegmentContainer,segs,bindSlotSeg);for(i=0;i<segCnt;i++){seg=segs[i];if(eventElement=seg.element){val=vsideCache[key=seg.key=cssKey(eventElement[0])];seg.vsides=val===undefined?(vsideCache[key]=vsides(eventElement,true)):val;val=hsideCache[key];seg.hsides=val===undefined?(hsideCache[key]=hsides(eventElement,true)):val;contentElement=eventElement.find('div.fc-event-content');if(contentElement.length){seg.contentTop=contentElement[0].offsetTop}}}for(i=0;i<segCnt;i++){seg=segs[i];if(eventElement=seg.element){eventElement[0].style.width=Math.max(0,seg.outerWidth-seg.hsides)+'px';height=Math.max(0,seg.outerHeight-seg.vsides);eventElement[0].style.height=height+'px';event=seg.event;if(seg.contentTop!==undefined&&height-seg.contentTop<10){eventElement.find('div.fc-event-time').text(formatDate(event.start,opt('timeFormat'))+' - '+event.title);eventElement.find('div.fc-event-title').remove()}trigger('eventAfterRender',event,event,eventElement)}}}function slotSegHtml(event,seg){var html="<";var url=event.url;var skinCss=getSkinCss(event,opt);var skinCssAttr=(skinCss?" style='"+skinCss+"'":'');var classes=['fc-event','fc-event-skin','fc-event-vert'];if(isEventDraggable(event)){classes.push('fc-event-draggable')}if(seg.isStart){classes.push('fc-corner-top')}if(seg.isEnd){classes.push('fc-corner-bottom')}classes=classes.concat(event.className);if(event.source){classes=classes.concat(event.source.className||[])}if(url){html+="a href='"+htmlEscape(event.url)+"'"}else{html+="div"}html+=" class='"+classes.join(' ')+"'"+" style='position:absolute;z-index:8;top:"+seg.top+"px;left:"+seg.left+"px;"+skinCss+"'"+">"+"<div class='fc-event-inner fc-event-skin'"+skinCssAttr+">"+"<div class='fc-event-head fc-event-skin'"+skinCssAttr+">"+"<div class='fc-event-time'>"+htmlEscape(formatDates(event.start,event.end,opt('timeFormat')))+"</div>"+"</div>"+"<div class='fc-event-content'>"+"<div class='fc-event-title'>"+htmlEscape(event.title)+"</div>"+"</div>"+"<div class='fc-event-bg'></div>"+"</div>";if(seg.isEnd&&isEventResizable(event)){html+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"}html+="</"+(url?"a":"div")+">";return html}function bindDaySeg(event,eventElement,seg){if(isEventDraggable(event)){draggableDayEvent(event,eventElement,seg.isStart)}if(seg.isEnd&&isEventResizable(event)){resizableDayEvent(event,eventElement,seg)}eventElementHandlers(event,eventElement)}function bindSlotSeg(event,eventElement,seg){var timeElement=eventElement.find('div.fc-event-time');if(isEventDraggable(event)){draggableSlotEvent(event,eventElement,timeElement)}if(seg.isEnd&&isEventResizable(event)){resizableSlotEvent(event,eventElement,timeElement)}eventElementHandlers(event,eventElement)}function draggableDayEvent(event,eventElement,isStart){var origWidth;var revert;var allDay=true;var dayDelta;var dis=opt('isRTL')?-1:1;var hoverListener=getHoverListener();var colWidth=getColWidth();var slotHeight=getSlotHeight();var minMinute=getMinMinute();eventElement.draggable({zIndex:9,opacity:opt('dragOpacity','month'),revertDuration:opt('dragRevertDuration'),start:function(ev,ui){trigger('eventDragStart',eventElement,event,ev,ui);hideEvents(event,eventElement);origWidth=eventElement.width();hoverListener.start(function(cell,origCell,rowDelta,colDelta){clearOverlays();if(cell){revert=false;dayDelta=colDelta*dis;if(!cell.row){renderDayOverlay(addDays(cloneDate(event.start),dayDelta),addDays(exclEndDay(event),dayDelta));resetElement()}else{if(isStart){if(allDay){eventElement.width(colWidth-10);setOuterHeight(eventElement,slotHeight*Math.round((event.end?((event.end-event.start)/MINUTE_MS):opt('defaultEventMinutes'))/opt('slotMinutes')));eventElement.draggable('option','grid',[colWidth,1]);allDay=false}}else{revert=true}}revert=revert||(allDay&&!dayDelta)}else{resetElement();revert=true}eventElement.draggable('option','revert',revert)},ev,'drag')},stop:function(ev,ui){hoverListener.stop();clearOverlays();trigger('eventDragStop',eventElement,event,ev,ui);if(revert){resetElement();eventElement.css('filter','');showEvents(event,eventElement)}else{var minuteDelta=0;if(!allDay){minuteDelta=Math.round((eventElement.offset().top-getBodyContent().offset().top)/slotHeight)*opt('slotMinutes')+minMinute-(event.start.getHours()*60+event.start.getMinutes())}eventDrop(this,event,dayDelta,minuteDelta,allDay,ev,ui)}}});function resetElement(){if(!allDay){eventElement.width(origWidth).height('').draggable('option','grid',null);allDay=true}}}function draggableSlotEvent(event,eventElement,timeElement){var origPosition;var allDay=false;var dayDelta;var minuteDelta;var prevMinuteDelta;var dis=opt('isRTL')?-1:1;var hoverListener=getHoverListener();var colCnt=getColCnt();var colWidth=getColWidth();var slotHeight=getSlotHeight();eventElement.draggable({zIndex:9,scroll:false,grid:[colWidth,slotHeight],axis:colCnt==1?'y':false,opacity:opt('dragOpacity'),revertDuration:opt('dragRevertDuration'),start:function(ev,ui){trigger('eventDragStart',eventElement,event,ev,ui);hideEvents(event,eventElement);origPosition=eventElement.position();minuteDelta=prevMinuteDelta=0;hoverListener.start(function(cell,origCell,rowDelta,colDelta){eventElement.draggable('option','revert',!cell);clearOverlays();if(cell){dayDelta=colDelta*dis;if(opt('allDaySlot')&&!cell.row){if(!allDay){allDay=true;timeElement.hide();eventElement.draggable('option','grid',null)}renderDayOverlay(addDays(cloneDate(event.start),dayDelta),addDays(exclEndDay(event),dayDelta))}else{resetElement()}}},ev,'drag')},drag:function(ev,ui){minuteDelta=Math.round((ui.position.top-origPosition.top)/slotHeight)*opt('slotMinutes');if(minuteDelta!=prevMinuteDelta){if(!allDay){updateTimeText(minuteDelta)}prevMinuteDelta=minuteDelta}},stop:function(ev,ui){var cell=hoverListener.stop();clearOverlays();trigger('eventDragStop',eventElement,event,ev,ui);if(cell&&(dayDelta||minuteDelta||allDay)){eventDrop(this,event,dayDelta,allDay?0:minuteDelta,allDay,ev,ui)}else{resetElement();eventElement.css('filter','');eventElement.css(origPosition);updateTimeText(0);showEvents(event,eventElement)}}});function updateTimeText(minuteDelta){var newStart=addMinutes(cloneDate(event.start),minuteDelta);var newEnd;if(event.end){newEnd=addMinutes(cloneDate(event.end),minuteDelta)}timeElement.text(formatDates(newStart,newEnd,opt('timeFormat')))}function resetElement(){if(allDay){timeElement.css('display','');eventElement.draggable('option','grid',[colWidth,slotHeight]);allDay=false}}}function resizableSlotEvent(event,eventElement,timeElement){var slotDelta,prevSlotDelta;var slotHeight=getSlotHeight();eventElement.resizable({handles:{s:'div.ui-resizable-s'},grid:slotHeight,start:function(ev,ui){slotDelta=prevSlotDelta=0;hideEvents(event,eventElement);eventElement.css('z-index',9);trigger('eventResizeStart',this,event,ev,ui)},resize:function(ev,ui){slotDelta=Math.round((Math.max(slotHeight,eventElement.height())-ui.originalSize.height)/slotHeight);if(slotDelta!=prevSlotDelta){timeElement.text(formatDates(event.start,(!slotDelta&&!event.end)?null:addMinutes(eventEnd(event),opt('slotMinutes')*slotDelta),opt('timeFormat')));prevSlotDelta=slotDelta}},stop:function(ev,ui){trigger('eventResizeStop',this,event,ev,ui);if(slotDelta){eventResize(this,event,0,opt('slotMinutes')*slotDelta,ev,ui)}else{eventElement.css('z-index',8);showEvents(event,eventElement)}}})}}function countForwardSegs(levels){var i,j,k,level,segForward,segBack;for(i=levels.length-1;i>0;i--){level=levels[i];for(j=0;j<level.length;j++){segForward=level[j];for(k=0;k<levels[i-1].length;k++){segBack=levels[i-1][k];if(segsCollide(segForward,segBack)){segBack.forward=Math.max(segBack.forward||0,(segForward.forward||0)+1)}}}}}function View(element,calendar,viewName){var t=this;t.element=element;t.calendar=calendar;t.name=viewName;t.opt=opt;t.trigger=trigger;t.isEventDraggable=isEventDraggable;t.isEventResizable=isEventResizable;t.reportEvents=reportEvents;t.eventEnd=eventEnd;t.reportEventElement=reportEventElement;t.reportEventClear=reportEventClear;t.eventElementHandlers=eventElementHandlers;t.showEvents=showEvents;t.hideEvents=hideEvents;t.eventDrop=eventDrop;t.eventResize=eventResize;var defaultEventEnd=t.defaultEventEnd;var normalizeEvent=calendar.normalizeEvent;var reportEventChange=calendar.reportEventChange;var eventsByID={};var eventElements=[];var eventElementsByID={};var options=calendar.options;function opt(name,viewNameOverride){var v=options[name];if(typeof v=='object'){return smartProperty(v,viewNameOverride||viewName)}return v}function trigger(name,thisObj){return calendar.trigger.apply(calendar,[name,thisObj||t].concat(Array.prototype.slice.call(arguments,2),[t]))}function isEventDraggable(event){return isEventEditable(event)&&!opt('disableDragging')}function isEventResizable(event){return isEventEditable(event)&&!opt('disableResizing')}function isEventEditable(event){return firstDefined(event.editable,(event.source||{}).editable,opt('editable'))}function reportEvents(events){eventsByID={};var i,len=events.length,event;for(i=0;i<len;i++){event=events[i];if(eventsByID[event._id]){eventsByID[event._id].push(event)}else{eventsByID[event._id]=[event]}}}function eventEnd(event){return event.end?cloneDate(event.end):defaultEventEnd(event)}function reportEventElement(event,element){eventElements.push(element);if(eventElementsByID[event._id]){eventElementsByID[event._id].push(element)}else{eventElementsByID[event._id]=[element]}}function reportEventClear(){eventElements=[];eventElementsByID={}}function eventElementHandlers(event,eventElement){eventElement.click(function(ev){if(!eventElement.hasClass('ui-draggable-dragging')&&!eventElement.hasClass('ui-resizable-resizing')){return trigger('eventClick',this,event,ev)}}).hover(function(ev){trigger('eventMouseover',this,event,ev)},function(ev){trigger('eventMouseout',this,event,ev)})}function showEvents(event,exceptElement){eachEventElement(event,exceptElement,'show')}function hideEvents(event,exceptElement){eachEventElement(event,exceptElement,'hide')}function eachEventElement(event,exceptElement,funcName){var elements=eventElementsByID[event._id],i,len=elements.length;for(i=0;i<len;i++){if(!exceptElement||elements[i][0]!=exceptElement[0]){elements[i][funcName]()}}}function eventDrop(e,event,dayDelta,minuteDelta,allDay,ev,ui){var oldAllDay=event.allDay;var eventId=event._id;moveEvents(eventsByID[eventId],dayDelta,minuteDelta,allDay);trigger('eventDrop',e,event,dayDelta,minuteDelta,allDay,function(){moveEvents(eventsByID[eventId],-dayDelta,-minuteDelta,oldAllDay);reportEventChange(eventId)},ev,ui);reportEventChange(eventId)}function eventResize(e,event,dayDelta,minuteDelta,ev,ui){var eventId=event._id;elongateEvents(eventsByID[eventId],dayDelta,minuteDelta);trigger('eventResize',e,event,dayDelta,minuteDelta,function(){elongateEvents(eventsByID[eventId],-dayDelta,-minuteDelta);reportEventChange(eventId)},ev,ui);reportEventChange(eventId)}function moveEvents(events,dayDelta,minuteDelta,allDay){minuteDelta=minuteDelta||0;for(var e,len=events.length,i=0;i<len;i++){e=events[i];if(allDay!==undefined){e.allDay=allDay}addMinutes(addDays(e.start,dayDelta,true),minuteDelta);if(e.end){e.end=addMinutes(addDays(e.end,dayDelta,true),minuteDelta)}normalizeEvent(e,options)}}function elongateEvents(events,dayDelta,minuteDelta){minuteDelta=minuteDelta||0;for(var e,len=events.length,i=0;i<len;i++){e=events[i];e.end=addMinutes(addDays(eventEnd(e),dayDelta,true),minuteDelta);normalizeEvent(e,options)}}}function DayEventRenderer(){var t=this;t.renderDaySegs=renderDaySegs;t.resizableDayEvent=resizableDayEvent;var opt=t.opt;var trigger=t.trigger;var isEventDraggable=t.isEventDraggable;var isEventResizable=t.isEventResizable;var eventEnd=t.eventEnd;var reportEventElement=t.reportEventElement;var showEvents=t.showEvents;var hideEvents=t.hideEvents;var eventResize=t.eventResize;var getRowCnt=t.getRowCnt;var getColCnt=t.getColCnt;var getColWidth=t.getColWidth;var allDayRow=t.allDayRow;var allDayBounds=t.allDayBounds;var colContentLeft=t.colContentLeft;var colContentRight=t.colContentRight;var dayOfWeekCol=t.dayOfWeekCol;var dateCell=t.dateCell;var compileDaySegs=t.compileDaySegs;var getDaySegmentContainer=t.getDaySegmentContainer;var bindDaySeg=t.bindDaySeg;var formatDates=t.calendar.formatDates;var renderDayOverlay=t.renderDayOverlay;var clearOverlays=t.clearOverlays;var clearSelection=t.clearSelection;function renderDaySegs(segs,modifiedEventId){var segmentContainer=getDaySegmentContainer();var rowDivs;var rowCnt=getRowCnt();var colCnt=getColCnt();var i=0;var rowI;var levelI;var colHeights;var j;var segCnt=segs.length;var seg;var top;var k;segmentContainer[0].innerHTML=daySegHTML(segs);daySegElementResolve(segs,segmentContainer.children());daySegElementReport(segs);daySegHandlers(segs,segmentContainer,modifiedEventId);daySegCalcHSides(segs);daySegSetWidths(segs);daySegCalcHeights(segs);rowDivs=getRowDivs();for(rowI=0;rowI<rowCnt;rowI++){levelI=0;colHeights=[];for(j=0;j<colCnt;j++){colHeights[j]=0}while(i<segCnt&&(seg=segs[i]).row==rowI){top=arrayMax(colHeights.slice(seg.startCol,seg.endCol));seg.top=top;top+=seg.outerHeight;for(k=seg.startCol;k<seg.endCol;k++){colHeights[k]=top}i++}rowDivs[rowI].height(arrayMax(colHeights))}daySegSetTops(segs,getRowTops(rowDivs))}function renderTempDaySegs(segs,adjustRow,adjustTop){var tempContainer=$("<div/>");var elements;var segmentContainer=getDaySegmentContainer();var i;var segCnt=segs.length;var element;tempContainer[0].innerHTML=daySegHTML(segs);elements=tempContainer.children();segmentContainer.append(elements);daySegElementResolve(segs,elements);daySegCalcHSides(segs);daySegSetWidths(segs);daySegCalcHeights(segs);daySegSetTops(segs,getRowTops(getRowDivs()));elements=[];for(i=0;i<segCnt;i++){element=segs[i].element;if(element){if(segs[i].row===adjustRow){element.css('top',adjustTop)}elements.push(element[0])}}return $(elements)}function daySegHTML(segs){var rtl=opt('isRTL');var i;var segCnt=segs.length;var seg;var event;var url;var classes;var bounds=allDayBounds();var minLeft=bounds.left;var maxLeft=bounds.right;var leftCol;var rightCol;var left;var right;var skinCss;var html='';for(i=0;i<segCnt;i++){seg=segs[i];event=seg.event;classes=['fc-event','fc-event-skin','fc-event-hori'];if(isEventDraggable(event)){classes.push('fc-event-draggable')}if(rtl){if(seg.isStart){classes.push('fc-corner-right')}if(seg.isEnd){classes.push('fc-corner-left')}leftCol=dayOfWeekCol(seg.end.getDay()-1);rightCol=dayOfWeekCol(seg.start.getDay());left=seg.isEnd?colContentLeft(leftCol):minLeft;right=seg.isStart?colContentRight(rightCol):maxLeft}else{if(seg.isStart){classes.push('fc-corner-left')}if(seg.isEnd){classes.push('fc-corner-right')}leftCol=dayOfWeekCol(seg.start.getDay());rightCol=dayOfWeekCol(seg.end.getDay()-1);left=seg.isStart?colContentLeft(leftCol):minLeft;right=seg.isEnd?colContentRight(rightCol):maxLeft}classes=classes.concat(event.className);if(event.source){classes=classes.concat(event.source.className||[])}url=event.url;skinCss=getSkinCss(event,opt);if(url){html+="<a href='"+htmlEscape(url)+"'"}else{html+="<div"}html+=" class='"+classes.join(' ')+"'"+" style='position:absolute;z-index:8;left:"+left+"px;"+skinCss+"'"+">"+"<div"+" class='fc-event-inner fc-event-skin'"+(skinCss?" style='"+skinCss+"'":'')+">";if(!event.allDay&&seg.isStart){html+="<span class='fc-event-time'>"+htmlEscape(formatDates(event.start,event.end,opt('timeFormat')))+"</span>"}html+="<span class='fc-event-title'>"+htmlEscape(event.title)+"</span>"+"</div>";if(seg.isEnd&&isEventResizable(event)){html+="<div class='ui-resizable-handle ui-resizable-"+(rtl?'w':'e')+"'>"+"&nbsp;&nbsp;&nbsp;"+"</div>"}html+="</"+(url?"a":"div")+">";seg.left=left;seg.outerWidth=right-left;seg.startCol=leftCol;seg.endCol=rightCol+1}return html}function daySegElementResolve(segs,elements){var i;var segCnt=segs.length;var seg;var event;var element;var triggerRes;for(i=0;i<segCnt;i++){seg=segs[i];event=seg.event;element=$(elements[i]);triggerRes=trigger('eventRender',event,event,element);if(triggerRes===false){element.remove()}else{if(triggerRes&&triggerRes!==true){triggerRes=$(triggerRes).css({position:'absolute',left:seg.left});element.replaceWith(triggerRes);element=triggerRes}seg.element=element}}}function daySegElementReport(segs){var i;var segCnt=segs.length;var seg;var element;for(i=0;i<segCnt;i++){seg=segs[i];element=seg.element;if(element){reportEventElement(seg.event,element)}}}function daySegHandlers(segs,segmentContainer,modifiedEventId){var i;var segCnt=segs.length;var seg;var element;var event;for(i=0;i<segCnt;i++){seg=segs[i];element=seg.element;if(element){event=seg.event;if(event._id===modifiedEventId){bindDaySeg(event,element,seg)}else{element[0]._fci=i}}}lazySegBind(segmentContainer,segs,bindDaySeg)}function daySegCalcHSides(segs){var i;var segCnt=segs.length;var seg;var element;var key,val;var hsideCache={};for(i=0;i<segCnt;i++){seg=segs[i];element=seg.element;if(element){key=seg.key=cssKey(element[0]);val=hsideCache[key];if(val===undefined){val=hsideCache[key]=hsides(element,true)}seg.hsides=val}}}function daySegSetWidths(segs){var i;var segCnt=segs.length;var seg;var element;for(i=0;i<segCnt;i++){seg=segs[i];element=seg.element;if(element){element[0].style.width=Math.max(0,seg.outerWidth-seg.hsides)+'px'}}}function daySegCalcHeights(segs){var i;var segCnt=segs.length;var seg;var element;var key,val;var vmarginCache={};for(i=0;i<segCnt;i++){seg=segs[i];element=seg.element;if(element){key=seg.key;val=vmarginCache[key];if(val===undefined){val=vmarginCache[key]=vmargins(element)}seg.outerHeight=element[0].offsetHeight+val}}}function getRowDivs(){var i;var rowCnt=getRowCnt();var rowDivs=[];for(i=0;i<rowCnt;i++){rowDivs[i]=allDayRow(i).find('td:first div.fc-day-content > div')}return rowDivs}function getRowTops(rowDivs){var i;var rowCnt=rowDivs.length;var tops=[];for(i=0;i<rowCnt;i++){tops[i]=rowDivs[i][0].offsetTop}return tops}function daySegSetTops(segs,rowTops){var i;var segCnt=segs.length;var seg;var element;var event;for(i=0;i<segCnt;i++){seg=segs[i];element=seg.element;if(element){element[0].style.top=rowTops[seg.row]+(seg.top||0)+'px';event=seg.event;trigger('eventAfterRender',event,event,element)}}}function resizableDayEvent(event,element,seg){var rtl=opt('isRTL');var direction=rtl?'w':'e';var handle=element.find('div.ui-resizable-'+direction);var isResizing=false;disableTextSelection(element);element.mousedown(function(ev){ev.preventDefault()}).click(function(ev){if(isResizing){ev.preventDefault();ev.stopImmediatePropagation()}});handle.mousedown(function(ev){if(ev.which!=1){return}isResizing=true;var hoverListener=t.getHoverListener();var rowCnt=getRowCnt();var colCnt=getColCnt();var dis=rtl?-1:1;var dit=rtl?colCnt-1:0;var elementTop=element.css('top');var dayDelta;var helpers;var eventCopy=$.extend({},event);var minCell=dateCell(event.start);clearSelection();$('body').css('cursor',direction+'-resize').one('mouseup',mouseup);trigger('eventResizeStart',this,event,ev);hoverListener.start(function(cell,origCell){if(cell){var r=Math.max(minCell.row,cell.row);var c=cell.col;if(rowCnt==1){r=0}if(r==minCell.row){if(rtl){c=Math.min(minCell.col,c)}else{c=Math.max(minCell.col,c)}}dayDelta=(r*7+c*dis+dit)-(origCell.row*7+origCell.col*dis+dit);var newEnd=addDays(eventEnd(event),dayDelta,true);if(dayDelta){eventCopy.end=newEnd;var oldHelpers=helpers;helpers=renderTempDaySegs(compileDaySegs([eventCopy]),seg.row,elementTop);helpers.find('*').css('cursor',direction+'-resize');if(oldHelpers){oldHelpers.remove()}hideEvents(event)}else{if(helpers){showEvents(event);helpers.remove();helpers=null}}clearOverlays();renderDayOverlay(event.start,addDays(cloneDate(newEnd),1))}},ev);function mouseup(ev){trigger('eventResizeStop',this,event,ev);$('body').css('cursor','');hoverListener.stop();clearOverlays();if(dayDelta){eventResize(this,event,dayDelta,0,ev)}setTimeout(function(){isResizing=false},0)}})}}function SelectionManager(){var t=this;t.select=select;t.unselect=unselect;t.reportSelection=reportSelection;t.daySelectionMousedown=daySelectionMousedown;var opt=t.opt;var trigger=t.trigger;var defaultSelectionEnd=t.defaultSelectionEnd;var renderSelection=t.renderSelection;var clearSelection=t.clearSelection;var selected=false;if(opt('selectable')&&opt('unselectAuto')){$(document).mousedown(function(ev){var ignore=opt('unselectCancel');if(ignore){if($(ev.target).parents(ignore).length){return}}unselect(ev)})}function select(startDate,endDate,allDay){unselect();if(!endDate){endDate=defaultSelectionEnd(startDate,allDay)}renderSelection(startDate,endDate,allDay);reportSelection(startDate,endDate,allDay)}function unselect(ev){if(selected){selected=false;clearSelection();trigger('unselect',null,ev)}}function reportSelection(startDate,endDate,allDay,ev){selected=true;trigger('select',null,startDate,endDate,allDay,ev)}function daySelectionMousedown(ev){var cellDate=t.cellDate;var cellIsAllDay=t.cellIsAllDay;var hoverListener=t.getHoverListener();var reportDayClick=t.reportDayClick;if(ev.which==1&&opt('selectable')){unselect(ev);var _mousedownElement=this;var dates;hoverListener.start(function(cell,origCell){clearSelection();if(cell&&cellIsAllDay(cell)){dates=[cellDate(origCell),cellDate(cell)].sort(cmp);renderSelection(dates[0],dates[1],true)}else{dates=null}},ev);$(document).one('mouseup',function(ev){hoverListener.stop();if(dates){if(+dates[0]==+dates[1]){reportDayClick(dates[0],true,ev)}reportSelection(dates[0],dates[1],true,ev)}})}}}function OverlayManager(){var t=this;t.renderOverlay=renderOverlay;t.clearOverlays=clearOverlays;var usedOverlays=[];var unusedOverlays=[];function renderOverlay(rect,parent){var e=unusedOverlays.shift();if(!e){e=$("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")}if(e[0].parentNode!=parent[0]){e.appendTo(parent)}usedOverlays.push(e.css(rect).show());return e}function clearOverlays(){var e;while(e=usedOverlays.shift()){unusedOverlays.push(e.hide().unbind())}}}function CoordinateGrid(buildFunc){var t=this;var rows;var cols;t.build=function(){rows=[];cols=[];buildFunc(rows,cols)};t.cell=function(x,y){var rowCnt=rows.length;var colCnt=cols.length;var i,r=-1,c=-1;for(i=0;i<rowCnt;i++){if(y>=rows[i][0]&&y<rows[i][1]){r=i;break}}for(i=0;i<colCnt;i++){if(x>=cols[i][0]&&x<cols[i][1]){c=i;break}}return(r>=0&&c>=0)?{row:r,col:c}:null};t.rect=function(row0,col0,row1,col1,originElement){var origin=originElement.offset();return{top:rows[row0][0]-origin.top,left:cols[col0][0]-origin.left,width:cols[col1][1]-cols[col0][0],height:rows[row1][1]-rows[row0][0]}}}function HoverListener(coordinateGrid){var t=this;var bindType;var change;var firstCell;var cell;t.start=function(_change,ev,_bindType){change=_change;firstCell=cell=null;coordinateGrid.build();mouse(ev);bindType=_bindType||'mousemove';$(document).bind(bindType,mouse)};function mouse(ev){var newCell=coordinateGrid.cell(ev.pageX,ev.pageY);if(!newCell!=!cell||newCell&&(newCell.row!=cell.row||newCell.col!=cell.col)){if(newCell){if(!firstCell){firstCell=newCell}change(newCell,firstCell,newCell.row-firstCell.row,newCell.col-firstCell.col)}else{change(newCell,firstCell)}cell=newCell}}t.stop=function(){$(document).unbind(bindType,mouse);return cell}}function HorizontalPositionCache(getElement){var t=this,elements={},lefts={},rights={};function e(i){return elements[i]=elements[i]||getElement(i)}t.left=function(i){return lefts[i]=lefts[i]===undefined?e(i).position().left:lefts[i]};t.right=function(i){return rights[i]=rights[i]===undefined?t.left(i)+e(i).width():rights[i]};t.clear=function(){elements={};lefts={};rights={}}}})(jQuery);(function($){var fc=$.fullCalendar;var formatDate=fc.formatDate;var parseISO8601=fc.parseISO8601;var addDays=fc.addDays;var applyAll=fc.applyAll;fc.sourceNormalizers.push(function(sourceOptions){if(sourceOptions.dataType=='gcal'||sourceOptions.dataType===undefined&&(sourceOptions.url||'').match(/^(http|https):\/\/www.google.com\/calendar\/feeds\//)){sourceOptions.dataType='gcal';if(sourceOptions.editable===undefined){sourceOptions.editable=false}}});fc.sourceFetchers.push(function(sourceOptions,start,end){if(sourceOptions.dataType=='gcal'){return transformOptions(sourceOptions,start,end)}});function transformOptions(sourceOptions,start,end){var success=sourceOptions.success;var data=$.extend({},sourceOptions.data||{},{'start-min':formatDate(start,'u'),'start-max':formatDate(end,'u'),'singleevents':true,'max-results':9999});var ctz=sourceOptions.currentTimezone;if(ctz){data.ctz=ctz=ctz.replace(' ','_')}return $.extend({},sourceOptions,{url:sourceOptions.url.replace(/\/basic$/,'/full')+'?alt=json-in-script&callback=?',dataType:'jsonp',data:data,startParam:false,endParam:false,success:function(data){var events=[];if(data.feed.entry){$.each(data.feed.entry,function(i,entry){var startStr=entry['gd$when'][0]['startTime'];var start=parseISO8601(startStr,true);var end=parseISO8601(entry['gd$when'][0]['endTime'],true);var allDay=startStr.indexOf('T')==-1;var url;$.each(entry.link,function(i,link){if(link.type=='text/html'){url=link.href;if(ctz){url+=(url.indexOf('?')==-1?'?':'&')+'ctz='+ctz}}});if(allDay){addDays(end,-1)}events.push({id:entry['gCal$uid']['value'],title:entry['title']['$t'],url:url,start:start,end:end,allDay:allDay,location:entry['gd$where'][0]['valueString'],description:entry['content']['$t']})})}var args=[events].concat(Array.prototype.slice.call(arguments,1));var res=applyAll(success,this,args);if($.isArray(res)){return res}return events}})}fc.gcalFeed=function(url,sourceOptions){return $.extend({},sourceOptions,{url:url,dataType:'gcal'})}})(jQuery)});(function(b){b.color={};b.color.make=function(d,e,g,f){var c={};c.r=d||0;c.g=e||0;c.b=g||0;c.a=f!=null?f:1;c.add=function(h,j){for(var k=0;k<h.length;++k){c[h.charAt(k)]+=j}return c.normalize()};c.scale=function(h,j){for(var k=0;k<h.length;++k){c[h.charAt(k)]*=j}return c.normalize()};c.toString=function(){if(c.a>=1){return"rgb("+[c.r,c.g,c.b].join(",")+")"}else{return"rgba("+[c.r,c.g,c.b,c.a].join(",")+")"}};c.normalize=function(){function h(k,j,l){return j<k?k:(j>l?l:j)}c.r=h(0,parseInt(c.r),255);c.g=h(0,parseInt(c.g),255);c.b=h(0,parseInt(c.b),255);c.a=h(0,c.a,1);return c};c.clone=function(){return b.color.make(c.r,c.b,c.g,c.a)};return c.normalize()};b.color.extract=function(d,e){var c;do{c=d.css(e).toLowerCase();if(c!=""&&c!="transparent"){break}d=d.parent()}while(!b.nodeName(d.get(0),"body"));if(c=="rgba(0, 0, 0, 0)"){c="transparent"}return b.color.parse(c)};b.color.parse=function(c){var d,f=b.color.make;if(d=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c)){return f(parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10))}if(d=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c)){return f(parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10),parseFloat(d[4]))}if(d=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c)){return f(parseFloat(d[1])*2.55,parseFloat(d[2])*2.55,parseFloat(d[3])*2.55)}if(d=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c)){return f(parseFloat(d[1])*2.55,parseFloat(d[2])*2.55,parseFloat(d[3])*2.55,parseFloat(d[4]))}if(d=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c)){return f(parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16))}if(d=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c)){return f(parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16))}var e=b.trim(c).toLowerCase();if(e=="transparent"){return f(255,255,255,0)}else{d=a[e]||[0,0,0];return f(d[0],d[1],d[2])}};var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);(function(c){function b(av,ai,J,af){var Q=[],O={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:true,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:0.85},xaxis:{show:null,position:"bottom",mode:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:false},yaxis:{autoscaleMargin:0.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:false,radius:3,lineWidth:2,fill:true,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:false,fillColor:null,steps:false},bars:{show:false,lineWidth:2,barWidth:1,fill:true,fillColor:null,align:"left",horizontal:false},shadowSize:3},grid:{show:true,aboveData:false,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:false,hoverable:false,autoHighlight:true,mouseActiveRadius:10},hooks:{}},az=null,ad=null,y=null,H=null,A=null,p=[],aw=[],q={left:0,right:0,top:0,bottom:0},G=0,I=0,h=0,w=0,ak={processOptions:[],processRawData:[],processDatapoints:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},aq=this;aq.setData=aj;aq.setupGrid=t;aq.draw=W;aq.getPlaceholder=function(){return av};aq.getCanvas=function(){return az};aq.getPlotOffset=function(){return q};aq.width=function(){return h};aq.height=function(){return w};aq.offset=function(){var aB=y.offset();aB.left+=q.left;aB.top+=q.top;return aB};aq.getData=function(){return Q};aq.getAxes=function(){var aC={},aB;c.each(p.concat(aw),function(aD,aE){if(aE){aC[aE.direction+(aE.n!=1?aE.n:"")+"axis"]=aE}});return aC};aq.getXAxes=function(){return p};aq.getYAxes=function(){return aw};aq.c2p=C;aq.p2c=ar;aq.getOptions=function(){return O};aq.highlight=x;aq.unhighlight=T;aq.triggerRedrawOverlay=f;aq.pointOffset=function(aB){return{left:parseInt(p[aA(aB,"x")-1].p2c(+aB.x)+q.left),top:parseInt(aw[aA(aB,"y")-1].p2c(+aB.y)+q.top)}};aq.shutdown=ag;aq.resize=function(){B();g(az);g(ad)};aq.hooks=ak;F(aq);Z(J);X();aj(ai);t();W();ah();function an(aD,aB){aB=[aq].concat(aB);for(var aC=0;aC<aD.length;++aC){aD[aC].apply(this,aB)}}function F(){for(var aB=0;aB<af.length;++aB){var aC=af[aB];aC.init(aq);if(aC.options){c.extend(true,O,aC.options)}}}function Z(aC){var aB;c.extend(true,O,aC);if(O.xaxis.color==null){O.xaxis.color=O.grid.color}if(O.yaxis.color==null){O.yaxis.color=O.grid.color}if(O.xaxis.tickColor==null){O.xaxis.tickColor=O.grid.tickColor}if(O.yaxis.tickColor==null){O.yaxis.tickColor=O.grid.tickColor}if(O.grid.borderColor==null){O.grid.borderColor=O.grid.color}if(O.grid.tickColor==null){O.grid.tickColor=c.color.parse(O.grid.color).scale("a",0.22).toString()}for(aB=0;aB<Math.max(1,O.xaxes.length);++aB){O.xaxes[aB]=c.extend(true,{},O.xaxis,O.xaxes[aB])}for(aB=0;aB<Math.max(1,O.yaxes.length);++aB){O.yaxes[aB]=c.extend(true,{},O.yaxis,O.yaxes[aB])}if(O.xaxis.noTicks&&O.xaxis.ticks==null){O.xaxis.ticks=O.xaxis.noTicks}if(O.yaxis.noTicks&&O.yaxis.ticks==null){O.yaxis.ticks=O.yaxis.noTicks}if(O.x2axis){O.xaxes[1]=c.extend(true,{},O.xaxis,O.x2axis);O.xaxes[1].position="top"}if(O.y2axis){O.yaxes[1]=c.extend(true,{},O.yaxis,O.y2axis);O.yaxes[1].position="right"}if(O.grid.coloredAreas){O.grid.markings=O.grid.coloredAreas}if(O.grid.coloredAreasColor){O.grid.markingsColor=O.grid.coloredAreasColor}if(O.lines){c.extend(true,O.series.lines,O.lines)}if(O.points){c.extend(true,O.series.points,O.points)}if(O.bars){c.extend(true,O.series.bars,O.bars)}if(O.shadowSize!=null){O.series.shadowSize=O.shadowSize}for(aB=0;aB<O.xaxes.length;++aB){V(p,aB+1).options=O.xaxes[aB]}for(aB=0;aB<O.yaxes.length;++aB){V(aw,aB+1).options=O.yaxes[aB]}for(var aD in ak){if(O.hooks[aD]&&O.hooks[aD].length){ak[aD]=ak[aD].concat(O.hooks[aD])}}an(ak.processOptions,[O])}function aj(aB){Q=Y(aB);ax();z()}function Y(aE){var aC=[];for(var aB=0;aB<aE.length;++aB){var aD=c.extend(true,{},O.series);if(aE[aB].data!=null){aD.data=aE[aB].data;delete aE[aB].data;c.extend(true,aD,aE[aB]);aE[aB].data=aD.data}else{aD.data=aE[aB]}aC.push(aD)}return aC}function aA(aC,aD){var aB=aC[aD+"axis"];if(typeof aB=="object"){aB=aB.n}if(typeof aB!="number"){aB=1}return aB}function m(){return c.grep(p.concat(aw),function(aB){return aB})}function C(aE){var aC={},aB,aD;for(aB=0;aB<p.length;++aB){aD=p[aB];if(aD&&aD.used){aC["x"+aD.n]=aD.c2p(aE.left)}}for(aB=0;aB<aw.length;++aB){aD=aw[aB];if(aD&&aD.used){aC["y"+aD.n]=aD.c2p(aE.top)}}if(aC.x1!==undefined){aC.x=aC.x1}if(aC.y1!==undefined){aC.y=aC.y1}return aC}function ar(aF){var aD={},aC,aE,aB;for(aC=0;aC<p.length;++aC){aE=p[aC];if(aE&&aE.used){aB="x"+aE.n;if(aF[aB]==null&&aE.n==1){aB="x"}if(aF[aB]!=null){aD.left=aE.p2c(aF[aB]);break}}}for(aC=0;aC<aw.length;++aC){aE=aw[aC];if(aE&&aE.used){aB="y"+aE.n;if(aF[aB]==null&&aE.n==1){aB="y"}if(aF[aB]!=null){aD.top=aE.p2c(aF[aB]);break}}}return aD}function V(aC,aB){if(!aC[aB-1]){aC[aB-1]={n:aB,direction:aC==p?"x":"y",options:c.extend(true,{},aC==p?O.xaxis:O.yaxis)}}return aC[aB-1]}function ax(){var aG;var aM=Q.length,aB=[],aE=[];for(aG=0;aG<Q.length;++aG){var aJ=Q[aG].color;if(aJ!=null){--aM;if(typeof aJ=="number"){aE.push(aJ)}else{aB.push(c.color.parse(Q[aG].color))}}}for(aG=0;aG<aE.length;++aG){aM=Math.max(aM,aE[aG]+1)}var aC=[],aF=0;aG=0;while(aC.length<aM){var aI;if(O.colors.length==aG){aI=c.color.make(100,100,100)}else{aI=c.color.parse(O.colors[aG])}var aD=aF%2==1?-1:1;aI.scale("rgb",1+aD*Math.ceil(aF/2)*0.2);aC.push(aI);++aG;if(aG>=O.colors.length){aG=0;++aF}}var aH=0,aN;for(aG=0;aG<Q.length;++aG){aN=Q[aG];if(aN.color==null){aN.color=aC[aH].toString();++aH}else{if(typeof aN.color=="number"){aN.color=aC[aN.color].toString()}}if(aN.lines.show==null){var aL,aK=true;for(aL in aN){if(aN[aL]&&aN[aL].show){aK=false;break}}if(aK){aN.lines.show=true}}aN.xaxis=V(p,aA(aN,"x"));aN.yaxis=V(aw,aA(aN,"y"))}}function z(){var aO=Number.POSITIVE_INFINITY,aI=Number.NEGATIVE_INFINITY,aB=Number.MAX_VALUE,aU,aS,aR,aN,aD,aJ,aT,aP,aH,aG,aC,a0,aX,aL;function aF(a3,a2,a1){if(a2<a3.datamin&&a2!=-aB){a3.datamin=a2}if(a1>a3.datamax&&a1!=aB){a3.datamax=a1}}c.each(m(),function(a1,a2){a2.datamin=aO;a2.datamax=aI;a2.used=false});for(aU=0;aU<Q.length;++aU){aJ=Q[aU];aJ.datapoints={points:[]};an(ak.processRawData,[aJ,aJ.data,aJ.datapoints])}for(aU=0;aU<Q.length;++aU){aJ=Q[aU];var aZ=aJ.data,aW=aJ.datapoints.format;if(!aW){aW=[];aW.push({x:true,number:true,required:true});aW.push({y:true,number:true,required:true});if(aJ.bars.show||(aJ.lines.show&&aJ.lines.fill)){aW.push({y:true,number:true,required:false,defaultValue:0});if(aJ.bars.horizontal){delete aW[aW.length-1].y;aW[aW.length-1].x=true}}aJ.datapoints.format=aW}if(aJ.datapoints.pointsize!=null){continue}aJ.datapoints.pointsize=aW.length;aP=aJ.datapoints.pointsize;aT=aJ.datapoints.points;insertSteps=aJ.lines.show&&aJ.lines.steps;aJ.xaxis.used=aJ.yaxis.used=true;for(aS=aR=0;aS<aZ.length;++aS,aR+=aP){aL=aZ[aS];var aE=aL==null;if(!aE){for(aN=0;aN<aP;++aN){a0=aL[aN];aX=aW[aN];if(aX){if(aX.number&&a0!=null){a0=+a0;if(isNaN(a0)){a0=null}else{if(a0==Infinity){a0=aB}else{if(a0==-Infinity){a0=-aB}}}}if(a0==null){if(aX.required){aE=true}if(aX.defaultValue!=null){a0=aX.defaultValue}}}aT[aR+aN]=a0}}if(aE){for(aN=0;aN<aP;++aN){a0=aT[aR+aN];if(a0!=null){aX=aW[aN];if(aX.x){aF(aJ.xaxis,a0,a0)}if(aX.y){aF(aJ.yaxis,a0,a0)}}aT[aR+aN]=null}}else{if(insertSteps&&aR>0&&aT[aR-aP]!=null&&aT[aR-aP]!=aT[aR]&&aT[aR-aP+1]!=aT[aR+1]){for(aN=0;aN<aP;++aN){aT[aR+aP+aN]=aT[aR+aN]}aT[aR+1]=aT[aR-aP+1];aR+=aP}}}}for(aU=0;aU<Q.length;++aU){aJ=Q[aU];an(ak.processDatapoints,[aJ,aJ.datapoints])}for(aU=0;aU<Q.length;++aU){aJ=Q[aU];aT=aJ.datapoints.points,aP=aJ.datapoints.pointsize;var aK=aO,aQ=aO,aM=aI,aV=aI;for(aS=0;aS<aT.length;aS+=aP){if(aT[aS]==null){continue}for(aN=0;aN<aP;++aN){a0=aT[aS+aN];aX=aW[aN];if(!aX||a0==aB||a0==-aB){continue}if(aX.x){if(a0<aK){aK=a0}if(a0>aM){aM=a0}}if(aX.y){if(a0<aQ){aQ=a0}if(a0>aV){aV=a0}}}}if(aJ.bars.show){var aY=aJ.bars.align=="left"?0:-aJ.bars.barWidth/2;if(aJ.bars.horizontal){aQ+=aY;aV+=aY+aJ.bars.barWidth}else{aK+=aY;aM+=aY+aJ.bars.barWidth}}aF(aJ.xaxis,aK,aM);aF(aJ.yaxis,aQ,aV)}c.each(m(),function(a1,a2){if(a2.datamin==aO){a2.datamin=null}if(a2.datamax==aI){a2.datamax=null}})}function j(aB,aC){var aD=document.createElement("canvas");aD.className=aC;aD.width=G;aD.height=I;if(!aB){c(aD).css({position:"absolute",left:0,top:0})}c(aD).appendTo(av);if(!aD.getContext){aD=window.G_vmlCanvasManager.initElement(aD)}aD.getContext("2d").save();return aD}function B(){G=av.width();I=av.height();if(G<=0||I<=0){throw"Invalid dimensions for plot, width = "+G+", height = "+I}}function g(aC){if(aC.width!=G){aC.width=G}if(aC.height!=I){aC.height=I}var aB=aC.getContext("2d");aB.restore();aB.save()}function X(){var aC,aB=av.children("canvas.base"),aD=av.children("canvas.overlay");if(aB.length==0||aD==0){av.html("");av.css({padding:0});if(av.css("position")=="static"){av.css("position","relative")}B();az=j(true,"base");ad=j(false,"overlay");aC=false}else{az=aB.get(0);ad=aD.get(0);aC=true}H=az.getContext("2d");A=ad.getContext("2d");y=c([ad,az]);if(aC){av.data("plot").shutdown();aq.resize();A.clearRect(0,0,G,I);y.unbind();av.children().not([az,ad]).remove()}av.data("plot",aq)}function ah(){if(O.grid.hoverable){y.mousemove(aa);y.mouseleave(l)}if(O.grid.clickable){y.click(R)}an(ak.bindEvents,[y])}function ag(){if(M){clearTimeout(M)}y.unbind("mousemove",aa);y.unbind("mouseleave",l);y.unbind("click",R);an(ak.shutdown,[y])}function r(aG){function aC(aH){return aH}var aF,aB,aD=aG.options.transform||aC,aE=aG.options.inverseTransform;if(aG.direction=="x"){aF=aG.scale=h/Math.abs(aD(aG.max)-aD(aG.min));aB=Math.min(aD(aG.max),aD(aG.min))}else{aF=aG.scale=w/Math.abs(aD(aG.max)-aD(aG.min));aF=-aF;aB=Math.max(aD(aG.max),aD(aG.min))}if(aD==aC){aG.p2c=function(aH){return(aH-aB)*aF}}else{aG.p2c=function(aH){return(aD(aH)-aB)*aF}}if(!aE){aG.c2p=function(aH){return aB+aH/aF}}else{aG.c2p=function(aH){return aE(aB+aH/aF)}}}function L(aD){var aB=aD.options,aF,aJ=aD.ticks||[],aI=[],aE,aK=aB.labelWidth,aG=aB.labelHeight,aC;function aH(aM,aL){return c('<div style="position:absolute;top:-10000px;'+aL+'font-size:smaller"><div class="'+aD.direction+"Axis "+aD.direction+aD.n+'Axis">'+aM.join("")+"</div></div>").appendTo(av)}if(aD.direction=="x"){if(aK==null){aK=Math.floor(G/(aJ.length>0?aJ.length:1))}if(aG==null){aI=[];for(aF=0;aF<aJ.length;++aF){aE=aJ[aF].label;if(aE){aI.push('<div class="tickLabel" style="float:left;width:'+aK+'px">'+aE+"</div>")}}if(aI.length>0){aI.push('<div style="clear:left"></div>');aC=aH(aI,"width:10000px;");aG=aC.height();aC.remove()}}}else{if(aK==null||aG==null){for(aF=0;aF<aJ.length;++aF){aE=aJ[aF].label;if(aE){aI.push('<div class="tickLabel">'+aE+"</div>")}}if(aI.length>0){aC=aH(aI,"");if(aK==null){aK=aC.children().width()}if(aG==null){aG=aC.find("div.tickLabel").height()}aC.remove()}}}if(aK==null){aK=0}if(aG==null){aG=0}aD.labelWidth=aK;aD.labelHeight=aG}function au(aD){var aC=aD.labelWidth,aL=aD.labelHeight,aH=aD.options.position,aF=aD.options.tickLength,aG=O.grid.axisMargin,aJ=O.grid.labelMargin,aK=aD.direction=="x"?p:aw,aE;var aB=c.grep(aK,function(aN){return aN&&aN.options.position==aH&&aN.reserveSpace});if(c.inArray(aD,aB)==aB.length-1){aG=0}if(aF==null){aF="full"}var aI=c.grep(aK,function(aN){return aN&&aN.reserveSpace});var aM=c.inArray(aD,aI)==0;if(!aM&&aF=="full"){aF=5}if(!isNaN(+aF)){aJ+=+aF}if(aD.direction=="x"){aL+=aJ;if(aH=="bottom"){q.bottom+=aL+aG;aD.box={top:I-q.bottom,height:aL}}else{aD.box={top:q.top+aG,height:aL};q.top+=aL+aG}}else{aC+=aJ;if(aH=="left"){aD.box={left:q.left+aG,width:aC};q.left+=aC+aG}else{q.right+=aC+aG;aD.box={left:G-q.right,width:aC}}}aD.position=aH;aD.tickLength=aF;aD.box.padding=aJ;aD.innermost=aM}function U(aB){if(aB.direction=="x"){aB.box.left=q.left;aB.box.width=h}else{aB.box.top=q.top;aB.box.height=w}}function t(){var aC,aE=m();c.each(aE,function(aF,aG){aG.show=aG.options.show;if(aG.show==null){aG.show=aG.used}aG.reserveSpace=aG.show||aG.options.reserveSpace;n(aG)});allocatedAxes=c.grep(aE,function(aF){return aF.reserveSpace});q.left=q.right=q.top=q.bottom=0;if(O.grid.show){c.each(allocatedAxes,function(aF,aG){S(aG);P(aG);ap(aG,aG.ticks);L(aG)});for(aC=allocatedAxes.length-1;aC>=0;--aC){au(allocatedAxes[aC])}var aD=O.grid.minBorderMargin;if(aD==null){aD=0;for(aC=0;aC<Q.length;++aC){aD=Math.max(aD,Q[aC].points.radius+Q[aC].points.lineWidth/2)}}for(var aB in q){q[aB]+=O.grid.borderWidth;q[aB]=Math.max(aD,q[aB])}}h=G-q.left-q.right;w=I-q.bottom-q.top;c.each(aE,function(aF,aG){r(aG)});if(O.grid.show){c.each(allocatedAxes,function(aF,aG){U(aG)});k()}o()}function n(aE){var aF=aE.options,aD=+(aF.min!=null?aF.min:aE.datamin),aB=+(aF.max!=null?aF.max:aE.datamax),aH=aB-aD;if(aH==0){var aC=aB==0?1:0.01;if(aF.min==null){aD-=aC}if(aF.max==null||aF.min!=null){aB+=aC}}else{var aG=aF.autoscaleMargin;if(aG!=null){if(aF.min==null){aD-=aH*aG;if(aD<0&&aE.datamin!=null&&aE.datamin>=0){aD=0}}if(aF.max==null){aB+=aH*aG;if(aB>0&&aE.datamax!=null&&aE.datamax<=0){aB=0}}}}aE.min=aD;aE.max=aB}function S(aG){var aM=aG.options;var aH;if(typeof aM.ticks=="number"&&aM.ticks>0){aH=aM.ticks}else{aH=0.3*Math.sqrt(aG.direction=="x"?G:I)}var aT=(aG.max-aG.min)/aH,aO,aB,aN,aR,aS,aQ,aI;if(aM.mode=="time"){var aJ={second:1000,minute:60*1000,hour:60*60*1000,day:24*60*60*1000,month:30*24*60*60*1000,year:365.2425*24*60*60*1000};var aK=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[0.25,"month"],[0.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]];var aC=0;if(aM.minTickSize!=null){if(typeof aM.tickSize=="number"){aC=aM.tickSize}else{aC=aM.minTickSize[0]*aJ[aM.minTickSize[1]]}}for(var aS=0;aS<aK.length-1;++aS){if(aT<(aK[aS][0]*aJ[aK[aS][1]]+aK[aS+1][0]*aJ[aK[aS+1][1]])/2&&aK[aS][0]*aJ[aK[aS][1]]>=aC){break}}aO=aK[aS][0];aN=aK[aS][1];if(aN=="year"){aQ=Math.pow(10,Math.floor(Math.log(aT/aJ.year)/Math.LN10));aI=(aT/aJ.year)/aQ;if(aI<1.5){aO=1}else{if(aI<3){aO=2}else{if(aI<7.5){aO=5}else{aO=10}}}aO*=aQ}aG.tickSize=aM.tickSize||[aO,aN];aB=function(aX){var a2=[],a0=aX.tickSize[0],a3=aX.tickSize[1],a1=new Date(aX.min);var aW=a0*aJ[a3];if(a3=="second"){a1.setUTCSeconds(a(a1.getUTCSeconds(),a0))}if(a3=="minute"){a1.setUTCMinutes(a(a1.getUTCMinutes(),a0))}if(a3=="hour"){a1.setUTCHours(a(a1.getUTCHours(),a0))}if(a3=="month"){a1.setUTCMonth(a(a1.getUTCMonth(),a0))}if(a3=="year"){a1.setUTCFullYear(a(a1.getUTCFullYear(),a0))}a1.setUTCMilliseconds(0);if(aW>=aJ.minute){a1.setUTCSeconds(0)}if(aW>=aJ.hour){a1.setUTCMinutes(0)}if(aW>=aJ.day){a1.setUTCHours(0)}if(aW>=aJ.day*4){a1.setUTCDate(1)}if(aW>=aJ.year){a1.setUTCMonth(0)}var a5=0,a4=Number.NaN,aY;do{aY=a4;a4=a1.getTime();a2.push(a4);if(a3=="month"){if(a0<1){a1.setUTCDate(1);var aV=a1.getTime();a1.setUTCMonth(a1.getUTCMonth()+1);var aZ=a1.getTime();a1.setTime(a4+a5*aJ.hour+(aZ-aV)*a0);a5=a1.getUTCHours();a1.setUTCHours(0)}else{a1.setUTCMonth(a1.getUTCMonth()+a0)}}else{if(a3=="year"){a1.setUTCFullYear(a1.getUTCFullYear()+a0)}else{a1.setTime(a4+aW)}}}while(a4<aX.max&&a4!=aY);return a2};aR=function(aV,aY){var a0=new Date(aV);if(aM.timeformat!=null){return c.plot.formatDate(a0,aM.timeformat,aM.monthNames)}var aW=aY.tickSize[0]*aJ[aY.tickSize[1]];var aX=aY.max-aY.min;var aZ=(aM.twelveHourClock)?" %p":"";if(aW<aJ.minute){fmt="%h:%M:%S"+aZ}else{if(aW<aJ.day){if(aX<2*aJ.day){fmt="%h:%M"+aZ}else{fmt="%b %d %h:%M"+aZ}}else{if(aW<aJ.month){fmt="%b %d"}else{if(aW<aJ.year){if(aX<aJ.year){fmt="%b"}else{fmt="%b %y"}}else{fmt="%y"}}}}return c.plot.formatDate(a0,fmt,aM.monthNames)}}else{var aU=aM.tickDecimals;var aP=-Math.floor(Math.log(aT)/Math.LN10);if(aU!=null&&aP>aU){aP=aU}aQ=Math.pow(10,-aP);aI=aT/aQ;if(aI<1.5){aO=1}else{if(aI<3){aO=2;if(aI>2.25&&(aU==null||aP+1<=aU)){aO=2.5;++aP}}else{if(aI<7.5){aO=5}else{aO=10}}}aO*=aQ;if(aM.minTickSize!=null&&aO<aM.minTickSize){aO=aM.minTickSize}aG.tickDecimals=Math.max(0,aU!=null?aU:aP);aG.tickSize=aM.tickSize||aO;aB=function(aX){var aZ=[];var a0=a(aX.min,aX.tickSize),aW=0,aV=Number.NaN,aY;do{aY=aV;aV=a0+aW*aX.tickSize;aZ.push(aV);++aW}while(aV<aX.max&&aV!=aY);return aZ};aR=function(aV,aW){return aV.toFixed(aW.tickDecimals)}}if(aM.alignTicksWithAxis!=null){var aF=(aG.direction=="x"?p:aw)[aM.alignTicksWithAxis-1];if(aF&&aF.used&&aF!=aG){var aL=aB(aG);if(aL.length>0){if(aM.min==null){aG.min=Math.min(aG.min,aL[0])}if(aM.max==null&&aL.length>1){aG.max=Math.max(aG.max,aL[aL.length-1])}}aB=function(aX){var aY=[],aV,aW;for(aW=0;aW<aF.ticks.length;++aW){aV=(aF.ticks[aW].v-aF.min)/(aF.max-aF.min);aV=aX.min+aV*(aX.max-aX.min);aY.push(aV)}return aY};if(aG.mode!="time"&&aM.tickDecimals==null){var aE=Math.max(0,-Math.floor(Math.log(aT)/Math.LN10)+1),aD=aB(aG);if(!(aD.length>1&&/\..*0$/.test((aD[1]-aD[0]).toFixed(aE)))){aG.tickDecimals=aE}}}}aG.tickGenerator=aB;if(c.isFunction(aM.tickFormatter)){aG.tickFormatter=function(aV,aW){return""+aM.tickFormatter(aV,aW)}}else{aG.tickFormatter=aR}}function P(aF){var aH=aF.options.ticks,aG=[];if(aH==null||(typeof aH=="number"&&aH>0)){aG=aF.tickGenerator(aF)}else{if(aH){if(c.isFunction(aH)){aG=aH({min:aF.min,max:aF.max})}else{aG=aH}}}var aE,aB;aF.ticks=[];for(aE=0;aE<aG.length;++aE){var aC=null;var aD=aG[aE];if(typeof aD=="object"){aB=+aD[0];if(aD.length>1){aC=aD[1]}}else{aB=+aD}if(aC==null){aC=aF.tickFormatter(aB,aF)}if(!isNaN(aB)){aF.ticks.push({v:aB,label:aC})}}}function ap(aB,aC){if(aB.options.autoscaleMargin&&aC.length>0){if(aB.options.min==null){aB.min=Math.min(aB.min,aC[0].v)}if(aB.options.max==null&&aC.length>1){aB.max=Math.max(aB.max,aC[aC.length-1].v)}}}function W(){H.clearRect(0,0,G,I);var aC=O.grid;if(aC.show&&aC.backgroundColor){N()}if(aC.show&&!aC.aboveData){ac()}for(var aB=0;aB<Q.length;++aB){an(ak.drawSeries,[H,Q[aB]]);d(Q[aB])}an(ak.draw,[H]);if(aC.show&&aC.aboveData){ac()}}function D(aB,aI){var aE,aH,aG,aD,aF=m();for(i=0;i<aF.length;++i){aE=aF[i];if(aE.direction==aI){aD=aI+aE.n+"axis";if(!aB[aD]&&aE.n==1){aD=aI+"axis"}if(aB[aD]){aH=aB[aD].from;aG=aB[aD].to;break}}}if(!aB[aD]){aE=aI=="x"?p[0]:aw[0];aH=aB[aI+"1"];aG=aB[aI+"2"]}if(aH!=null&&aG!=null&&aH>aG){var aC=aH;aH=aG;aG=aC}return{from:aH,to:aG,axis:aE}}function N(){H.save();H.translate(q.left,q.top);H.fillStyle=am(O.grid.backgroundColor,w,0,"rgba(255, 255, 255, 0)");H.fillRect(0,0,h,w);H.restore()}function ac(){var aF;H.save();H.translate(q.left,q.top);var aH=O.grid.markings;if(aH){if(c.isFunction(aH)){var aK=aq.getAxes();aK.xmin=aK.xaxis.min;aK.xmax=aK.xaxis.max;aK.ymin=aK.yaxis.min;aK.ymax=aK.yaxis.max;aH=aH(aK)}for(aF=0;aF<aH.length;++aF){var aD=aH[aF],aC=D(aD,"x"),aI=D(aD,"y");if(aC.from==null){aC.from=aC.axis.min}if(aC.to==null){aC.to=aC.axis.max}if(aI.from==null){aI.from=aI.axis.min}if(aI.to==null){aI.to=aI.axis.max}if(aC.to<aC.axis.min||aC.from>aC.axis.max||aI.to<aI.axis.min||aI.from>aI.axis.max){continue}aC.from=Math.max(aC.from,aC.axis.min);aC.to=Math.min(aC.to,aC.axis.max);aI.from=Math.max(aI.from,aI.axis.min);aI.to=Math.min(aI.to,aI.axis.max);if(aC.from==aC.to&&aI.from==aI.to){continue}aC.from=aC.axis.p2c(aC.from);aC.to=aC.axis.p2c(aC.to);aI.from=aI.axis.p2c(aI.from);aI.to=aI.axis.p2c(aI.to);if(aC.from==aC.to||aI.from==aI.to){H.beginPath();H.strokeStyle=aD.color||O.grid.markingsColor;H.lineWidth=aD.lineWidth||O.grid.markingsLineWidth;H.moveTo(aC.from,aI.from);H.lineTo(aC.to,aI.to);H.stroke()}else{H.fillStyle=aD.color||O.grid.markingsColor;H.fillRect(aC.from,aI.to,aC.to-aC.from,aI.from-aI.to)}}}var aK=m(),aM=O.grid.borderWidth;for(var aE=0;aE<aK.length;++aE){var aB=aK[aE],aG=aB.box,aQ=aB.tickLength,aN,aL,aP,aJ;if(!aB.show||aB.ticks.length==0){continue}H.strokeStyle=aB.options.tickColor||c.color.parse(aB.options.color).scale("a",0.22).toString();H.lineWidth=1;if(aB.direction=="x"){aN=0;if(aQ=="full"){aL=(aB.position=="top"?0:w)}else{aL=aG.top-q.top+(aB.position=="top"?aG.height:0)}}else{aL=0;if(aQ=="full"){aN=(aB.position=="left"?0:h)}else{aN=aG.left-q.left+(aB.position=="left"?aG.width:0)}}if(!aB.innermost){H.beginPath();aP=aJ=0;if(aB.direction=="x"){aP=h}else{aJ=w}if(H.lineWidth==1){aN=Math.floor(aN)+0.5;aL=Math.floor(aL)+0.5}H.moveTo(aN,aL);H.lineTo(aN+aP,aL+aJ);H.stroke()}H.beginPath();for(aF=0;aF<aB.ticks.length;++aF){var aO=aB.ticks[aF].v;aP=aJ=0;if(aO<aB.min||aO>aB.max||(aQ=="full"&&aM>0&&(aO==aB.min||aO==aB.max))){continue}if(aB.direction=="x"){aN=aB.p2c(aO);aJ=aQ=="full"?-w:aQ;if(aB.position=="top"){aJ=-aJ}}else{aL=aB.p2c(aO);aP=aQ=="full"?-h:aQ;if(aB.position=="left"){aP=-aP}}if(H.lineWidth==1){if(aB.direction=="x"){aN=Math.floor(aN)+0.5}else{aL=Math.floor(aL)+0.5}}H.moveTo(aN,aL);H.lineTo(aN+aP,aL+aJ)}H.stroke()}if(aM){H.lineWidth=aM;H.strokeStyle=O.grid.borderColor;H.strokeRect(-aM/2,-aM/2,h+aM,w+aM)}H.restore()}function k(){av.find(".tickLabels").remove();var aG=['<div class="tickLabels" style="font-size:smaller">'];var aJ=m();for(var aD=0;aD<aJ.length;++aD){var aC=aJ[aD],aF=aC.box;if(!aC.show){continue}aG.push('<div class="'+aC.direction+"Axis "+aC.direction+aC.n+'Axis" style="color:'+aC.options.color+'">');for(var aE=0;aE<aC.ticks.length;++aE){var aH=aC.ticks[aE];if(!aH.label||aH.v<aC.min||aH.v>aC.max){continue}var aK={},aI;if(aC.direction=="x"){aI="center";aK.left=Math.round(q.left+aC.p2c(aH.v)-aC.labelWidth/2);if(aC.position=="bottom"){aK.top=aF.top+aF.padding}else{aK.bottom=I-(aF.top+aF.height-aF.padding)}}else{aK.top=Math.round(q.top+aC.p2c(aH.v)-aC.labelHeight/2);if(aC.position=="left"){aK.right=G-(aF.left+aF.width-aF.padding);aI="right"}else{aK.left=aF.left+aF.padding;aI="left"}}aK.width=aC.labelWidth;var aB=["position:absolute","text-align:"+aI];for(var aL in aK){aB.push(aL+":"+aK[aL]+"px")}aG.push('<div class="tickLabel" style="'+aB.join(";")+'">'+aH.label+"</div>")}aG.push("</div>")}aG.push("</div>");av.append(aG.join(""))}function d(aB){if(aB.lines.show){at(aB)}if(aB.bars.show){e(aB)}if(aB.points.show){ao(aB)}}function at(aE){function aD(aP,aQ,aI,aU,aT){var aV=aP.points,aJ=aP.pointsize,aN=null,aM=null;H.beginPath();for(var aO=aJ;aO<aV.length;aO+=aJ){var aL=aV[aO-aJ],aS=aV[aO-aJ+1],aK=aV[aO],aR=aV[aO+1];if(aL==null||aK==null){continue}if(aS<=aR&&aS<aT.min){if(aR<aT.min){continue}aL=(aT.min-aS)/(aR-aS)*(aK-aL)+aL;aS=aT.min}else{if(aR<=aS&&aR<aT.min){if(aS<aT.min){continue}aK=(aT.min-aS)/(aR-aS)*(aK-aL)+aL;aR=aT.min}}if(aS>=aR&&aS>aT.max){if(aR>aT.max){continue}aL=(aT.max-aS)/(aR-aS)*(aK-aL)+aL;aS=aT.max}else{if(aR>=aS&&aR>aT.max){if(aS>aT.max){continue}aK=(aT.max-aS)/(aR-aS)*(aK-aL)+aL;aR=aT.max}}if(aL<=aK&&aL<aU.min){if(aK<aU.min){continue}aS=(aU.min-aL)/(aK-aL)*(aR-aS)+aS;aL=aU.min}else{if(aK<=aL&&aK<aU.min){if(aL<aU.min){continue}aR=(aU.min-aL)/(aK-aL)*(aR-aS)+aS;aK=aU.min}}if(aL>=aK&&aL>aU.max){if(aK>aU.max){continue}aS=(aU.max-aL)/(aK-aL)*(aR-aS)+aS;aL=aU.max}else{if(aK>=aL&&aK>aU.max){if(aL>aU.max){continue}aR=(aU.max-aL)/(aK-aL)*(aR-aS)+aS;aK=aU.max}}if(aL!=aN||aS!=aM){H.moveTo(aU.p2c(aL)+aQ,aT.p2c(aS)+aI)}aN=aK;aM=aR;H.lineTo(aU.p2c(aK)+aQ,aT.p2c(aR)+aI)}H.stroke()}function aF(aI,aQ,aP){var aW=aI.points,aV=aI.pointsize,aN=Math.min(Math.max(0,aP.min),aP.max),aX=0,aU,aT=false,aM=1,aL=0,aR=0;while(true){if(aV>0&&aX>aW.length+aV){break}aX+=aV;var aZ=aW[aX-aV],aK=aW[aX-aV+aM],aY=aW[aX],aJ=aW[aX+aM];if(aT){if(aV>0&&aZ!=null&&aY==null){aR=aX;aV=-aV;aM=2;continue}if(aV<0&&aX==aL+aV){H.fill();aT=false;aV=-aV;aM=1;aX=aL=aR+aV;continue}}if(aZ==null||aY==null){continue}if(aZ<=aY&&aZ<aQ.min){if(aY<aQ.min){continue}aK=(aQ.min-aZ)/(aY-aZ)*(aJ-aK)+aK;aZ=aQ.min}else{if(aY<=aZ&&aY<aQ.min){if(aZ<aQ.min){continue}aJ=(aQ.min-aZ)/(aY-aZ)*(aJ-aK)+aK;aY=aQ.min}}if(aZ>=aY&&aZ>aQ.max){if(aY>aQ.max){continue}aK=(aQ.max-aZ)/(aY-aZ)*(aJ-aK)+aK;aZ=aQ.max}else{if(aY>=aZ&&aY>aQ.max){if(aZ>aQ.max){continue}aJ=(aQ.max-aZ)/(aY-aZ)*(aJ-aK)+aK;aY=aQ.max}}if(!aT){H.beginPath();H.moveTo(aQ.p2c(aZ),aP.p2c(aN));aT=true}if(aK>=aP.max&&aJ>=aP.max){H.lineTo(aQ.p2c(aZ),aP.p2c(aP.max));H.lineTo(aQ.p2c(aY),aP.p2c(aP.max));continue}else{if(aK<=aP.min&&aJ<=aP.min){H.lineTo(aQ.p2c(aZ),aP.p2c(aP.min));H.lineTo(aQ.p2c(aY),aP.p2c(aP.min));continue}}var aO=aZ,aS=aY;if(aK<=aJ&&aK<aP.min&&aJ>=aP.min){aZ=(aP.min-aK)/(aJ-aK)*(aY-aZ)+aZ;aK=aP.min}else{if(aJ<=aK&&aJ<aP.min&&aK>=aP.min){aY=(aP.min-aK)/(aJ-aK)*(aY-aZ)+aZ;aJ=aP.min}}if(aK>=aJ&&aK>aP.max&&aJ<=aP.max){aZ=(aP.max-aK)/(aJ-aK)*(aY-aZ)+aZ;aK=aP.max}else{if(aJ>=aK&&aJ>aP.max&&aK<=aP.max){aY=(aP.max-aK)/(aJ-aK)*(aY-aZ)+aZ;aJ=aP.max}}if(aZ!=aO){H.lineTo(aQ.p2c(aO),aP.p2c(aK))}H.lineTo(aQ.p2c(aZ),aP.p2c(aK));H.lineTo(aQ.p2c(aY),aP.p2c(aJ));if(aY!=aS){H.lineTo(aQ.p2c(aY),aP.p2c(aJ));H.lineTo(aQ.p2c(aS),aP.p2c(aJ))}}}H.save();H.translate(q.left,q.top);H.lineJoin="round";var aG=aE.lines.lineWidth,aB=aE.shadowSize;if(aG>0&&aB>0){H.lineWidth=aB;H.strokeStyle="rgba(0,0,0,0.1)";var aH=Math.PI/18;aD(aE.datapoints,Math.sin(aH)*(aG/2+aB/2),Math.cos(aH)*(aG/2+aB/2),aE.xaxis,aE.yaxis);H.lineWidth=aB/2;aD(aE.datapoints,Math.sin(aH)*(aG/2+aB/4),Math.cos(aH)*(aG/2+aB/4),aE.xaxis,aE.yaxis)}H.lineWidth=aG;H.strokeStyle=aE.color;var aC=ae(aE.lines,aE.color,0,w);if(aC){H.fillStyle=aC;aF(aE.datapoints,aE.xaxis,aE.yaxis)}if(aG>0){aD(aE.datapoints,0,0,aE.xaxis,aE.yaxis)}H.restore()}function ao(aE){function aH(aN,aM,aU,aK,aS,aT,aQ,aJ){var aR=aN.points,aI=aN.pointsize;for(var aL=0;aL<aR.length;aL+=aI){var aP=aR[aL],aO=aR[aL+1];if(aP==null||aP<aT.min||aP>aT.max||aO<aQ.min||aO>aQ.max){continue}H.beginPath();aP=aT.p2c(aP);aO=aQ.p2c(aO)+aK;if(aJ=="circle"){H.arc(aP,aO,aM,0,aS?Math.PI:Math.PI*2,false)}else{aJ(H,aP,aO,aM,aS)}H.closePath();if(aU){H.fillStyle=aU;H.fill()}H.stroke()}}H.save();H.translate(q.left,q.top);var aG=aE.points.lineWidth,aC=aE.shadowSize,aB=aE.points.radius,aF=aE.points.symbol;if(aG>0&&aC>0){var aD=aC/2;H.lineWidth=aD;H.strokeStyle="rgba(0,0,0,0.1)";aH(aE.datapoints,aB,null,aD+aD/2,true,aE.xaxis,aE.yaxis,aF);H.strokeStyle="rgba(0,0,0,0.2)";aH(aE.datapoints,aB,null,aD/2,true,aE.xaxis,aE.yaxis,aF)}H.lineWidth=aG;H.strokeStyle=aE.color;aH(aE.datapoints,aB,ae(aE.points,aE.color),0,false,aE.xaxis,aE.yaxis,aF);H.restore()}function E(aN,aM,aV,aI,aQ,aF,aD,aL,aK,aU,aR,aC){var aE,aT,aJ,aP,aG,aB,aO,aH,aS;if(aR){aH=aB=aO=true;aG=false;aE=aV;aT=aN;aP=aM+aI;aJ=aM+aQ;if(aT<aE){aS=aT;aT=aE;aE=aS;aG=true;aB=false}}else{aG=aB=aO=true;aH=false;aE=aN+aI;aT=aN+aQ;aJ=aV;aP=aM;if(aP<aJ){aS=aP;aP=aJ;aJ=aS;aH=true;aO=false}}if(aT<aL.min||aE>aL.max||aP<aK.min||aJ>aK.max){return}if(aE<aL.min){aE=aL.min;aG=false}if(aT>aL.max){aT=aL.max;aB=false}if(aJ<aK.min){aJ=aK.min;aH=false}if(aP>aK.max){aP=aK.max;aO=false}aE=aL.p2c(aE);aJ=aK.p2c(aJ);aT=aL.p2c(aT);aP=aK.p2c(aP);if(aD){aU.beginPath();aU.moveTo(aE,aJ);aU.lineTo(aE,aP);aU.lineTo(aT,aP);aU.lineTo(aT,aJ);aU.fillStyle=aD(aJ,aP);aU.fill()}if(aC>0&&(aG||aB||aO||aH)){aU.beginPath();aU.moveTo(aE,aJ+aF);if(aG){aU.lineTo(aE,aP+aF)}else{aU.moveTo(aE,aP+aF)}if(aO){aU.lineTo(aT,aP+aF)}else{aU.moveTo(aT,aP+aF)}if(aB){aU.lineTo(aT,aJ+aF)}else{aU.moveTo(aT,aJ+aF)}if(aH){aU.lineTo(aE,aJ+aF)}else{aU.moveTo(aE,aJ+aF)}aU.stroke()}}function e(aD){function aC(aJ,aI,aL,aG,aK,aN,aM){var aO=aJ.points,aF=aJ.pointsize;for(var aH=0;aH<aO.length;aH+=aF){if(aO[aH]==null){continue}E(aO[aH],aO[aH+1],aO[aH+2],aI,aL,aG,aK,aN,aM,H,aD.bars.horizontal,aD.bars.lineWidth)}}H.save();H.translate(q.left,q.top);H.lineWidth=aD.bars.lineWidth;H.strokeStyle=aD.color;var aB=aD.bars.align=="left"?0:-aD.bars.barWidth/2;var aE=aD.bars.fill?function(aF,aG){return ae(aD.bars,aD.color,aF,aG)}:null;aC(aD.datapoints,aB,aB+aD.bars.barWidth,0,aE,aD.xaxis,aD.yaxis);H.restore()}function ae(aD,aB,aC,aF){var aE=aD.fill;if(!aE){return null}if(aD.fillColor){return am(aD.fillColor,aC,aF,aB)}var aG=c.color.parse(aB);aG.a=typeof aE=="number"?aE:0.4;aG.normalize();return aG.toString()}function o(){av.find(".legend").remove();if(!O.legend.show){return}var aH=[],aF=false,aN=O.legend.labelFormatter,aM,aJ;for(var aE=0;aE<Q.length;++aE){aM=Q[aE];aJ=aM.label;if(!aJ){continue}if(aE%O.legend.noColumns==0){if(aF){aH.push("</tr>")}aH.push("<tr>");aF=true}if(aN){aJ=aN(aJ,aM)}aH.push('<td class="legendColorBox"><div style="border:1px solid '+O.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+aM.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+aJ+"</td>")}if(aF){aH.push("</tr>")}if(aH.length==0){return}var aL='<table style="font-size:smaller;color:'+O.grid.color+'">'+aH.join("")+"</table>";if(O.legend.container!=null){c(O.legend.container).html(aL)}else{var aI="",aC=O.legend.position,aD=O.legend.margin;if(aD[0]==null){aD=[aD,aD]}if(aC.charAt(0)=="n"){aI+="top:"+(aD[1]+q.top)+"px;"}else{if(aC.charAt(0)=="s"){aI+="bottom:"+(aD[1]+q.bottom)+"px;"}}if(aC.charAt(1)=="e"){aI+="right:"+(aD[0]+q.right)+"px;"}else{if(aC.charAt(1)=="w"){aI+="left:"+(aD[0]+q.left)+"px;"}}var aK=c('<div class="legend">'+aL.replace('style="','style="position:absolute;'+aI+";")+"</div>").appendTo(av);if(O.legend.backgroundOpacity!=0){var aG=O.legend.backgroundColor;if(aG==null){aG=O.grid.backgroundColor;if(aG&&typeof aG=="string"){aG=c.color.parse(aG)}else{aG=c.color.extract(aK,"background-color")}aG.a=1;aG=aG.toString()}var aB=aK.children();c('<div style="position:absolute;width:'+aB.width()+"px;height:"+aB.height()+"px;"+aI+"background-color:"+aG+';"> </div>').prependTo(aK).css("opacity",O.legend.backgroundOpacity)}}}var ab=[],M=null;function K(aI,aG,aD){var aO=O.grid.mouseActiveRadius,a0=aO*aO+1,aY=null,aR=false,aW,aU;for(aW=Q.length-1;aW>=0;--aW){if(!aD(Q[aW])){continue}var aP=Q[aW],aH=aP.xaxis,aF=aP.yaxis,aV=aP.datapoints.points,aT=aP.datapoints.pointsize,aQ=aH.c2p(aI),aN=aF.c2p(aG),aC=aO/aH.scale,aB=aO/aF.scale;if(aH.options.inverseTransform){aC=Number.MAX_VALUE}if(aF.options.inverseTransform){aB=Number.MAX_VALUE}if(aP.lines.show||aP.points.show){for(aU=0;aU<aV.length;aU+=aT){var aK=aV[aU],aJ=aV[aU+1];if(aK==null){continue}if(aK-aQ>aC||aK-aQ<-aC||aJ-aN>aB||aJ-aN<-aB){continue}var aM=Math.abs(aH.p2c(aK)-aI),aL=Math.abs(aF.p2c(aJ)-aG),aS=aM*aM+aL*aL;if(aS<a0){a0=aS;aY=[aW,aU/aT]}}}if(aP.bars.show&&!aY){var aE=aP.bars.align=="left"?0:-aP.bars.barWidth/2,aX=aE+aP.bars.barWidth;for(aU=0;aU<aV.length;aU+=aT){var aK=aV[aU],aJ=aV[aU+1],aZ=aV[aU+2];if(aK==null){continue}if(Q[aW].bars.horizontal?(aQ<=Math.max(aZ,aK)&&aQ>=Math.min(aZ,aK)&&aN>=aJ+aE&&aN<=aJ+aX):(aQ>=aK+aE&&aQ<=aK+aX&&aN>=Math.min(aZ,aJ)&&aN<=Math.max(aZ,aJ))){aY=[aW,aU/aT]}}}}if(aY){aW=aY[0];aU=aY[1];aT=Q[aW].datapoints.pointsize;return{datapoint:Q[aW].datapoints.points.slice(aU*aT,(aU+1)*aT),dataIndex:aU,series:Q[aW],seriesIndex:aW}}return null}function aa(aB){if(O.grid.hoverable){u("plothover",aB,function(aC){return aC.hoverable!=false})}}function l(aB){if(O.grid.hoverable){u("plothover",aB,function(aC){return false})}}function R(aB){u("plotclick",aB,function(aC){return aC.clickable!=false})}function u(aC,aB,aD){var aE=y.offset(),aH=aB.pageX-aE.left-q.left,aF=aB.pageY-aE.top-q.top,aJ=C({left:aH,top:aF});aJ.pageX=aB.pageX;aJ.pageY=aB.pageY;var aK=K(aH,aF,aD);if(aK){aK.pageX=parseInt(aK.series.xaxis.p2c(aK.datapoint[0])+aE.left+q.left);aK.pageY=parseInt(aK.series.yaxis.p2c(aK.datapoint[1])+aE.top+q.top)}if(O.grid.autoHighlight){for(var aG=0;aG<ab.length;++aG){var aI=ab[aG];if(aI.auto==aC&&!(aK&&aI.series==aK.series&&aI.point[0]==aK.datapoint[0]&&aI.point[1]==aK.datapoint[1])){T(aI.series,aI.point)}}if(aK){x(aK.series,aK.datapoint,aC)}}av.trigger(aC,[aJ,aK])}function f(){if(!M){M=setTimeout(s,30)}}function s(){M=null;A.save();A.clearRect(0,0,G,I);A.translate(q.left,q.top);var aC,aB;for(aC=0;aC<ab.length;++aC){aB=ab[aC];if(aB.series.bars.show){v(aB.series,aB.point)}else{ay(aB.series,aB.point)}}A.restore();an(ak.drawOverlay,[A])}function x(aD,aB,aF){if(typeof aD=="number"){aD=Q[aD]}if(typeof aB=="number"){var aE=aD.datapoints.pointsize;aB=aD.datapoints.points.slice(aE*aB,aE*(aB+1))}var aC=al(aD,aB);if(aC==-1){ab.push({series:aD,point:aB,auto:aF});f()}else{if(!aF){ab[aC].auto=false}}}function T(aD,aB){if(aD==null&&aB==null){ab=[];f()}if(typeof aD=="number"){aD=Q[aD]}if(typeof aB=="number"){aB=aD.data[aB]}var aC=al(aD,aB);if(aC!=-1){ab.splice(aC,1);f()}}function al(aD,aE){for(var aB=0;aB<ab.length;++aB){var aC=ab[aB];if(aC.series==aD&&aC.point[0]==aE[0]&&aC.point[1]==aE[1]){return aB}}return-1}function ay(aE,aD){var aC=aD[0],aI=aD[1],aH=aE.xaxis,aG=aE.yaxis;if(aC<aH.min||aC>aH.max||aI<aG.min||aI>aG.max){return}var aF=aE.points.radius+aE.points.lineWidth/2;A.lineWidth=aF;A.strokeStyle=c.color.parse(aE.color).scale("a",0.5).toString();var aB=1.5*aF,aC=aH.p2c(aC),aI=aG.p2c(aI);A.beginPath();if(aE.points.symbol=="circle"){A.arc(aC,aI,aB,0,2*Math.PI,false)}else{aE.points.symbol(A,aC,aI,aB,false)}A.closePath();A.stroke()}function v(aE,aB){A.lineWidth=aE.bars.lineWidth;A.strokeStyle=c.color.parse(aE.color).scale("a",0.5).toString();var aD=c.color.parse(aE.color).scale("a",0.5).toString();var aC=aE.bars.align=="left"?0:-aE.bars.barWidth/2;E(aB[0],aB[1],aB[2]||0,aC,aC+aE.bars.barWidth,0,function(){return aD},aE.xaxis,aE.yaxis,A,aE.bars.horizontal,aE.bars.lineWidth)}function am(aJ,aB,aH,aC){if(typeof aJ=="string"){return aJ}else{var aI=H.createLinearGradient(0,aH,0,aB);for(var aE=0,aD=aJ.colors.length;aE<aD;++aE){var aF=aJ.colors[aE];if(typeof aF!="string"){var aG=c.color.parse(aC);if(aF.brightness!=null){aG=aG.scale("rgb",aF.brightness)}if(aF.opacity!=null){aG.a*=aF.opacity}aF=aG.toString()}aI.addColorStop(aE/(aD-1),aF)}return aI}}}c.plot=function(g,e,d){var f=new b(c(g),e,d,c.plot.plugins);return f};c.plot.version="0.7";c.plot.plugins=[];c.plot.formatDate=function(l,f,h){var o=function(d){d=""+d;return d.length==1?"0"+d:d};var e=[];var p=false,j=false;var n=l.getUTCHours();var k=n<12;if(h==null){h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}if(f.search(/%p|%P/)!=-1){if(n>12){n=n-12}else{if(n==0){n=12}}}for(var g=0;g<f.length;++g){var m=f.charAt(g);if(p){switch(m){case"h":m=""+n;break;case"H":m=o(n);break;case"M":m=o(l.getUTCMinutes());break;case"S":m=o(l.getUTCSeconds());break;case"d":m=""+l.getUTCDate();break;case"m":m=""+(l.getUTCMonth()+1);break;case"y":m=""+l.getUTCFullYear();break;case"b":m=""+h[l.getUTCMonth()];break;case"p":m=(k)?("am"):("pm");break;case"P":m=(k)?("AM"):("PM");break;case"0":m="";j=true;break}if(m&&j){m=o(m);j=false}e.push(m);if(!j){p=false}}else{if(m=="%"){p=true}else{e.push(m)}}}return e.join("")};function a(e,d){return d*Math.floor(e/d)}})(jQuery);(function(b){function c(D){var h=null;var L=null;var n=null;var B=null;var p=null;var M=0;var F=true;var o=10;var w=0.95;var A=0;var d=false;var z=false;var j=[];D.hooks.processOptions.push(g);D.hooks.bindEvents.push(e);function g(O,N){if(N.series.pie.show){N.grid.show=false;if(N.series.pie.label.show=="auto"){if(N.legend.show){N.series.pie.label.show=false}else{N.series.pie.label.show=true}}if(N.series.pie.radius=="auto"){if(N.series.pie.label.show){N.series.pie.radius=3/4}else{N.series.pie.radius=1}}if(N.series.pie.tilt>1){N.series.pie.tilt=1}if(N.series.pie.tilt<0){N.series.pie.tilt=0}O.hooks.processDatapoints.push(E);O.hooks.drawOverlay.push(H);O.hooks.draw.push(r)}}function e(P,N){var O=P.getOptions();if(O.series.pie.show&&O.grid.hoverable){N.unbind("mousemove").mousemove(t)}if(O.series.pie.show&&O.grid.clickable){N.unbind("click").click(l)}}function G(O){var P="";function N(S,T){if(!T){T=0}for(var R=0;R<S.length;++R){for(var Q=0;Q<T;Q++){P+="\t"}if(typeof S[R]=="object"){P+=""+R+":\n";N(S[R],T+1)}else{P+=""+R+": "+S[R]+"\n"}}}N(O);alert(P)}function q(P){for(var N=0;N<P.length;++N){var O=parseFloat(P[N].data[0][1]);if(O){M+=O}}}function E(Q,N,O,P){if(!d){d=true;h=Q.getCanvas();L=b(h).parent();a=Q.getOptions();Q.setData(K(Q.getData()))}}function I(){A=L.children().filter(".legend").children().width();n=Math.min(h.width,(h.height/a.series.pie.tilt))/2;p=(h.height/2)+a.series.pie.offset.top;B=(h.width/2);if(a.series.pie.offset.left=="auto"){if(a.legend.position.match("w")){B+=A/2}else{B-=A/2}}else{B+=a.series.pie.offset.left}if(B<n){B=n}else{if(B>h.width-n){B=h.width-n}}}function v(O){for(var N=0;N<O.length;++N){if(typeof(O[N].data)=="number"){O[N].data=[[1,O[N].data]]}else{if(typeof(O[N].data)=="undefined"||typeof(O[N].data[0])=="undefined"){if(typeof(O[N].data)!="undefined"&&typeof(O[N].data.label)!="undefined"){O[N].label=O[N].data.label}O[N].data=[[1,0]]}}}return O}function K(Q){Q=v(Q);q(Q);var P=0;var S=0;var N=a.series.pie.combine.color;var R=[];for(var O=0;O<Q.length;++O){Q[O].data[0][1]=parseFloat(Q[O].data[0][1]);if(!Q[O].data[0][1]){Q[O].data[0][1]=0}if(Q[O].data[0][1]/M<=a.series.pie.combine.threshold){P+=Q[O].data[0][1];S++;if(!N){N=Q[O].color}}else{R.push({data:[[1,Q[O].data[0][1]]],color:Q[O].color,label:Q[O].label,angle:(Q[O].data[0][1]*(Math.PI*2))/M,percent:(Q[O].data[0][1]/M*100)})}}if(S>0){R.push({data:[[1,P]],color:N,label:a.series.pie.combine.label,angle:(P*(Math.PI*2))/M,percent:(P/M*100)})}return R}function r(S,Q){if(!L){return}ctx=Q;I();var T=S.getData();var P=0;while(F&&P<o){F=false;if(P>0){n*=w}P+=1;N();if(a.series.pie.tilt<=0.8){O()}R()}if(P>=o){N();L.prepend('<div class="error">Could not draw pie with labels contained inside canvas</div>')}if(S.setSeries&&S.insertLegend){S.setSeries(T);S.insertLegend()}function N(){ctx.clearRect(0,0,h.width,h.height);L.children().filter(".pieLabel, .pieLabelBackground").remove()}function O(){var Z=5;var Y=15;var W=10;var X=0.02;if(a.series.pie.radius>1){var U=a.series.pie.radius}else{var U=n*a.series.pie.radius}if(U>=(h.width/2)-Z||U*a.series.pie.tilt>=(h.height/2)-Y||U<=W){return}ctx.save();ctx.translate(Z,Y);ctx.globalAlpha=X;ctx.fillStyle="#000";ctx.translate(B,p);ctx.scale(1,a.series.pie.tilt);for(var V=1;V<=W;V++){ctx.beginPath();ctx.arc(0,0,U,0,Math.PI*2,false);ctx.fill();U-=V}ctx.restore()}function R(){startAngle=Math.PI*a.series.pie.startAngle;if(a.series.pie.radius>1){var U=a.series.pie.radius}else{var U=n*a.series.pie.radius}ctx.save();ctx.translate(B,p);ctx.scale(1,a.series.pie.tilt);ctx.save();var Y=startAngle;for(var W=0;W<T.length;++W){T[W].startAngle=Y;X(T[W].angle,T[W].color,true)}ctx.restore();ctx.save();ctx.lineWidth=a.series.pie.stroke.width;Y=startAngle;for(var W=0;W<T.length;++W){X(T[W].angle,a.series.pie.stroke.color,false)}ctx.restore();J(ctx);if(a.series.pie.label.show){V()}ctx.restore();function X(ab,Z,aa){if(ab<=0){return}if(aa){ctx.fillStyle=Z}else{ctx.strokeStyle=Z;ctx.lineJoin="round"}ctx.beginPath();if(Math.abs(ab-Math.PI*2)>1e-9){ctx.moveTo(0,0)}else{if(b.browser.msie){ab-=0.0001}}ctx.arc(0,0,U,Y,Y+ab,false);ctx.closePath();Y+=ab;if(aa){ctx.fill()}else{ctx.stroke()}}function V(){var ac=startAngle;if(a.series.pie.label.radius>1){var Z=a.series.pie.label.radius}else{var Z=n*a.series.pie.label.radius}for(var ab=0;ab<T.length;++ab){if(T[ab].percent>=a.series.pie.label.threshold*100){aa(T[ab],ac,ab)}ac+=T[ab].angle}function aa(ap,ai,ag){if(ap.data[0][1]==0){return}var ar=a.legend.labelFormatter,aq,ae=a.series.pie.label.formatter;if(ar){aq=ar(ap.label,ap)}else{aq=ap.label}if(ae){aq=ae(aq,ap)}var aj=((ai+ap.angle)+ai)/2;var ao=B+Math.round(Math.cos(aj)*Z);var am=p+Math.round(Math.sin(aj)*Z)*a.series.pie.tilt;var af='<span class="pieLabel" id="pieLabel'+ag+'" style="position:absolute;top:'+am+"px;left:"+ao+'px;">'+aq+"</span>";L.append(af);var an=L.children("#pieLabel"+ag);var ad=(am-an.height()/2);var ah=(ao-an.width()/2);an.css("top",ad);an.css("left",ah);if(0-ad>0||0-ah>0||h.height-(ad+an.height())<0||h.width-(ah+an.width())<0){F=true}if(a.series.pie.label.background.opacity!=0){var ak=a.series.pie.label.background.color;if(ak==null){ak=ap.color}var al="top:"+ad+"px;left:"+ah+"px;";b('<div class="pieLabelBackground" style="position:absolute;width:'+an.width()+"px;height:"+an.height()+"px;"+al+"background-color:"+ak+';"> </div>').insertBefore(an).css("opacity",a.series.pie.label.background.opacity)}}}}}function J(N){if(a.series.pie.innerRadius>0){N.save();innerRadius=a.series.pie.innerRadius>1?a.series.pie.innerRadius:n*a.series.pie.innerRadius;N.globalCompositeOperation="destination-out";N.beginPath();N.fillStyle=a.series.pie.stroke.color;N.arc(0,0,innerRadius,0,Math.PI*2,false);N.fill();N.closePath();N.restore();N.save();N.beginPath();N.strokeStyle=a.series.pie.stroke.color;N.arc(0,0,innerRadius,0,Math.PI*2,false);N.stroke();N.closePath();N.restore()}}function s(Q,R){for(var S=false,P=-1,N=Q.length,O=N-1;++P<N;O=P){((Q[P][1]<=R[1]&&R[1]<Q[O][1])||(Q[O][1]<=R[1]&&R[1]<Q[P][1]))&&(R[0]<(Q[O][0]-Q[P][0])*(R[1]-Q[P][1])/(Q[O][1]-Q[P][1])+Q[P][0])&&(S=!S)}return S}function u(R,P){var T=D.getData(),O=D.getOptions(),N=O.series.pie.radius>1?O.series.pie.radius:n*O.series.pie.radius;for(var Q=0;Q<T.length;++Q){var S=T[Q];if(S.pie.show){ctx.save();ctx.beginPath();ctx.moveTo(0,0);ctx.arc(0,0,N,S.startAngle,S.startAngle+S.angle,false);ctx.closePath();x=R-B;y=P-p;if(ctx.isPointInPath){if(ctx.isPointInPath(R-B,P-p)){ctx.restore();return{datapoint:[S.percent,S.data],dataIndex:0,series:S,seriesIndex:Q}}}else{p1X=(N*Math.cos(S.startAngle));p1Y=(N*Math.sin(S.startAngle));p2X=(N*Math.cos(S.startAngle+(S.angle/4)));p2Y=(N*Math.sin(S.startAngle+(S.angle/4)));p3X=(N*Math.cos(S.startAngle+(S.angle/2)));p3Y=(N*Math.sin(S.startAngle+(S.angle/2)));p4X=(N*Math.cos(S.startAngle+(S.angle/1.5)));p4Y=(N*Math.sin(S.startAngle+(S.angle/1.5)));p5X=(N*Math.cos(S.startAngle+S.angle));p5Y=(N*Math.sin(S.startAngle+S.angle));arrPoly=[[0,0],[p1X,p1Y],[p2X,p2Y],[p3X,p3Y],[p4X,p4Y],[p5X,p5Y]];arrPoint=[x,y];if(s(arrPoly,arrPoint)){ctx.restore();return{datapoint:[S.percent,S.data],dataIndex:0,series:S,seriesIndex:Q}}}ctx.restore()}}return null}function t(N){m("plothover",N)}function l(N){m("plotclick",N)}function m(N,T){var O=D.offset(),R=parseInt(T.pageX-O.left),P=parseInt(T.pageY-O.top),V=u(R,P);if(a.grid.autoHighlight){for(var Q=0;Q<j.length;++Q){var S=j[Q];if(S.auto==N&&!(V&&S.series==V.series)){f(S.series)}}}if(V){k(V.series,N)}var U={pageX:T.pageX,pageY:T.pageY};L.trigger(N,[U,V])}function k(O,P){if(typeof O=="number"){O=series[O]}var N=C(O);if(N==-1){j.push({series:O,auto:P});D.triggerRedrawOverlay()}else{if(!P){j[N].auto=false}}}function f(O){if(O==null){j=[];D.triggerRedrawOverlay()}if(typeof O=="number"){O=series[O]}var N=C(O);if(N!=-1){j.splice(N,1);D.triggerRedrawOverlay()}}function C(P){for(var N=0;N<j.length;++N){var O=j[N];if(O.series==P){return N}}return-1}function H(Q,R){var P=Q.getOptions();var N=P.series.pie.radius>1?P.series.pie.radius:n*P.series.pie.radius;R.save();R.translate(B,p);R.scale(1,P.series.pie.tilt);for(i=0;i<j.length;++i){O(j[i].series)}J(R);R.restore();function O(S){if(S.angle<0){return}R.fillStyle="rgba(255, 255, 255, "+P.series.pie.highlight.opacity+")";R.beginPath();if(Math.abs(S.angle-Math.PI*2)>1e-9){R.moveTo(0,0)}R.arc(0,0,N,S.startAngle,S.startAngle+S.angle,false);R.closePath();R.fill()}}}var a={series:{pie:{show:false,radius:"auto",innerRadius:0,startAngle:3/2,tilt:1,offset:{top:0,left:"auto"},stroke:{color:"#FFF",width:1},label:{show:"auto",formatter:function(d,e){return'<div style="font-size:x-small;text-align:center;padding:2px;color:'+e.color+';">'+d+"<br/>"+Math.round(e.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:0.5}}}};b.plot.plugins.push({init:c,options:a,name:"pie",version:"1.0"})})(jQuery);(function(b){var a={series:{stack:null}};function c(f){function d(k,j){var h=null;for(var g=0;g<j.length;++g){if(k==j[g]){break}if(j[g].stack==k.stack){h=j[g]}}return h}function e(C,v,g){if(v.stack==null){return}var p=d(v,C.getData());if(!p){return}var z=g.pointsize,F=g.points,h=p.datapoints.pointsize,y=p.datapoints.points,t=[],x,w,k,J,I,r,u=v.lines.show,G=v.bars.horizontal,o=z>2&&(G?g.format[2].x:g.format[2].y),n=u&&v.lines.steps,E=true,q=G?1:0,H=G?0:1,D=0,B=0,A;while(true){if(D>=F.length){break}A=t.length;if(F[D]==null){for(m=0;m<z;++m){t.push(F[D+m])}D+=z}else{if(B>=y.length){if(!u){for(m=0;m<z;++m){t.push(F[D+m])}}D+=z}else{if(y[B]==null){for(m=0;m<z;++m){t.push(null)}E=true;B+=h}else{x=F[D+q];w=F[D+H];J=y[B+q];I=y[B+H];r=0;if(x==J){for(m=0;m<z;++m){t.push(F[D+m])}t[A+H]+=I;r=I;D+=z;B+=h}else{if(x>J){if(u&&D>0&&F[D-z]!=null){k=w+(F[D-z+H]-w)*(J-x)/(F[D-z+q]-x);t.push(J);t.push(k+I);for(m=2;m<z;++m){t.push(F[D+m])}r=I}B+=h}else{if(E&&u){D+=z;continue}for(m=0;m<z;++m){t.push(F[D+m])}if(u&&B>0&&y[B-h]!=null){r=I+(y[B-h+H]-I)*(x-J)/(y[B-h+q]-J)}t[A+H]+=r;D+=z}}E=false;if(A!=t.length&&o){t[A+2]+=r}}}}if(n&&A!=t.length&&A>0&&t[A]!=null&&t[A]!=t[A-z]&&t[A+1]!=t[A-z+1]){for(m=0;m<z;++m){t[A+z+m]=t[A+m]}t[A+1]=t[A-z+1]}}g.points=t}f.hooks.processDatapoints.push(e)}b.plot.plugins.push({init:c,options:a,name:"stack",version:"1.2"})})(jQuery);(function($){function init(h){var k;var l;var m;var n;var o=1;function reOrderBars(a,b,c){var d=null;if(serieNeedToBeReordered(b)){calculPixel2XWidthConvert(a);retrieveBarSeries(a);calculBorderAndBarWidth(b);if(l>=2){var e=findPosition(b);var f=0;var g=calculCenterBarShift();if(isBarAtLeftOfCenter(e)){f=-1*(sumWidth(k,e-1,Math.floor(l/2)-1))-g}else{f=sumWidth(k,Math.ceil(l/2),e-2)+g}d=shiftPoints(c,b,f);c.points=d}}return d}function serieNeedToBeReordered(a){return a.bars!=null&&a.bars.show&&a.bars.order!=null}function calculPixel2XWidthConvert(a){var b=a.getPlaceholder().innerWidth();var c=getXabsMinMaxValues(a.getData());var d=c[1]-c[0];o=d/b}function getXabsMinMaxValues(a){var b=new Array();for(var i=0;i<a.length;i++){b[0]=a[i].data[0][0];b[1]=a[i].data[a[i].data.length-1][0]}return b}function retrieveBarSeries(a){k=findOthersBarsToReOrders(a.getData());l=k.length}function findOthersBarsToReOrders(a){var b=new Array();for(var i=0;i<a.length;i++){if(a[i].bars.order!=null&&a[i].bars.show){b.push(a[i])}}return b.sort(sortByOrder)}function sortByOrder(a,b){var x=a.bars.order;var y=b.bars.order;return((x<y)?-1:((x>y)?1:0))}function calculBorderAndBarWidth(a){m=a.bars.lineWidth?a.bars.lineWidth:2;n=m*o}function findPosition(a){var b=0;for(var i=0;i<k.length;++i){if(a==k[i]){b=i;break}}return b+1}function calculCenterBarShift(){var a=0;if(l%2!=0)a=(k[Math.ceil(l/2)].bars.barWidth)/2;return a}function isBarAtLeftOfCenter(a){return a<=Math.ceil(l/2)}function sumWidth(a,b,c){var d=0;for(var i=b;i<=c;i++){d+=a[i].bars.barWidth+n*2}return d}function shiftPoints(a,b,c){var d=a.pointsize;var e=a.points;var j=0;for(var i=0;i<e.length;i+=d){e[i]+=c;b.data[j][3]=e[i];j++}return e}h.hooks.processDatapoints.push(reOrderBars)}var options={series:{bars:{order:null}}};$.plot.plugins.push({init:init,options:options,name:"orderBars",version:"0.2"})})(jQuery);if(!document.createElement("canvas").getContext){(function(){var z=Math;var K=z.round;var J=z.sin;var U=z.cos;var b=z.abs;var k=z.sqrt;var D=10;var F=D/2;function T(){return this.context_||(this.context_=new W(this))}var O=Array.prototype.slice;function G(i,j,m){var Z=O.call(arguments,2);return function(){return i.apply(j,Z.concat(O.call(arguments)))}}function AD(Z){return String(Z).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function r(i){if(!i.namespaces.g_vml_){i.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML")}if(!i.namespaces.g_o_){i.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML")}if(!i.styleSheets.ex_canvas_){var Z=i.createStyleSheet();Z.owningElement.id="ex_canvas_";Z.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}"}}r(document);var E={init:function(Z){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var i=Z||document;i.createElement("canvas");i.attachEvent("onreadystatechange",G(this.init_,this,i))}},init_:function(m){var j=m.getElementsByTagName("canvas");for(var Z=0;Z<j.length;Z++){this.initElement(j[Z])}},initElement:function(i){if(!i.getContext){i.getContext=T;r(i.ownerDocument);i.innerHTML="";i.attachEvent("onpropertychange",S);i.attachEvent("onresize",w);var Z=i.attributes;if(Z.width&&Z.width.specified){i.style.width=Z.width.nodeValue+"px"}else{i.width=i.clientWidth}if(Z.height&&Z.height.specified){i.style.height=Z.height.nodeValue+"px"}else{i.height=i.clientHeight}}return i}};function S(i){var Z=i.srcElement;switch(i.propertyName){case"width":Z.getContext().clearRect();Z.style.width=Z.attributes.width.nodeValue+"px";Z.firstChild.style.width=Z.clientWidth+"px";break;case"height":Z.getContext().clearRect();Z.style.height=Z.attributes.height.nodeValue+"px";Z.firstChild.style.height=Z.clientHeight+"px";break}}function w(i){var Z=i.srcElement;if(Z.firstChild){Z.firstChild.style.width=Z.clientWidth+"px";Z.firstChild.style.height=Z.clientHeight+"px"}}E.init();var I=[];for(var AC=0;AC<16;AC++){for(var AB=0;AB<16;AB++){I[AC*16+AB]=AC.toString(16)+AB.toString(16)}}function V(){return[[1,0,0],[0,1,0],[0,0,1]]}function d(m,j){var i=V();for(var Z=0;Z<3;Z++){for(var AF=0;AF<3;AF++){var p=0;for(var AE=0;AE<3;AE++){p+=m[Z][AE]*j[AE][AF]}i[Z][AF]=p}}return i}function Q(i,Z){Z.fillStyle=i.fillStyle;Z.lineCap=i.lineCap;Z.lineJoin=i.lineJoin;Z.lineWidth=i.lineWidth;Z.miterLimit=i.miterLimit;Z.shadowBlur=i.shadowBlur;Z.shadowColor=i.shadowColor;Z.shadowOffsetX=i.shadowOffsetX;Z.shadowOffsetY=i.shadowOffsetY;Z.strokeStyle=i.strokeStyle;Z.globalAlpha=i.globalAlpha;Z.font=i.font;Z.textAlign=i.textAlign;Z.textBaseline=i.textBaseline;Z.arcScaleX_=i.arcScaleX_;Z.arcScaleY_=i.arcScaleY_;Z.lineScale_=i.lineScale_}var B={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",grey:"#808080",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",oldlace:"#FDF5E6",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",whitesmoke:"#F5F5F5",yellowgreen:"#9ACD32"};function g(i){var m=i.indexOf("(",3);var Z=i.indexOf(")",m+1);var j=i.substring(m+1,Z).split(",");if(j.length==4&&i.substr(3,1)=="a"){alpha=Number(j[3])}else{j[3]=1}return j}function C(Z){return parseFloat(Z)/100}function N(i,j,Z){return Math.min(Z,Math.max(j,i))}function c(AF){var j,i,Z;h=parseFloat(AF[0])/360%360;if(h<0){h++}s=N(C(AF[1]),0,1);l=N(C(AF[2]),0,1);if(s==0){j=i=Z=l}else{var m=l<0.5?l*(1+s):l+s-l*s;var AE=2*l-m;j=A(AE,m,h+1/3);i=A(AE,m,h);Z=A(AE,m,h-1/3)}return"#"+I[Math.floor(j*255)]+I[Math.floor(i*255)]+I[Math.floor(Z*255)]}function A(i,Z,j){if(j<0){j++}if(j>1){j--}if(6*j<1){return i+(Z-i)*6*j}else{if(2*j<1){return Z}else{if(3*j<2){return i+(Z-i)*(2/3-j)*6}else{return i}}}}function Y(Z){var AE,p=1;Z=String(Z);if(Z.charAt(0)=="#"){AE=Z}else{if(/^rgb/.test(Z)){var m=g(Z);var AE="#",AF;for(var j=0;j<3;j++){if(m[j].indexOf("%")!=-1){AF=Math.floor(C(m[j])*255)}else{AF=Number(m[j])}AE+=I[N(AF,0,255)]}p=m[3]}else{if(/^hsl/.test(Z)){var m=g(Z);AE=c(m);p=m[3]}else{AE=B[Z]||Z}}}return{color:AE,alpha:p}}var L={style:"normal",variant:"normal",weight:"normal",size:10,family:"sans-serif"};var f={};function X(Z){if(f[Z]){return f[Z]}var m=document.createElement("div");var j=m.style;try{j.font=Z}catch(i){}return f[Z]={style:j.fontStyle||L.style,variant:j.fontVariant||L.variant,weight:j.fontWeight||L.weight,size:j.fontSize||L.size,family:j.fontFamily||L.family}}function P(j,i){var Z={};for(var AF in j){Z[AF]=j[AF]}var AE=parseFloat(i.currentStyle.fontSize),m=parseFloat(j.size);if(typeof j.size=="number"){Z.size=j.size}else{if(j.size.indexOf("px")!=-1){Z.size=m}else{if(j.size.indexOf("em")!=-1){Z.size=AE*m}else{if(j.size.indexOf("%")!=-1){Z.size=(AE/100)*m}else{if(j.size.indexOf("pt")!=-1){Z.size=m/0.75}else{Z.size=AE}}}}}Z.size*=0.981;return Z}function AA(Z){return Z.style+" "+Z.variant+" "+Z.weight+" "+Z.size+"px "+Z.family}function t(Z){switch(Z){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function W(i){this.m_=V();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.strokeStyle="#000";this.fillStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=D*1;this.globalAlpha=1;this.font="10px sans-serif";this.textAlign="left";this.textBaseline="alphabetic";this.canvas=i;var Z=i.ownerDocument.createElement("div");Z.style.width=i.clientWidth+"px";Z.style.height=i.clientHeight+"px";Z.style.overflow="hidden";Z.style.position="absolute";i.appendChild(Z);this.element_=Z;this.arcScaleX_=1;this.arcScaleY_=1;this.lineScale_=1}var M=W.prototype;M.clearRect=function(){if(this.textMeasureEl_){this.textMeasureEl_.removeNode(true);this.textMeasureEl_=null}this.element_.innerHTML=""};M.beginPath=function(){this.currentPath_=[]};M.moveTo=function(i,Z){var j=this.getCoords_(i,Z);this.currentPath_.push({type:"moveTo",x:j.x,y:j.y});this.currentX_=j.x;this.currentY_=j.y};M.lineTo=function(i,Z){var j=this.getCoords_(i,Z);this.currentPath_.push({type:"lineTo",x:j.x,y:j.y});this.currentX_=j.x;this.currentY_=j.y};M.bezierCurveTo=function(j,i,AI,AH,AG,AE){var Z=this.getCoords_(AG,AE);var AF=this.getCoords_(j,i);var m=this.getCoords_(AI,AH);e(this,AF,m,Z)};function e(Z,m,j,i){Z.currentPath_.push({type:"bezierCurveTo",cp1x:m.x,cp1y:m.y,cp2x:j.x,cp2y:j.y,x:i.x,y:i.y});Z.currentX_=i.x;Z.currentY_=i.y}M.quadraticCurveTo=function(AG,j,i,Z){var AF=this.getCoords_(AG,j);var AE=this.getCoords_(i,Z);var AH={x:this.currentX_+2/3*(AF.x-this.currentX_),y:this.currentY_+2/3*(AF.y-this.currentY_)};var m={x:AH.x+(AE.x-this.currentX_)/3,y:AH.y+(AE.y-this.currentY_)/3};e(this,AH,m,AE)};M.arc=function(AJ,AH,AI,AE,i,j){AI*=D;var AN=j?"at":"wa";var AK=AJ+U(AE)*AI-F;var AM=AH+J(AE)*AI-F;var Z=AJ+U(i)*AI-F;var AL=AH+J(i)*AI-F;if(AK==Z&&!j){AK+=0.125}var m=this.getCoords_(AJ,AH);var AG=this.getCoords_(AK,AM);var AF=this.getCoords_(Z,AL);this.currentPath_.push({type:AN,x:m.x,y:m.y,radius:AI,xStart:AG.x,yStart:AG.y,xEnd:AF.x,yEnd:AF.y})};M.rect=function(j,i,Z,m){this.moveTo(j,i);this.lineTo(j+Z,i);this.lineTo(j+Z,i+m);this.lineTo(j,i+m);this.closePath()};M.strokeRect=function(j,i,Z,m){var p=this.currentPath_;this.beginPath();this.moveTo(j,i);this.lineTo(j+Z,i);this.lineTo(j+Z,i+m);this.lineTo(j,i+m);this.closePath();this.stroke();this.currentPath_=p};M.fillRect=function(j,i,Z,m){var p=this.currentPath_;this.beginPath();this.moveTo(j,i);this.lineTo(j+Z,i);this.lineTo(j+Z,i+m);this.lineTo(j,i+m);this.closePath();this.fill();this.currentPath_=p};M.createLinearGradient=function(i,m,Z,j){var p=new v("gradient");p.x0_=i;p.y0_=m;p.x1_=Z;p.y1_=j;return p};M.createRadialGradient=function(m,AE,j,i,p,Z){var AF=new v("gradientradial");AF.x0_=m;AF.y0_=AE;AF.r0_=j;AF.x1_=i;AF.y1_=p;AF.r1_=Z;return AF};M.drawImage=function(AO,j){var AH,AF,AJ,AV,AM,AK,AQ,AX;var AI=AO.runtimeStyle.width;var AN=AO.runtimeStyle.height;AO.runtimeStyle.width="auto";AO.runtimeStyle.height="auto";var AG=AO.width;var AT=AO.height;AO.runtimeStyle.width=AI;AO.runtimeStyle.height=AN;if(arguments.length==3){AH=arguments[1];AF=arguments[2];AM=AK=0;AQ=AJ=AG;AX=AV=AT}else{if(arguments.length==5){AH=arguments[1];AF=arguments[2];AJ=arguments[3];AV=arguments[4];AM=AK=0;AQ=AG;AX=AT}else{if(arguments.length==9){AM=arguments[1];AK=arguments[2];AQ=arguments[3];AX=arguments[4];AH=arguments[5];AF=arguments[6];AJ=arguments[7];AV=arguments[8]}else{throw Error("Invalid number of arguments")}}}var AW=this.getCoords_(AH,AF);var m=AQ/2;var i=AX/2;var AU=[];var Z=10;var AE=10;AU.push(" <g_vml_:group",' coordsize="',D*Z,",",D*AE,'"',' coordorigin="0,0"',' style="width:',Z,"px;height:",AE,"px;position:absolute;");if(this.m_[0][0]!=1||this.m_[0][1]||this.m_[1][1]!=1||this.m_[1][0]){var p=[];p.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",K(AW.x/D),",","Dy=",K(AW.y/D),"");var AS=AW;var AR=this.getCoords_(AH+AJ,AF);var AP=this.getCoords_(AH,AF+AV);var AL=this.getCoords_(AH+AJ,AF+AV);AS.x=z.max(AS.x,AR.x,AP.x,AL.x);AS.y=z.max(AS.y,AR.y,AP.y,AL.y);AU.push("padding:0 ",K(AS.x/D),"px ",K(AS.y/D),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",p.join(""),", sizingmethod='clip');")}else{AU.push("top:",K(AW.y/D),"px;left:",K(AW.x/D),"px;")}AU.push(' ">','<g_vml_:image src="',AO.src,'"',' style="width:',D*AJ,"px;"," height:",D*AV,'px"',' cropleft="',AM/AG,'"',' croptop="',AK/AT,'"',' cropright="',(AG-AM-AQ)/AG,'"',' cropbottom="',(AT-AK-AX)/AT,'"'," />","</g_vml_:group>");this.element_.insertAdjacentHTML("BeforeEnd",AU.join(""))};M.stroke=function(AM){var m=10;var AN=10;var AE=5000;var AG={x:null,y:null};var AL={x:null,y:null};for(var AH=0;AH<this.currentPath_.length;AH+=AE){var AK=[];var AF=false;AK.push("<g_vml_:shape",' filled="',!!AM,'"',' style="position:absolute;width:',m,"px;height:",AN,'px;"',' coordorigin="0,0"',' coordsize="',D*m,",",D*AN,'"',' stroked="',!AM,'"',' path="');var AO=false;for(var AI=AH;AI<Math.min(AH+AE,this.currentPath_.length);AI++){if(AI%AE==0&&AI>0){AK.push(" m ",K(this.currentPath_[AI-1].x),",",K(this.currentPath_[AI-1].y))}var Z=this.currentPath_[AI];var AJ;switch(Z.type){case"moveTo":AJ=Z;AK.push(" m ",K(Z.x),",",K(Z.y));break;case"lineTo":AK.push(" l ",K(Z.x),",",K(Z.y));break;case"close":AK.push(" x ");Z=null;break;case"bezierCurveTo":AK.push(" c ",K(Z.cp1x),",",K(Z.cp1y),",",K(Z.cp2x),",",K(Z.cp2y),",",K(Z.x),",",K(Z.y));break;case"at":case"wa":AK.push(" ",Z.type," ",K(Z.x-this.arcScaleX_*Z.radius),",",K(Z.y-this.arcScaleY_*Z.radius)," ",K(Z.x+this.arcScaleX_*Z.radius),",",K(Z.y+this.arcScaleY_*Z.radius)," ",K(Z.xStart),",",K(Z.yStart)," ",K(Z.xEnd),",",K(Z.yEnd));break}if(Z){if(AG.x==null||Z.x<AG.x){AG.x=Z.x}if(AL.x==null||Z.x>AL.x){AL.x=Z.x}if(AG.y==null||Z.y<AG.y){AG.y=Z.y}if(AL.y==null||Z.y>AL.y){AL.y=Z.y}}}AK.push(' ">');if(!AM){R(this,AK)}else{a(this,AK,AG,AL)}AK.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",AK.join(""))}};function R(j,AE){var i=Y(j.strokeStyle);var m=i.color;var p=i.alpha*j.globalAlpha;var Z=j.lineScale_*j.lineWidth;if(Z<1){p*=Z}AE.push("<g_vml_:stroke",' opacity="',p,'"',' joinstyle="',j.lineJoin,'"',' miterlimit="',j.miterLimit,'"',' endcap="',t(j.lineCap),'"',' weight="',Z,'px"',' color="',m,'" />')}function a(AO,AG,Ah,AP){var AH=AO.fillStyle;var AY=AO.arcScaleX_;var AX=AO.arcScaleY_;var Z=AP.x-Ah.x;var m=AP.y-Ah.y;if(AH instanceof v){var AL=0;var Ac={x:0,y:0};var AU=0;var AK=1;if(AH.type_=="gradient"){var AJ=AH.x0_/AY;var j=AH.y0_/AX;var AI=AH.x1_/AY;var Aj=AH.y1_/AX;var Ag=AO.getCoords_(AJ,j);var Af=AO.getCoords_(AI,Aj);var AE=Af.x-Ag.x;var p=Af.y-Ag.y;AL=Math.atan2(AE,p)*180/Math.PI;if(AL<0){AL+=360}if(AL<0.000001){AL=0}}else{var Ag=AO.getCoords_(AH.x0_,AH.y0_);Ac={x:(Ag.x-Ah.x)/Z,y:(Ag.y-Ah.y)/m};Z/=AY*D;m/=AX*D;var Aa=z.max(Z,m);AU=2*AH.r0_/Aa;AK=2*AH.r1_/Aa-AU}var AS=AH.colors_;AS.sort(function(Ak,i){return Ak.offset-i.offset});var AN=AS.length;var AR=AS[0].color;var AQ=AS[AN-1].color;var AW=AS[0].alpha*AO.globalAlpha;var AV=AS[AN-1].alpha*AO.globalAlpha;var Ab=[];for(var Ae=0;Ae<AN;Ae++){var AM=AS[Ae];Ab.push(AM.offset*AK+AU+" "+AM.color)}AG.push('<g_vml_:fill type="',AH.type_,'"',' method="none" focus="100%"',' color="',AR,'"',' color2="',AQ,'"',' colors="',Ab.join(","),'"',' opacity="',AV,'"',' g_o_:opacity2="',AW,'"',' angle="',AL,'"',' focusposition="',Ac.x,",",Ac.y,'" />')}else{if(AH instanceof u){if(Z&&m){var AF=-Ah.x;var AZ=-Ah.y;AG.push("<g_vml_:fill",' position="',AF/Z*AY*AY,",",AZ/m*AX*AX,'"',' type="tile"',' src="',AH.src_,'" />')}}else{var Ai=Y(AO.fillStyle);var AT=Ai.color;var Ad=Ai.alpha*AO.globalAlpha;AG.push('<g_vml_:fill color="',AT,'" opacity="',Ad,'" />')}}}M.fill=function(){this.stroke(true)};M.closePath=function(){this.currentPath_.push({type:"close"})};M.getCoords_=function(j,i){var Z=this.m_;return{x:D*(j*Z[0][0]+i*Z[1][0]+Z[2][0])-F,y:D*(j*Z[0][1]+i*Z[1][1]+Z[2][1])-F}};M.save=function(){var Z={};Q(this,Z);this.aStack_.push(Z);this.mStack_.push(this.m_);this.m_=d(V(),this.m_)};M.restore=function(){if(this.aStack_.length){Q(this.aStack_.pop(),this);this.m_=this.mStack_.pop()}};function H(Z){return isFinite(Z[0][0])&&isFinite(Z[0][1])&&isFinite(Z[1][0])&&isFinite(Z[1][1])&&isFinite(Z[2][0])&&isFinite(Z[2][1])}function y(i,Z,j){if(!H(Z)){return}i.m_=Z;if(j){var p=Z[0][0]*Z[1][1]-Z[0][1]*Z[1][0];i.lineScale_=k(b(p))}}M.translate=function(j,i){var Z=[[1,0,0],[0,1,0],[j,i,1]];y(this,d(Z,this.m_),false)};M.rotate=function(i){var m=U(i);var j=J(i);var Z=[[m,j,0],[-j,m,0],[0,0,1]];y(this,d(Z,this.m_),false)};M.scale=function(j,i){this.arcScaleX_*=j;this.arcScaleY_*=i;var Z=[[j,0,0],[0,i,0],[0,0,1]];y(this,d(Z,this.m_),true)};M.transform=function(p,m,AF,AE,i,Z){var j=[[p,m,0],[AF,AE,0],[i,Z,1]];y(this,d(j,this.m_),true)};M.setTransform=function(AE,p,AG,AF,j,i){var Z=[[AE,p,0],[AG,AF,0],[j,i,1]];y(this,Z,true)};M.drawText_=function(AK,AI,AH,AN,AG){var AM=this.m_,AQ=1000,i=0,AP=AQ,AF={x:0,y:0},AE=[];var Z=P(X(this.font),this.element_);var j=AA(Z);var AR=this.element_.currentStyle;var p=this.textAlign.toLowerCase();switch(p){case"left":case"center":case"right":break;case"end":p=AR.direction=="ltr"?"right":"left";break;case"start":p=AR.direction=="rtl"?"right":"left";break;default:p="left"}switch(this.textBaseline){case"hanging":case"top":AF.y=Z.size/1.75;break;case"middle":break;default:case null:case"alphabetic":case"ideographic":case"bottom":AF.y=-Z.size/2.25;break}switch(p){case"right":i=AQ;AP=0.05;break;case"center":i=AP=AQ/2;break}var AO=this.getCoords_(AI+AF.x,AH+AF.y);AE.push('<g_vml_:line from="',-i,' 0" to="',AP,' 0.05" ',' coordsize="100 100" coordorigin="0 0"',' filled="',!AG,'" stroked="',!!AG,'" style="position:absolute;width:1px;height:1px;">');if(AG){R(this,AE)}else{a(this,AE,{x:-i,y:0},{x:AP,y:Z.size})}var AL=AM[0][0].toFixed(3)+","+AM[1][0].toFixed(3)+","+AM[0][1].toFixed(3)+","+AM[1][1].toFixed(3)+",0,0";var AJ=K(AO.x/D)+","+K(AO.y/D);AE.push('<g_vml_:skew on="t" matrix="',AL,'" ',' offset="',AJ,'" origin="',i,' 0" />','<g_vml_:path textpathok="true" />','<g_vml_:textpath on="true" string="',AD(AK),'" style="v-text-align:',p,";font:",AD(j),'" /></g_vml_:line>');this.element_.insertAdjacentHTML("beforeEnd",AE.join(""))};M.fillText=function(j,Z,m,i){this.drawText_(j,Z,m,i,false)};M.strokeText=function(j,Z,m,i){this.drawText_(j,Z,m,i,true)};M.measureText=function(j){if(!this.textMeasureEl_){var Z='<span style="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;"></span>';this.element_.insertAdjacentHTML("beforeEnd",Z);this.textMeasureEl_=this.element_.lastChild}var i=this.element_.ownerDocument;this.textMeasureEl_.innerHTML="";this.textMeasureEl_.style.font=this.font;this.textMeasureEl_.appendChild(i.createTextNode(j));return{width:this.textMeasureEl_.offsetWidth}};M.clip=function(){};M.arcTo=function(){};M.createPattern=function(i,Z){return new u(i,Z)};function v(Z){this.type_=Z;this.x0_=0;this.y0_=0;this.r0_=0;this.x1_=0;this.y1_=0;this.r1_=0;this.colors_=[]}v.prototype.addColorStop=function(i,Z){Z=Y(Z);this.colors_.push({offset:i,color:Z.color,alpha:Z.alpha})};function u(i,Z){q(i);switch(Z){case"repeat":case null:case"":this.repetition_="repeat";break;case"repeat-x":case"repeat-y":case"no-repeat":this.repetition_=Z;break;default:n("SYNTAX_ERR")}this.src_=i.src;this.width_=i.width;this.height_=i.height}function n(Z){throw new o(Z)}function q(Z){if(!Z||Z.nodeType!=1||Z.tagName!="IMG"){n("TYPE_MISMATCH_ERR")}if(Z.readyState!="complete"){n("INVALID_STATE_ERR")}}function o(Z){this.code=this[Z];this.message=Z+": DOM Exception "+this.code}var x=o.prototype=new Error;x.INDEX_SIZE_ERR=1;x.DOMSTRING_SIZE_ERR=2;x.HIERARCHY_REQUEST_ERR=3;x.WRONG_DOCUMENT_ERR=4;x.INVALID_CHARACTER_ERR=5;x.NO_DATA_ALLOWED_ERR=6;x.NO_MODIFICATION_ALLOWED_ERR=7;x.NOT_FOUND_ERR=8;x.NOT_SUPPORTED_ERR=9;x.INUSE_ATTRIBUTE_ERR=10;x.INVALID_STATE_ERR=11;x.SYNTAX_ERR=12;x.INVALID_MODIFICATION_ERR=13;x.NAMESPACE_ERR=14;x.INVALID_ACCESS_ERR=15;x.VALIDATION_ERR=16;x.TYPE_MISMATCH_ERR=17;G_vmlCanvasManager=E;CanvasRenderingContext2D=W;CanvasGradient=v;CanvasPattern=u;DOMException=o})()};(function(a){elFinder=function(d,g){var b=this,h;this.log=function(i){window.console&&window.console.log&&window.console.log(i)};this.options=a.extend({},this.options,g||{});if(!this.options.url){alert("Invalid configuration! You have to set URL option.");return}this.id="";if((h=a(d).attr("id"))){this.id=h}else{this.id="el-finder-"+Math.random().toString().substring(2)}this.version="1.1 RC3";this.jquery=a.fn.jquery.split(".").join("");this.cwd={};this.cdc={};this.buffer={};this.selected=[];this.history=[];this.locked=false;this.zIndex=2;this.dialog=null;this.anchor=this.options.docked?a("<div/>").hide().insertBefore(d):null;this.params={dotFiles:false,arc:"",uplMaxSize:""};this.vCookie="el-finder-view-"+this.id;this.pCookie="el-finder-places-"+this.id;this.lCookie="el-finder-last-"+this.id;this.view=new this.view(this,d);this.ui=new this.ui(this);this.eventsManager=new this.eventsManager(this);this.quickLook=new this.quickLook(this);this.cookie=function(j,l){if(typeof l=="undefined"){if(document.cookie&&document.cookie!=""){var k,p=document.cookie.split(";");j+="=";for(k=0;k<p.length;k++){p[k]=a.trim(p[k]);if(p[k].substring(0,j.length)==j){return decodeURIComponent(p[k].substring(j.length))}}}return""}else{var n,m=a.extend({},this.options.cookie);if(l===null){l="";m.expires=-1}if(typeof(m.expires)=="number"){n=new Date();n.setTime(n.getTime()+(m.expires*24*60*60*1000));m.expires=n}document.cookie=j+"="+encodeURIComponent(l)+"; expires="+m.expires.toUTCString()+(m.path?"; path="+m.path:"")+(m.domain?"; domain="+m.domain:"")+(m.secure?"; secure":"")}};this.lock=function(i){this.view.spinner((this.locked=i||false));this.eventsManager.lock=this.locked};this.lockShortcuts=function(i){this.eventsManager.lock=i};this.setView=function(i){if(i=="list"||i=="icons"){this.options.view=i;this.cookie(this.vCookie,i)}};this.ajax=function(k,l,i){var j={url:this.options.url,async:true,type:"GET",data:k,dataType:"json",cache:false,lock:true,force:false,silent:false};if(typeof(i)=="object"){j=a.extend({},j,i)}if(!j.silent){j.error=b.view.fatal}j.success=function(m){j.lock&&b.lock();m.debug&&b.log(m.debug);if(m.error){!j.silent&&b.view.error(m.error,m.errorData);if(!j.force){return}}l(m);delete m};j.lock&&this.lock(true);a.ajax(j)};this.tmb=function(){this.ajax({cmd:"tmb",current:b.cwd.hash},function(k){if(b.options.view=="icons"&&k.images&&k.current==b.cwd.hash){for(var j in k.images){if(b.cdc[j]){b.cdc[j].tmb=k.images[j];a('div[key="'+j+'"]>p',b.view.cwd).css("background",' url("'+k.images[j]+'") 0 0 no-repeat')}}k.tmb&&b.tmb()}},{lock:false,silent:true})};this.getPlaces=function(){var i=[],j=this.cookie(this.pCookie);if(j.length){if(j.indexOf(":")!=-1){i=j.split(":")}else{i.push(j)}}return i};this.addPlace=function(j){var i=this.getPlaces();if(a.inArray(j,i)==-1){i.push(j);this.savePlaces(i);return true}};this.removePlace=function(j){var i=this.getPlaces();if(a.inArray(j,i)!=-1){this.savePlaces(a.map(i,function(k){return k==j?null:k}));return true}};this.savePlaces=function(i){this.cookie(this.pCookie,i.join(":"))};this.reload=function(m){var k;this.cwd=m.cwd;this.cdc={};for(k=0;k<m.cdc.length;k++){this.cdc[m.cdc[k].hash]=m.cdc[k];this.cwd.size+=m.cdc[k].size}if(m.tree){this.view.renderNav(m.tree);this.eventsManager.updateNav()}this.updateCwd();if(m.tmb&&!b.locked&&b.options.view=="icons"){b.tmb()}if(m.select&&m.select.length){var j=m.select.length;while(j--){this.cdc[m.select[j]]&&this.selectById(m.select[j])}}this.lastDir(this.cwd.hash);if(this.options.autoReload>0){this.iID&&clearInterval(this.iID);this.iID=setInterval(function(){!b.locked&&b.ui.exec("reload")},this.options.autoReload*60000)}};this.updateCwd=function(){this.lockShortcuts();this.selected=[];this.view.renderCwd();this.eventsManager.updateCwd();this.view.tree.find('a[key="'+this.cwd.hash+'"]').trigger("select")};this.drop=function(l,j,k){if(j.helper.find('[key="'+k+'"]').length){return b.view.error("Unable to copy into itself")}var i=[];j.helper.find('div:not(.noaccess):has(>label):not(:has(em[class="readonly"],em[class=""]))').each(function(){i.push(a(this).hide().attr("key"))});if(!j.helper.find("div:has(>label):visible").length){j.helper.hide()}if(i.length){b.setBuffer(i,l.shiftKey?0:1,k);if(b.buffer.files){setTimeout(function(){b.ui.exec("paste");b.buffer={}},300)}}else{a(this).removeClass("el-finder-droppable")}};this.getSelected=function(j){var k,l=[];if(j>=0){return this.cdc[this.selected[j]]||{}}for(k=0;k<this.selected.length;k++){this.cdc[this.selected[k]]&&l.push(this.cdc[this.selected[k]])}return l};this.select=function(i,j){j&&a(".ui-selected",b.view.cwd).removeClass("ui-selected");i.addClass("ui-selected");b.updateSelect()};this.selectById=function(j){var i=a('[key="'+j+'"]',this.view.cwd);if(i.length){this.select(i);this.checkSelectedPos()}};this.unselect=function(i){i.removeClass("ui-selected");b.updateSelect()};this.toggleSelect=function(i){i.toggleClass("ui-selected");this.updateSelect()};this.selectAll=function(){a("[key]",b.view.cwd).addClass("ui-selected");b.updateSelect()};this.unselectAll=function(){a(".ui-selected",b.view.cwd).removeClass("ui-selected");b.updateSelect()};this.updateSelect=function(){b.selected=[];a(".ui-selected",b.view.cwd).each(function(){b.selected.push(a(this).attr("key"))});b.view.selectedInfo();b.ui.update();b.quickLook.update()};this.checkSelectedPos=function(k){var j=b.view.cwd.find(".ui-selected:"+(k?"last":"first")).eq(0),l=j.position(),i=j.outerHeight(),m=b.view.cwd.height();if(l.top<0){b.view.cwd.scrollTop(l.top+b.view.cwd.scrollTop()-2)}else{if(m-l.top<i){b.view.cwd.scrollTop(l.top+i-m+b.view.cwd.scrollTop())}}};this.setBuffer=function(k,m,o){var j,n,l;this.buffer={src:this.cwd.hash,dst:o,files:[],names:[],cut:m||0};for(j=0;j<k.length;j++){n=k[j];l=this.cdc[n];if(l&&l.read&&l.type!="link"){this.buffer.files.push(l.hash);this.buffer.names.push(l.name)}}if(!this.buffer.files.length){this.buffer={}}};this.isValidName=function(i){if(!this.cwd.dotFiles&&i.indexOf(".")==0){return false}return i.match(/^[^\\\/\<\>:]+$/)};this.fileExists=function(k){for(var j in this.cdc){if(this.cdc[j].name==k){return j}}return false};this.uniqueName=function(m,l){m=b.i18n(m);var j=m,k=0,l=l||"";if(!this.fileExists(j+l)){return j+l}while(k++<100){if(!this.fileExists(j+k+l)){return j+k+l}}return j.replace("100","")+Math.random()+l};this.lastDir=function(i){if(this.options.rememberLastDir){return i?this.cookie(this.lCookie,i):this.cookie(this.lCookie)}};function c(i,j){i&&b.view.win.width(i);j&&b.view.nav.add(b.view.cwd).height(j)}function e(){c(null,b.dialog.height()-b.view.tlb.parent().height()-(a.browser.msie?47:32))}this.time=function(){return new Date().getMilliseconds()};this.setView(this.cookie(this.vCookie));c(b.options.width,b.options.height);if(this.options.dialog||this.options.docked){this.options.dialog=a.extend({width:570,dialogClass:"",minWidth:480,minHeight:330},this.options.dialog||{});this.options.dialog.dialogClass+="el-finder-dialog";this.options.dialog.resize=e;if(this.options.docked){this.options.dialog.close=function(){b.dock()};this.view.win.data("size",{width:this.view.win.width(),height:this.view.nav.height()})}else{this.dialog=a("<div/>").append(this.view.win).dialog(this.options.dialog)}}this.ajax({cmd:"open",target:this.lastDir()||"",init:true,tree:true},function(i){if(i.cwd){b.eventsManager.init();b.reload(i);b.params=i.params;a("*",document.body).each(function(){var j=parseInt(a(this).css("z-index"));if(j>=b.zIndex){b.zIndex=j+1}});b.ui.init(i.disabled)}},{force:true});this.open=function(){this.dialog?this.dialog.dialog("open"):this.view.win.show();this.eventsManager.lock=false};this.close=function(){if(this.options.docked&&this.view.win.attr("undocked")){this.dock()}else{this.dialog?this.dialog.dialog("close"):this.view.win.hide()}this.eventsManager.lock=true};this.dock=function(){if(this.options.docked&&this.view.win.attr("undocked")){var i=this.view.win.data("size");this.view.win.insertAfter(this.anchor).removeAttr("undocked");c(i.width,i.height);this.dialog.dialog("destroy");this.dialog=null}};this.undock=function(){if(this.options.docked&&!this.view.win.attr("undocked")){this.dialog=a("<div/>").append(this.view.win.css("width","100%").attr("undocked",true).show()).dialog(this.options.dialog);e()}}};elFinder.prototype.i18n=function(b){return this.options.i18n[this.options.lang]&&this.options.i18n[this.options.lang][b]?this.options.i18n[this.options.lang][b]:b};elFinder.prototype.options={url:"",lang:"en",cssClass:"",wrap:14,places:"Places",placesFirst:true,editorCallback:null,cutURL:"",closeOnEditorCallback:true,i18n:{},view:"icons",width:"",height:"",disableShortcuts:false,rememberLastDir:true,cookie:{expires:30,domain:"",path:"/",secure:false},toolbar:[["back","reload"],["select","open"],["mkdir","mkfile","upload"],["copy","paste","rm"],["rename","edit"],["info","quicklook"],["icons","list"],["help"]],contextmenu:{cwd:["reload","delim","mkdir","mkfile","upload","delim","paste","delim","info"],file:["select","open","quicklook","delim","copy","cut","rm","delim","duplicate","rename","edit","resize","archive","extract","delim","info"],group:["copy","cut","rm","delim","archive","extract","delim","info"]},dialog:null,docked:false,autoReload:0};a.fn.elfinder=function(b){return this.each(function(){var c=typeof(b)=="string"?b:"";if(!this.elfinder){this.elfinder=new elFinder(this,typeof(b)=="object"?b:{})}switch(c){case"close":case"hide":this.elfinder.close();break;case"open":case"show":this.elfinder.open();break;case"dock":this.elfinder.dock();break;case"undock":this.elfinder.undock();break}})}})(jQuery);(function(a){elFinder.prototype.view=function(d,c){var b=this;this.fm=d;this.kinds={unknown:"Unknown",directory:"Folder",symlink:"Alias","symlink-broken":"Broken alias","application/x-empty":"Plain text","application/postscript":"Postscript document","application/octet-stream":"Application","application/vnd.ms-office":"Microsoft Office document","application/vnd.ms-word":"Microsoft Word document","application/vnd.ms-excel":"Microsoft Excel document","application/vnd.ms-powerpoint":"Microsoft Powerpoint presentation","application/pdf":"Portable Document Format (PDF)","application/vnd.oasis.opendocument.text":"Open Office document","application/x-shockwave-flash":"Flash application","application/xml":"XML document","application/x-bittorrent":"Bittorrent file","application/x-7z-compressed":"7z archive","application/x-tar":"TAR archive","application/x-gzip":"GZIP archive","application/x-bzip2":"BZIP archive","application/zip":"ZIP archive","application/x-rar":"RAR archive","application/javascript":"Javascript application","text/plain":"Plain text","text/x-php":"PHP source","text/html":"HTML document","text/javascript":"Javascript source","text/css":"CSS style sheet","text/rtf":"Rich Text Format (RTF)","text/rtfd":"RTF with attachments (RTFD)","text/x-c":"C source","text/x-c++":"C++ source","text/x-shellscript":"Unix shell script","text/x-python":"Python source","text/x-java":"Java source","text/x-ruby":"Ruby source","text/x-perl":"Perl script","text/xml":"XML document","image/x-ms-bmp":"BMP image","image/jpeg":"JPEG image","image/gif":"GIF Image","image/png":"PNG image","image/x-targa":"TGA image","image/tiff":"TIFF image","image/vnd.adobe.photoshop":"Adobe Photoshop image","audio/mpeg":"MPEG audio","audio/midi":"MIDI audio","audio/ogg":"Ogg Vorbis audio","audio/mp4":"MP4 audio","audio/wav":"WAV audio","video/x-dv":"DV video","video/mp4":"MP4 video","video/mpeg":"MPEG video","video/x-msvideo":"AVI video","video/quicktime":"Quicktime video","video/x-ms-wmv":"WM video","video/x-flv":"Flash video","video/x-matroska":"Matroska video"};this.tlb=a("<ul />");this.nav=a('<div class="el-finder-nav"/>').resizable({handles:"e",autoHide:true,minWidth:200,maxWidth:500});this.cwd=a('<div class="el-finder-cwd"/>').attr("unselectable","on");this.spn=a('<div class="el-finder-spinner"/>');this.err=a('<p class="el-finder-err"><strong/></p>').click(function(){a(this).hide()});this.nfo=a('<div class="el-finder-stat"/>');this.pth=a('<div class="el-finder-path"/>');this.sel=a('<div class="el-finder-sel"/>');this.stb=a('<div class="el-finder-statusbar"/>').append(this.pth).append(this.nfo).append(this.sel);this.wrz=a('<div class="el-finder-workzone" />').append(this.nav).append(this.cwd).append(this.spn).append(this.err).append('<div style="clear:both" />');this.win=a(c).empty().attr("id",this.fm.id).addClass("el-finder "+(d.options.cssClass||"")).append(a('<div class="el-finder-toolbar" />').append(this.tlb)).append(this.wrz).append(this.stb);this.tree=a('<ul class="el-finder-tree"></ul>').appendTo(this.nav);this.plc=a('<ul class="el-finder-places"><li><a href="#" class="el-finder-places-root"><div/>'+this.fm.i18n(this.fm.options.places)+"</a><ul/></li></ul>").hide();this.nav[this.fm.options.placesFirst?"prepend":"append"](this.plc);this.spinner=function(e){this.win.toggleClass("el-finder-disabled",e);this.spn.toggle(e)};this.fatal=function(e){b.error(e.status!="404"?"Invalid backend configuration":"Unable to connect to backend")};this.error=function(e,g){this.fm.lock();this.err.show().children("strong").html(this.fm.i18n(e)+"!"+this.formatErrorData(g));setTimeout(function(){b.err.fadeOut("slow")},4000)};this.renderNav=function(g){var i=g.dirs.length?h(g.dirs):"",e='<li><a href="#" class="el-finder-tree-root" key="'+g.hash+'"><div'+(i?' class="collapsed expanded"':"")+"/>"+g.name+"</a>"+i+"</li>";this.tree.html(e);this.fm.options.places&&this.renderPlaces();function h(j){var l,m,n,k='<ul style="display:none">';for(l=0;l<j.length;l++){n="";if(!j[l].read&&!j[l].write){n="noaccess"}else{if(!j[l].read){n="dropbox"}else{if(!j[l].write){n="readonly"}}}k+='<li><a href="#" class="'+n+'" key="'+j[l].hash+'"><div'+(j[l].dirs.length?' class="collapsed"':"")+"/>"+j[l].name+"</a>";if(j[l].dirs.length){k+=h(j[l].dirs)}k+="</li>"}return k+"</ul>"}};this.renderPlaces=function(){var g,j,h=this.fm.getPlaces(),e=this.plc.show().find("ul").empty().hide();a("div:first",this.plc).removeClass("collapsed expanded");if(h.length){h.sort(function(k,i){var m=b.tree.find('a[key="'+k+'"]').text()||"",l=b.tree.find('a[key="'+i+'"]').text()||"";return m.localeCompare(l)});for(g=0;g<h.length;g++){if((j=this.tree.find('a[key="'+h[g]+'"]:not(.dropbox)').parent())&&j.length){e.append(j.clone().children("ul").remove().end().find("div").removeClass("collapsed expanded").end())}else{this.fm.removePlace(h[g])}}e.children().length&&a("div:first",this.plc).addClass("collapsed")}};this.renderCwd=function(){this.cwd.empty();var e=0,h=0,g="";for(var i in this.fm.cdc){e++;h+=this.fm.cdc[i].size;g+=this.fm.options.view=="icons"?this.renderIcon(this.fm.cdc[i]):this.renderRow(this.fm.cdc[i],e%2)}if(this.fm.options.view=="icons"){this.cwd.append(g)}else{this.cwd.append('<table><tr><th colspan="2">'+this.fm.i18n("Name")+"</th><th>"+this.fm.i18n("Permissions")+"</th><th>"+this.fm.i18n("Modified")+'</th><th class="size">'+this.fm.i18n("Size")+"</th><th>"+this.fm.i18n("Kind")+"</th></tr>"+g+"</table>")}this.pth.text(d.cwd.rel);this.nfo.text(d.i18n("items")+": "+e+", "+this.formatSize(h));this.sel.empty()};this.renderIcon=function(e){var g="<p"+(e.tmb?" style=\"background:url('"+e.tmb+"') 0 0 no-repeat\"":"")+"/><label>"+this.formatName(e.name)+"</label>";if(e.link||e.mime=="symlink-broken"){g+="<em/>"}if(!e.read&&!e.write){g+='<em class="noaccess"/>'}else{if(e.read&&!e.write){g+='<em class="readonly"/>'}else{if(!e.read&&e.write){g+='<em class="'+(e.mime=="directory"?"dropbox":"noread")+'" />'}}}return'<div class="'+this.mime2class(e.mime)+'" key="'+e.hash+'">'+g+"</div>"};this.renderRow=function(g,e){var h=g.link||g.mime=="symlink-broken"?"<em/>":"";if(!g.read&&!g.write){h+='<em class="noaccess"/>'}else{if(g.read&&!g.write){h+='<em class="readonly"/>'}else{if(!g.read&&g.write){h+='<em class="'+(g.mime=="directory"?"dropbox":"noread")+'" />'}}}return'<tr key="'+g.hash+'" class="'+b.mime2class(g.mime)+(e?" el-finder-row-odd":"")+'"><td class="icon"><p>'+h+"</p></td><td>"+g.name+"</td><td>"+b.formatPermissions(g.read,g.write,g.rm)+"</td><td>"+b.formatDate(g.date)+'</td><td class="size">'+b.formatSize(g.size)+"</td><td>"+b.mime2kind(g.link?"symlink":g.mime)+"</td></tr>"};this.updateFile=function(g){var h=this.cwd.find('[key="'+g.hash+'"]');h.replaceWith(h[0].nodeName=="DIV"?this.renderIcon(g):this.renderRow(g))};this.selectedInfo=function(){var e,g=0,h;if(b.fm.selected.length){h=this.fm.getSelected();for(e=0;e<h.length;e++){g+=h[e].size}}this.sel.text(e>0?this.fm.i18n("selected items")+": "+h.length+", "+this.formatSize(g):"")};this.formatName=function(g){var e=b.fm.options.wrap;if(e>0){if(g.length>e*2){return g.substr(0,e)+"&shy;"+g.substr(e,e-5)+"&hellip;"+g.substr(g.length-3)}else{if(g.length>e){return g.substr(0,e)+"&shy;"+g.substr(e)}}}return g};this.formatErrorData=function(h){var e,g="";if(typeof(h)=="object"){g="<br />";for(e in h){g+=e+" "+b.fm.i18n(h[e])+"<br />"}}return g};this.mime2class=function(e){return e.replace("/"," ").replace(/\./g,"-")};this.formatDate=function(e){return e.replace(/([a-z]+)\s/i,function(h,g){return b.fm.i18n(g)+" "})};this.formatSize=function(g){var h=1,e="";if(g>1073741824){h=1073741824;e="Gb"}else{if(g>1048576){h=1048576;e="Mb"}else{if(g>1024){h=1024;e="Kb"}}}return Math.round(g/h)+" "+e};this.formatPermissions=function(g,e,i){var h=[];g&&h.push(b.fm.i18n("read"));e&&h.push(b.fm.i18n("write"));i&&h.push(b.fm.i18n("remove"));return h.join("/")};this.mime2kind=function(e){return this.fm.i18n(this.kinds[e]||"unknown")}}})(jQuery);(function(a){elFinder.prototype.ui=function(c){var b=this;this.fm=c;this.cmd={};this.buttons={};this.menu=a('<div class="el-finder-contextmenu" />').appendTo(document.body).hide();this.dockButton=a('<div class="el-finder-dock-button" title="'+b.fm.i18n("Dock/undock filemanger window")+'" />');this.exec=function(e,d){if(this.cmd[e]){if(e!="open"&&!this.cmd[e].isAllowed()){return this.fm.view.error("Command not allowed")}if(!this.fm.locked){this.fm.quickLook.hide();a(".el-finder-info").remove();this.cmd[e].exec(d);this.update()}}};this.cmdName=function(d){if(this.cmd[d]&&this.cmd[d].name){return d=="archive"&&this.fm.params.archives.length==1?this.fm.i18n("Create")+" "+this.fm.view.mime2kind(this.fm.params.archives[0]).toLowerCase():this.fm.i18n(this.cmd[d].name)}return d};this.isCmdAllowed=function(d){return b.cmd[d]&&b.cmd[d].isAllowed()};this.execIfAllowed=function(d){this.isCmdAllowed(d)&&this.exec(d)};this.includeInCm=function(e,d){return this.isCmdAllowed(e)&&this.cmd[e].cm(d)};this.showMenu=function(i){var g,h,d,k="";this.hideMenu();if(!b.fm.selected.length){g="cwd"}else{if(b.fm.selected.length==1){g="file"}else{g="group"}}j(g);h=a(window);d={height:h.height(),width:h.width(),sT:h.scrollTop(),cW:this.menu.width(),cH:this.menu.height()};this.menu.css({left:((i.clientX+d.cW)>d.width?(i.clientX-d.cW):i.clientX),top:((i.clientY+d.cH)>d.height&&i.clientY>d.cH?(i.clientY+d.sT-d.cH):i.clientY+d.sT)}).show().find("div[name]").hover(function(){var l=a(this),m=l.children("div"),e;l.addClass("hover");if(m.length){if(!m.attr("pos")){e=l.outerWidth();m.css(a(window).width()-e-l.offset().left>m.width()?"left":"right",e-5).attr("pos",true)}m.show()}},function(){a(this).removeClass("hover").children("div").hide()}).click(function(m){m.stopPropagation();var l=a(this);if(!l.children("div").length){b.hideMenu();b.exec(l.attr("name"),l.attr("argc"))}});function j(q){var p,n,m,o,e,r=b.fm.options.contextmenu[q]||[];for(p=0;p<r.length;p++){if(r[p]=="delim"){b.menu.children().length&&!b.menu.children(":last").hasClass("delim")&&b.menu.append('<div class="delim" />')}else{if(b.fm.ui.includeInCm(r[p],q)){m=b.cmd[r[p]].argc();o="";if(m.length){o='<span/><div class="el-finder-contextmenu-sub" style="z-index:'+(parseInt(b.menu.css("z-index"))+1)+'">';for(var n=0;n<m.length;n++){o+='<div name="'+r[p]+'" argc="'+m[n].argc+'" class="'+m[n]["class"]+'">'+m[n].text+"</div>"}o+="</div>"}b.menu.append('<div class="'+r[p]+'" name="'+r[p]+'">'+o+b.cmdName(r[p])+"</div>")}}}}};this.hideMenu=function(){this.menu.hide().empty()};this.update=function(){for(var d in this.buttons){this.buttons[d].toggleClass("disabled",!this.cmd[d].isAllowed())}};this.init=function(k){var h,d,o,m=false,g=2,l,e=this.fm.options.toolbar;if(!this.fm.options.editorCallback){k.push("select")}if(!b.fm.params.archives.length&&a.inArray("archive",k)==-1){k.push("archive")}for(h in this.commands){if(a.inArray(h,k)==-1){this.commands[h].prototype=this.command.prototype;this.cmd[h]=new this.commands[h](this.fm)}}for(h=0;h<e.length;h++){if(m){this.fm.view.tlb.append('<li class="delim" />')}m=false;for(d=0;d<e[h].length;d++){o=e[h][d];if(this.cmd[o]){m=true;this.buttons[o]=a('<li class="'+o+'" title="'+this.cmdName(o)+'" name="'+o+'" />').appendTo(this.fm.view.tlb).click(function(i){i.stopPropagation()}).bind("click",(function(i){return function(){!a(this).hasClass("disabled")&&i.exec(a(this).attr("name"))}})(this)).hover(function(){!a(this).hasClass("disabled")&&a(this).addClass("el-finder-tb-hover")},function(){a(this).removeClass("el-finder-tb-hover")})}}}this.update();this.menu.css("z-index",this.fm.zIndex);if(this.fm.options.docked){this.dockButton.hover(function(){a(this).addClass("el-finder-dock-button-hover")},function(){a(this).removeClass("el-finder-dock-button-hover")}).click(function(){b.fm.view.win.attr("undocked")?b.fm.dock():b.fm.undock();a(this).trigger("mouseout")}).prependTo(this.fm.view.tlb)}}};elFinder.prototype.ui.prototype.command=function(b){};elFinder.prototype.ui.prototype.command.prototype.isAllowed=function(){return true};elFinder.prototype.ui.prototype.command.prototype.cm=function(b){return false};elFinder.prototype.ui.prototype.command.prototype.argc=function(b){return[]};elFinder.prototype.ui.prototype.commands={back:function(c){var b=this;this.name="Back";this.fm=c;this.exec=function(){if(this.fm.history.length){this.fm.ajax({cmd:"open",target:this.fm.history.pop()},function(d){b.fm.reload(d)})}};this.isAllowed=function(){return this.fm.history.length}},reload:function(c){var b=this;this.name="Reload";this.fm=c;this.exec=function(){this.fm.ajax({cmd:"open",target:this.fm.cwd.hash,tree:true},function(d){b.fm.reload(d)})};this.cm=function(d){return d=="cwd"}},open:function(c){var b=this;this.name="Open";this.fm=c;this.exec=function(e){var g=null;if(e){g={hash:a(e).attr("key"),mime:"directory",read:!a(e).hasClass("noaccess")&&!a(e).hasClass("dropbox")}}else{g=this.fm.getSelected(0)}if(!g.hash){return}if(!g.read){return this.fm.view.error("Access denied")}if(g.type=="link"&&!g.link){return this.fm.view.error("Unable to open broken link")}if(g.mime=="directory"){h(g.link||g.hash)}else{d(g)}function h(i){b.fm.history.push(b.fm.cwd.hash);b.fm.ajax({cmd:"open",target:i},function(j){b.fm.reload(j)})}function d(k){var j,i="";if(k.dim){j=k.dim.split("x");i="width="+(parseInt(j[0])+20)+",height="+(parseInt(j[1])+20)+","}window.open(k.url||b.fm.options.url+"?cmd=open&current="+(k.parent||b.fm.cwd.hash)+"&target="+(k.link||k.hash),false,"top=50,left=50,"+i+"scrollbars=yes,resizable=yes")}};this.isAllowed=function(){return this.fm.selected.length==1&&this.fm.getSelected(0).read};this.cm=function(d){return d=="file"}},select:function(b){this.name="Select file";this.fm=b;this.exec=function(){var c=this.fm.getSelected(0);if(!c.url){return this.fm.view.error("File URL disabled by connector config")}this.fm.options.editorCallback(this.fm.options.cutURL=="root"?c.url.substr(this.fm.params.url.length):c.url.replace(new RegExp("^("+this.fm.options.cutURL+")"),""));if(this.fm.options.closeOnEditorCallback){this.fm.dock();this.fm.close()}};this.isAllowed=function(){return this.fm.selected.length==1&&!/(symlink\-broken|directory)/.test(this.fm.getSelected(0).mime)};this.cm=function(c){return c=="file"}},quicklook:function(c){var b=this;this.name="Preview with Quick Look";this.fm=c;this.exec=function(){b.fm.quickLook.toggle()};this.isAllowed=function(){return this.fm.selected.length==1};this.cm=function(){return true}},info:function(c){var b=this;this.name="Get info";this.fm=c;this.exec=function(){var j,i,e=this.fm.selected.length,d=a(window).width(),g=a(window).height();this.fm.lockShortcuts(true);if(!e){k(b.fm.cwd)}else{a.each(this.fm.getSelected(),function(){k(this)})}function k(m){var n=["50%","50%"],h,q,o,l='<table cellspacing="0"><tr><td>'+b.fm.i18n("Name")+"</td><td>"+m.name+"</td></tr><tr><td>"+b.fm.i18n("Kind")+"</td><td>"+b.fm.view.mime2kind(m.link?"symlink":m.mime)+"</td></tr><tr><td>"+b.fm.i18n("Size")+"</td><td>"+b.fm.view.formatSize(m.size)+"</td></tr><tr><td>"+b.fm.i18n("Modified")+"</td><td>"+b.fm.view.formatDate(m.date)+"</td></tr><tr><td>"+b.fm.i18n("Permissions")+"</td><td>"+b.fm.view.formatPermissions(m.read,m.write,m.rm)+"</td></tr>";if(m.link){l+="<tr><td>"+b.fm.i18n("Link to")+"</td><td>"+m.linkTo+"</td></tr>"}if(m.dim){l+="<tr><td>"+b.fm.i18n("Dimensions")+"</td><td>"+m.dim+" px.</td></tr>"}if(m.url){l+="<tr><td>"+b.fm.i18n("URL")+'</td><td><a href="'+m.url+'" target="_blank">'+m.url+"</a></td></tr>"}if(e>1){o=a(".el-finder-dialog-info:last");if(!o.length){h=Math.round(((d-350)/2)-(e*10));q=Math.round(((g-300)/2)-(e*10));n=[h>20?h:20,q>20?q:20]}else{h=o.offset().left+10;q=o.offset().top+10;n=[h<d-350?h:20,q<g-300?q:20]}}a("<div />").append(l+"</table>").dialog({dialogClass:"el-finder-dialog el-finder-dialog-info",width:390,position:n,title:b.fm.i18n(m.mime=="directory"?"Folder info":"File info"),close:function(){if(--e<=0){b.fm.lockShortcuts()}a(this).dialog("destroy")},buttons:{Ok:function(){a(this).dialog("close")}}})}};this.cm=function(d){return true}},rename:function(c){var b=this;this.name="Rename";this.fm=c;this.exec=function(){var i=this.fm.getSelected(),h,l,e,j,k;if(i.length==1){j=i[0];h=this.fm.view.cwd.find('[key="'+j.hash+'"]');l=this.fm.options.view=="icons"?h.children("label"):h.find("td").eq(1);k=l.html();e=a('<input type="text" />').val(j.name).appendTo(l.empty()).bind("change blur",d).keydown(function(m){m.stopPropagation();if(m.keyCode==27){g()}else{if(m.keyCode==13){if(j.name==e.val()){g()}else{a(this).trigger("change")}}}}).click(function(m){m.stopPropagation()}).select().focus();this.fm.lockShortcuts(true)}function g(){l.html(k);b.fm.lockShortcuts()}function d(){if(!b.fm.locked){var n,m=e.val();if(j.name==e.val()){return g()}if(!b.fm.isValidName(m)){n="Invalid name"}else{if(b.fm.fileExists(m)){n="File or folder with the same name already exists"}}if(n){b.fm.view.error(n);h.addClass("ui-selected");b.fm.lockShortcuts(true);return e.select().focus()}b.fm.ajax({cmd:"rename",current:b.fm.cwd.hash,target:j.hash,name:m},function(o){if(o.error){g()}else{j.mime=="directory"&&b.fm.removePlace(j.hash)&&b.fm.addPlace(o.target);b.fm.reload(o)}},{force:true})}}};this.isAllowed=function(){return this.fm.cwd.write&&this.fm.getSelected(0).write};this.cm=function(d){return d=="file"}},copy:function(b){this.name="Copy";this.fm=b;this.exec=function(){this.fm.setBuffer(this.fm.selected)};this.isAllowed=function(){if(this.fm.selected.length){var d=this.fm.getSelected(),c=d.length;while(c--){if(d[c].read){return true}}}return false};this.cm=function(c){return c!="cwd"}},cut:function(b){this.name="Cut";this.fm=b;this.exec=function(){this.fm.setBuffer(this.fm.selected,1)};this.isAllowed=function(){if(this.fm.selected.length){var d=this.fm.getSelected(),c=d.length;while(c--){if(d[c].read&&d[c].rm){return true}}}return false};this.cm=function(c){return c!="cwd"}},paste:function(c){var b=this;this.name="Paste";this.fm=c;this.exec=function(){var e,l,h,g,k="";if(!this.fm.buffer.dst){this.fm.buffer.dst=this.fm.cwd.hash}l=this.fm.view.tree.find('[key="'+this.fm.buffer.dst+'"]');if(!l.length||l.hasClass("noaccess")||l.hasClass("readonly")){return this.fm.view.error("Access denied")}if(this.fm.buffer.src==this.fm.buffer.dst){return this.fm.view.error("Unable to copy into itself")}var j={cmd:"paste",current:this.fm.cwd.hash,src:this.fm.buffer.src,dst:this.fm.buffer.dst,cut:this.fm.buffer.cut};if(this.fm.jquery>132){j.targets=this.fm.buffer.files}else{j["targets[]"]=this.fm.buffer.files}this.fm.ajax(j,function(d){d.cdc&&b.fm.reload(d)},{force:true})};this.isAllowed=function(){return this.fm.buffer.files};this.cm=function(d){return d=="cwd"}},rm:function(c){var b=this;this.name="Remove";this.fm=c;this.exec=function(){var d,g=[],e=this.fm.getSelected();for(var d=0;d<e.length;d++){if(!e[d].rm){return this.fm.view.error(e[d].name+": "+this.fm.i18n("Access denied"))}g.push(e[d].hash)}if(g.length){this.fm.lockShortcuts(true);a('<div><div class="ui-state-error ui-corner-all"><span class="ui-icon ui-icon-alert"/><strong>'+this.fm.i18n("Are you shure you want to remove files?<br /> This cannot be undone!")+"</strong></div></div>").dialog({title:this.fm.i18n("Confirmation required"),dialogClass:"el-finder-dialog",width:350,close:function(){b.fm.lockShortcuts()},buttons:{Cancel:function(){a(this).dialog("close")},Ok:function(){a(this).dialog("close");var h={cmd:"rm",current:b.fm.cwd.hash};if(b.fm.jquery>132){h.targets=g}else{h["targets[]"]=g}b.fm.ajax(h,function(i){i.tree&&b.fm.reload(i)},{force:true})}}})}};this.isAllowed=function(g){if(this.fm.selected.length){var e=this.fm.getSelected(),d=e.length;while(d--){if(e[d].rm){return true}}}return false};this.cm=function(d){return d!="cwd"}},mkdir:function(c){var b=this;this.name="New folder";this.fm=c;this.exec=function(){b.fm.unselectAll();var e=this.fm.uniqueName("untitled folder");input=a('<input type="text"/>').val(e);prev=this.fm.view.cwd.find(".directory:last");f={name:e,hash:"",mime:"directory",read:true,write:true,date:"",size:0},el=this.fm.options.view=="list"?a(this.fm.view.renderRow(f)).children("td").eq(1).empty().append(input).end().end():a(this.fm.view.renderIcon(f)).children("label").empty().append(input).end();el.addClass("directory ui-selected");if(prev.length){el.insertAfter(prev)}else{if(this.fm.options.view=="list"){el.insertAfter(this.fm.view.cwd.find("tr").eq(0))}else{el.prependTo(this.fm.view.cwd)}}b.fm.checkSelectedPos();input.select().focus().click(function(g){g.stopPropagation()}).bind("change blur",d).keydown(function(g){g.stopPropagation();if(g.keyCode==27){el.remove();b.fm.lockShortcuts()}else{if(g.keyCode==13){d()}}});b.fm.lockShortcuts(true);function d(){if(!b.fm.locked){var h,g=input.val();if(!b.fm.isValidName(g)){h="Invalid name"}else{if(b.fm.fileExists(g)){h="File or folder with the same name already exists"}}if(h){b.fm.view.error(h);b.fm.lockShortcuts(true);el.addClass("ui-selected");return input.select().focus()}b.fm.ajax({cmd:"mkdir",current:b.fm.cwd.hash,name:g},function(i){if(i.error){el.addClass("ui-selected");return input.select().focus()}b.fm.reload(i)},{force:true})}}};this.isAllowed=function(){return this.fm.cwd.write};this.cm=function(d){return d=="cwd"}},mkfile:function(c){var b=this;this.name="New text file";this.fm=c;this.exec=function(){b.fm.unselectAll();var i=this.fm.uniqueName("untitled file",".txt"),e=a('<input type="text"/>').val(i),h={name:i,hash:"",mime:"text/plain",read:true,write:true,date:"",size:0},g=this.fm.options.view=="list"?a(this.fm.view.renderRow(h)).children("td").eq(1).empty().append(e).end().end():a(this.fm.view.renderIcon(h)).children("label").empty().append(e).end();g.addClass("text ui-selected").appendTo(this.fm.options.view=="list"?b.fm.view.cwd.children("table"):b.fm.view.cwd);e.select().focus().bind("change blur",d).click(function(j){j.stopPropagation()}).keydown(function(j){j.stopPropagation();if(j.keyCode==27){g.remove();b.fm.lockShortcuts()}else{if(j.keyCode==13){d()}}});b.fm.lockShortcuts(true);function d(){if(!b.fm.locked){var k,j=e.val();if(!b.fm.isValidName(j)){k="Invalid name"}else{if(b.fm.fileExists(j)){k="File or folder with the same name already exists"}}if(k){b.fm.view.error(k);b.fm.lockShortcuts(true);g.addClass("ui-selected");return e.select().focus()}b.fm.ajax({cmd:"mkfile",current:b.fm.cwd.hash,name:j},function(l){if(l.error){g.addClass("ui-selected");return e.select().focus()}b.fm.reload(l)},{force:true})}}};this.isAllowed=function(d){return this.fm.cwd.write};this.cm=function(d){return d=="cwd"}},upload:function(c){var b=this;this.name="Upload files";this.fm=c;this.exec=function(){var g="el-finder-io-"+(new Date().getTime()),l=a('<div class="ui-state-error ui-corner-all"><span class="ui-icon ui-icon-alert"/><div/></div>'),h=this.fm.params.uplMaxSize?"<p>"+this.fm.i18n("Maximum allowed files size")+": "+this.fm.params.uplMaxSize+"</p>":"",q=a('<p class="el-finder-add-field"><span class="ui-state-default ui-corner-all"><em class="ui-icon ui-icon-circle-plus"/></span>'+this.fm.i18n("Add field")+"</p>").click(function(){a(this).before('<p><input type="file" name="upload[]"/></p>')}),k='<form method="post" enctype="multipart/form-data" action="'+b.fm.options.url+'" target="'+g+'"><input type="hidden" name="cmd" value="upload" /><input type="hidden" name="current" value="'+b.fm.cwd.hash+'" />',o=a("<div/>"),j=3;while(j--){k+='<p><input type="file" name="upload[]"/></p>'}k=a(k+"</form>");o.append(k.append(l.hide()).prepend(h).append(q)).dialog({dialogClass:"el-finder-dialog",title:b.fm.i18n("Upload files"),modal:true,resizable:false,close:function(){b.fm.lockShortcuts()},buttons:{Cancel:function(){a(this).dialog("close")},Ok:function(){if(!a(":file[value]",k).length){return p(b.fm.i18n("Select at least one file to upload"))}setTimeout(function(){b.fm.lock();if(a.browser.safari){a.ajax({url:b.fm.options.url,data:{cmd:"ping"},error:n,success:n})}else{n()}});a(this).dialog("close")}}});b.fm.lockShortcuts(true);function p(d){l.show().find("div").empty().text(d)}function n(){var t=a('<iframe name="'+g+'" name="'+g+'" src="about:blank"/>'),u=t[0],i=50,s,e,r;t.css({position:"absolute",top:"-1000px",left:"-1000px"}).appendTo("body").bind("load",function(){t.unbind("load");d()});b.fm.lock(true);k.submit();function d(){try{s=u.contentWindow?u.contentWindow.document:u.contentDocument?u.contentDocument:u.document;if(s.body==null||s.body.innerHTML==""){if(--i){return setTimeout(d,100)}else{m();return b.fm.view.error("Unable to access iframe DOM after 50 tries")}}e=a(s.body).html();if(b.fm.jquery>=141){r=a.parseJSON(e)}else{if(/^[\],:{}\s]*$/.test(e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){r=window.JSON&&window.JSON.parse?window.JSON.parse(e):(new Function("return "+e))()}else{r={error:"Unable to parse server response"}}}}catch(v){r={error:"Unable to parse server response"}}m();r.error&&b.fm.view.error(r.error,r.errorData);r.cwd&&b.fm.reload(r);r.tmb&&b.fm.tmb()}function m(){b.fm.lock();t.remove()}}};this.isAllowed=function(){return this.fm.cwd.write};this.cm=function(d){return d=="cwd"}},duplicate:function(c){var b=this;this.name="Duplicate";this.fm=c;this.exec=function(){this.fm.ajax({cmd:"duplicate",current:this.fm.cwd.hash,target:this.fm.selected[0]},function(d){b.fm.reload(d)})};this.isAllowed=function(){return this.fm.cwd.write&&this.fm.selected.length==1&&this.fm.getSelected()[0].read};this.cm=function(d){return d=="file"}},edit:function(c){var b=this;this.name="Edit text file";this.fm=c;this.exec=function(){var d=this.fm.getSelected(0);this.fm.lockShortcuts(true);this.fm.ajax({cmd:"read",current:this.fm.cwd.hash,target:d.hash},function(g){b.fm.lockShortcuts(true);var e=a("<textarea/>").val(g.content||"").keydown(function(h){h.stopPropagation()});a("<div/>").append(e).dialog({dialogClass:"el-finder-dialog",title:b.fm.i18n(b.name),modal:true,width:500,close:function(){b.fm.lockShortcuts()},buttons:{Cancel:function(){a(this).dialog("close")},Ok:function(){var h=e.val();a(this).dialog("close");b.fm.ajax({cmd:"edit",current:b.fm.cwd.hash,target:d.hash,content:h},function(i){if(i.target){b.fm.cdc[i.target.hash]=i.target;b.fm.view.updateFile(i.target);b.fm.selectById(i.target.hash)}},{type:"POST"})}}})})};this.isAllowed=function(){if(b.fm.selected.length==1){var d=this.fm.getSelected()[0];return d.write&&(d.mime.indexOf("text")==0||d.mime=="application/x-empty"||d.mime=="application/xml")}};this.cm=function(d){return d=="file"}},archive:function(c){var b=this;this.name="Create archive";this.fm=c;this.exec=function(d){var e={cmd:"archive",current:b.fm.cwd.hash,type:a.inArray(d,this.fm.params.archives)!=-1?d:this.fm.params.archives[0],name:b.fm.i18n("Archive")};if(this.fm.jquery>132){e.targets=b.fm.selected}else{e["targets[]"]=b.fm.selected}this.fm.ajax(e,function(g){b.fm.reload(g)})};this.isAllowed=function(){if(this.fm.cwd.write&&this.fm.selected.length){var e=this.fm.getSelected(),d=e.length;while(d--){if(e[d].read){return true}}}return false};this.cm=function(d){return d!="cwd"};this.argc=function(){var e,d=[];for(e=0;e<b.fm.params.archives.length;e++){d.push({"class":"archive",argc:b.fm.params.archives[e],text:b.fm.view.mime2kind(b.fm.params.archives[e])})}return d}},extract:function(c){var b=this;this.name="Uncompress archive";this.fm=c;this.exec=function(){this.fm.ajax({cmd:"extract",current:this.fm.cwd.hash,target:this.fm.getSelected(0).hash},function(d){b.fm.reload(d)})};this.isAllowed=function(){return this.fm.cwd.write&&this.fm.selected.length==1&&this.fm.getSelected(0).read&&this.fm.params.extract.length&&a.inArray(this.fm.getSelected(0).mime,this.fm.params.extract)!=-1};this.cm=function(d){return d=="file"}},resize:function(c){var b=this;this.name="Resize image";this.fm=c;this.exec=function(){var l=this.fm.getSelected();if(l[0]&&l[0].write&&l[0].dim){var j=l[0].dim.split("x"),g=parseInt(j[0]),k=parseInt(j[1]),e=g/k;iw=a('<input type="text" size="9" value="'+g+'" name="width"/>'),ih=a('<input type="text" size="9" value="'+k+'" name="height"/>'),f=a("<form/>").append(iw).append(" x ").append(ih).append(" px");iw.add(ih).bind("change",i);b.fm.lockShortcuts(true);var m=a("<div/>").append(a("<div/>").text(b.fm.i18n("Dimensions")+":")).append(f).dialog({title:b.fm.i18n("Resize image"),dialogClass:"el-finder-dialog",width:230,modal:true,close:function(){b.fm.lockShortcuts()},buttons:{Cancel:function(){a(this).dialog("close")},Ok:function(){var d=parseInt(iw.val())||0,h=parseInt(ih.val())||0;if(d>0&&d!=g&&h>0&&h!=k){b.fm.ajax({cmd:"resize",current:b.fm.cwd.hash,target:l[0].hash,width:d,height:h},function(n){b.fm.reload(n)})}a(this).dialog("close")}}})}function i(){var d=parseInt(iw.val())||0,h=parseInt(ih.val())||0;if(d<=0||h<=0){d=g;h=k}else{if(this==iw.get(0)){h=parseInt(d/e)}else{d=parseInt(h*e)}}iw.val(d);ih.val(h)}};this.isAllowed=function(){return this.fm.selected.length==1&&this.fm.cdc[this.fm.selected[0]].write&&this.fm.cdc[this.fm.selected[0]].resize};this.cm=function(d){return d=="file"}},icons:function(b){this.name="View as icons";this.fm=b;this.exec=function(){this.fm.view.win.addClass("el-finder-disabled");this.fm.setView("icons");this.fm.updateCwd();this.fm.view.win.removeClass("el-finder-disabled");a("div.image",this.fm.view.cwd).length&&this.fm.tmb()};this.isAllowed=function(){return this.fm.options.view!="icons"};this.cm=function(c){return c=="cwd"}},list:function(b){this.name="View as list";this.fm=b;this.exec=function(){this.fm.view.win.addClass("el-finder-disabled");this.fm.setView("list");this.fm.updateCwd();this.fm.view.win.removeClass("el-finder-disabled")};this.isAllowed=function(){return this.fm.options.view!="list"};this.cm=function(c){return c=="cwd"}},help:function(b){this.name="Help";this.fm=b;this.exec=function(){var j,e=this.fm.i18n("helpText"),c,i,g;j='<div class="el-finder-logo"/><strong>'+this.fm.i18n("elFinder: Web file manager")+"</strong><br/>"+this.fm.i18n("Version")+": "+this.fm.version+'<br clear="all"/><p><strong><a href="http://elrte.ru/donate?prod=elfinder&lang='+this.fm.options.lang+'" target="_blank">'+this.fm.i18n("Donate to support project development")+'</a></strong></p><p><a href="http://elrte.ru/redmine/wiki/elfinder/" target="_blank">'+this.fm.i18n("elFinder documentation")+"</a></p>";j+="<p>"+(e!="helpText"?e:"elFinder works similar to file manager on your computer. <br /> To make actions on files/folders use icons on top panel. If icon action it is not clear for you, hold mouse cursor over it to see the hint. <br /> Manipulations with existing files/folders can be done through the context menu (mouse right-click).<br/> To copy/delete a group of files/folders, select them using Shift/Alt(Command) + mouse left-click.")+"</p>";j+="<p><strong>"+this.fm.i18n("elFinder support following shortcuts")+":</strong><ul><li><kbd>Ctrl+A</kbd> - "+this.fm.i18n("Select all files")+"</li><li><kbd>Ctrl+C/Ctrl+X/Ctrl+V</kbd> - "+this.fm.i18n("Copy/Cut/Paste files")+"</li><li><kbd>Enter</kbd> - "+this.fm.i18n("Open selected file/folder")+"</li><li><kbd>Space</kbd> - "+this.fm.i18n("Open/close QuickLook window")+"</li><li><kbd>Delete/Cmd+Backspace</kbd> - "+this.fm.i18n("Remove selected files")+"</li><li><kbd>Ctrl+I</kbd> - "+this.fm.i18n("Selected files or current directory info")+"</li><li><kbd>Ctrl+N</kbd> - "+this.fm.i18n("Create new directory")+"</li><li><kbd>Ctrl+U</kbd> - "+this.fm.i18n("Open upload files form")+"</li><li><kbd>Left arrow</kbd> - "+this.fm.i18n("Select previous file")+"</li><li><kbd>Right arrow </kbd> - "+this.fm.i18n("Select next file")+"</li><li><kbd>Ctrl+Right arrow</kbd> - "+this.fm.i18n("Open selected file/folder")+"</li><li><kbd>Ctrl+Left arrow</kbd> - "+this.fm.i18n("Return into previous folder")+"</li><li><kbd>Shift+arrows</kbd> - "+this.fm.i18n("Increase/decrease files selection")+"</li></ul></p><p>"+this.fm.i18n("Contacts us if you need help integrating elFinder in you products")+": dev@std42.ru</p>";c='<div class="el-finder-help-std"/><p>'+this.fm.i18n("Javascripts/PHP programming: Dmitry (dio) Levashov, dio@std42.ru")+"</p><p>"+this.fm.i18n("Python programming, techsupport: Troex Nevelin, troex@fury.scancode.ru")+"</p><p>"+this.fm.i18n("Design: Valentin Razumnih")+"</p><p>"+this.fm.i18n("Spanish localization")+': Alex (xand) Vavilin, xand@xand.es, <a href="http://xand.es" target="_blank">http://xand.es</a></p><p>'+this.fm.i18n("Icons")+': <a href="http://www.famfamfam.com/lab/icons/silk/" target="_blank">Famfam silk icons</a>, <a href="http://www.fatcow.com/free-icons/" target="_blank">Fatcow icons</a></p><p>'+this.fm.i18n('Copyright: <a href="http://www.std42.ru" target="_blank">Studio 42 LTD</a>')+"</p><p>"+this.fm.i18n("License: BSD License")+"</p><p>"+this.fm.i18n('Web site: <a href="http://www.elrte.ru/elfinder/" target="_blank">elrte.ru</a>')+"</p>";i='<div class="el-finder-logo"/><strong><a href="http://www.eldorado-cms.ru" target="_blank">ELDORADO.CMS</a></strong><br/>'+this.fm.i18n("Simple and usefull Content Management System")+"<hr/>"+this.fm.i18n("Support project development and we will place here info about you");g='<ul><li><a href="#el-finder-help-h">'+this.fm.i18n("Help")+'</a></li><li><a href="#el-finder-help-a">'+this.fm.i18n("Authors")+'</a><li><a href="#el-finder-help-sp">'+this.fm.i18n("Sponsors")+'</a></li></ul><div id="el-finder-help-h"><p>'+j+'</p></div><div id="el-finder-help-a"><p>'+c+'</p></div><div id="el-finder-help-sp"><p>'+i+"</p></div>";var k=a("<div/>").html(g).dialog({width:617,title:this.fm.i18n("Help"),dialogClass:"el-finder-dialog",modal:true,close:function(){k.tabs("destroy").dialog("destroy").remove()},buttons:{Ok:function(){a(this).dialog("close")}}}).tabs()};this.cm=function(c){return c=="cwd"}}}})(jQuery);(function(a){elFinder.prototype.quickLook=function(l,b){var p=this;this.fm=l;this._hash="";this.title=a("<strong/>");this.ico=a("<p/>");this.info=a("<label/>");this.media=a('<div class="el-finder-ql-media"/>').hide();this.name=a('<span class="el-finder-ql-name"/>');this.kind=a('<span class="el-finder-ql-kind"/>');this.size=a('<span class="el-finder-ql-size"/>');this.date=a('<span class="el-finder-ql-date"/>');this.url=a('<a href="#"/>').hide().click(function(i){i.preventDefault();window.open(a(this).attr("href"));p.hide()});this.add=a("<div/>");this.content=a('<div class="el-finder-ql-content"/>');this.win=a('<div class="el-finder-ql"/>').hide().append(a('<div class="el-finder-ql-drag-handle"/>').append(a('<span class="ui-icon ui-icon-circle-close"/>').click(function(){p.hide()})).append(this.title)).append(this.ico).append(this.media).append(this.content.append(this.name).append(this.kind).append(this.size).append(this.date).append(this.url).append(this.add)).appendTo(document.body).draggable({handle:".el-finder-ql-drag-handle"}).resizable({minWidth:420,minHeight:150,resize:function(){if(p.media.children().length){var m=p.media.children(":first");switch(m[0].nodeName){case"IMG":var e=m.width(),n=m.height(),i=p.win.width(),s=p.win.css("height")=="auto"?350:p.win.height()-p.content.height()-p.th,q=e>i||n>s?Math.min(Math.min(i,e)/e,Math.min(s,n)/n):Math.min(Math.max(i,e)/e,Math.max(s,n)/n);m.css({width:Math.round(m.width()*q),height:Math.round(m.height()*q)});break;case"IFRAME":case"EMBED":m.css("height",p.win.height()-p.content.height()-p.th);break;case"OBJECT":m.children("embed").css("height",p.win.height()-p.content.height()-p.th)}}}});this.th=parseInt(this.win.children(":first").css("height"))||18;this.mimes={"image/jpeg":"jpg","image/gif":"gif","image/png":"png"};for(var h=0;h<navigator.mimeTypes.length;h++){var o=navigator.mimeTypes[h].type;if(o&&o!="*"){this.mimes[o]=navigator.mimeTypes[h].suffixes}}if((a.browser.safari&&navigator.platform.indexOf("Mac")!=-1)||a.browser.msie){this.mimes["application/pdf"]="pdf"}else{for(var c=0;c<navigator.plugins.length;c++){for(var d=0;d<navigator.plugins[c].length;d++){var k=navigator.plugins[c][d].description.toLowerCase();if(k.substring(0,k.indexOf(" "))=="pdf"){this.mimes["application/pdf"]="pdf";break}}}}if(this.mimes["image/x-bmp"]){this.mimes["image/x-ms-bmp"]="bmp"}if(a.browser.msie&&!this.mimes["application/x-shockwave-flash"]){this.mimes["application/x-shockwave-flash"]="swf"}this.show=function(){if(this.win.is(":hidden")&&p.fm.selected.length==1){g();var m=p.fm.selected[0],e=p.fm.view.cwd.find('[key="'+m+'"]'),i=e.offset();p.fm.lockShortcuts(true);this.win.css({width:e.width()-20,height:e.height(),left:i.left,top:i.top,opacity:0}).animate({width:420,height:150,opacity:1,top:Math.round(a(window).height()/5),left:a(window).width()/2-210},450,function(){p.win.css({height:"auto"});p.fm.lockShortcuts()})}};this.hide=function(){if(this.win.is(":visible")){var i,e=p.fm.view.cwd.find('[key="'+this._hash+'"]');if(e){i=e.offset();this.media.hide(200);this.win.animate({width:e.width()-20,height:e.height(),left:i.left,top:i.top,opacity:0},350,function(){p.fm.lockShortcuts();j();p.win.hide().css("height","auto")})}else{this.win.fadeOut(200);j();p.fm.lockShortcuts()}}};this.toggle=function(){if(this.win.is(":visible")){this.hide()}else{this.show()}};this.update=function(){if(this.fm.selected.length!=1){this.hide()}else{if(this.win.is(":visible")&&this.fm.selected[0]!=this._hash){g()}}};this.mediaHeight=function(){return this.win.is(":animated")||this.win.css("height")=="auto"?315:this.win.height()-this.content.height()-this.th};function j(){p.media.hide().empty();p.win.attr("class","el-finder-ql").css("z-index",p.fm.zIndex);p.title.empty();p.ico.removeAttr("style").show();p.add.hide().empty();p._hash=""}function g(){var m=p.fm.getSelected(0);j();p._hash=m.hash;p.title.text(m.name);p.win.addClass(p.fm.view.mime2class(m.mime));p.name.text(m.name);p.kind.text(p.fm.view.mime2kind(m.link?"symlink":m.mime));p.size.text(p.fm.view.formatSize(m.size));p.date.text(p.fm.i18n("Modified")+": "+p.fm.view.formatDate(m.date));m.dim&&p.add.append("<span>"+m.dim+" px</span>").show();m.tmb&&p.ico.css("background",'url("'+m.tmb+'") 0 0 no-repeat');if(m.url){p.url.text(m.url).attr("href",m.url).show();for(var e in p.plugins){if(p.plugins[e].test&&p.plugins[e].test(m.mime,p.mimes,m.name)){p.plugins[e].show(p,m);return}}}else{p.url.hide()}p.win.css({width:"420px",height:"auto"})}};elFinder.prototype.quickLook.prototype.plugins={image:new function(){this.test=function(c,b){return c.match(/^image\//)};this.show=function(e,d){var b,c;if(e.mimes[d.mime]&&d.hash==e._hash){a("<img/>").hide().appendTo(e.media.show()).attr("src",d.url+(a.browser.msie||a.browser.opera?"?"+Math.random():"")).load(function(){c=a(this).unbind("load");if(d.hash==e._hash){e.win.is(":animated")?setTimeout(function(){g(c)},330):g(c)}})}function g(k){var j=k.width(),m=k.height(),i=e.win.is(":animated"),l=i?420:e.win.width(),o=i||e.win.css("height")=="auto"?315:e.win.height()-e.content.height()-e.th,n=j>l||m>o?Math.min(Math.min(l,j)/j,Math.min(o,m)/m):Math.min(Math.max(l,j)/j,Math.max(o,m)/m);e.fm.lockShortcuts(true);e.ico.hide();k.css({width:e.ico.width(),height:e.ico.height()}).animate({width:Math.round(n*j),height:Math.round(n*m)},450,function(){e.fm.lockShortcuts()})}}},text:new function(){this.test=function(c,b){return(c.indexOf("text")==0&&c.indexOf("rtf")==-1)||c.match(/application\/(xml|javascript|json)/)};this.show=function(c,b){if(b.hash==c._hash){c.ico.hide();c.media.append('<iframe src="'+b.url+'" style="height:'+c.mediaHeight()+'px" />').show()}}},swf:new function(){this.test=function(c,b){return c=="application/x-shockwave-flash"&&b[c]};this.show=function(c,b){if(b.hash==c._hash){c.ico.hide();var d=c.media.append('<embed pluginspage="http://www.macromedia.com/go/getflashplayer" quality="high" src="'+b.url+'" style="width:100%;height:'+c.mediaHeight()+'px" type="application/x-shockwave-flash" />');if(c.win.is(":animated")){d.slideDown(450)}else{d.show()}}}},audio:new function(){this.test=function(c,b){return c.indexOf("audio")==0&&b[c]};this.show=function(d,c){if(c.hash==d._hash){d.ico.hide();var b=d.win.is(":animated")||d.win.css("height")=="auto"?100:d.win.height()-d.content.height()-d.th;d.media.append('<embed src="'+c.url+'" style="width:100%;height:'+b+'px" />').show()}}},video:new function(){this.test=function(c,b){return c.indexOf("video")==0&&b[c]};this.show=function(c,b){if(b.hash==c._hash){c.ico.hide();c.media.append('<embed src="'+b.url+'" style="width:100%;height:'+c.mediaHeight()+'px" />').show()}}},pdf:new function(){this.test=function(c,b){return c=="application/pdf"&&b[c]};this.show=function(c,b){if(b.hash==c._hash){c.ico.hide();c.media.append('<embed src="'+b.url+'" style="width:100%;height:'+c.mediaHeight()+'px" />').show()}}}}})(jQuery);(function(a){elFinder.prototype.eventsManager=function(d,c){var b=this;this.lock=false;this.fm=d;this.ui=d.ui;this.tree=d.view.tree;this.cwd=d.view.cwd;this.pointer="";this.init=function(){this.cwd.bind("click",function(h){var g=a(h.target);if(g.hasClass("ui-selected")){b.fm.unselectAll()}else{if(!g.attr("key")){g=g.parent("[key]")}if(h.ctrlKey||h.metaKey){b.fm.toggleSelect(g)}else{b.fm.select(g,true)}}}).bind(window.opera?"click":"contextmenu",function(h){if(window.opera&&!h.ctrlKey){return}var g=a(h.target);h.preventDefault();h.stopPropagation();if(g.hasClass("el-finder-cwd")){b.fm.unselectAll()}else{b.fm.select(g.attr("key")?g:g.parent("[key]"))}b.fm.quickLook.hide();b.fm.ui.showMenu(h)}).selectable({filter:"[key]",delay:300,stop:function(){b.fm.updateSelect()}});a(document).bind("click",function(){b.fm.ui.hideMenu();a("input",b.cwd).trigger("change")});this.tree.bind("select",function(g){b.tree.find("a").removeClass("selected");a(g.target).addClass("selected").parents("li:has(ul)").children("ul").show().prev().children("div").addClass("expanded")});if(this.fm.options.places){this.fm.view.plc.click(function(k){k.preventDefault();var i=a(k.target),j=i.attr("key"),g;if(j){j!=b.fm.cwd.hash&&b.ui.exec("open",k.target)}else{if(k.target.nodeName=="A"||k.target.nodeName=="DIV"){g=b.fm.view.plc.find("ul");if(g.children().length){g.toggle(300);b.fm.view.plc.children("li").find("div").toggleClass("expanded")}}}});this.fm.view.plc.droppable({accept:"(div,tr).directory",tolerance:"pointer",over:function(){a(this).addClass("el-finder-droppable")},out:function(){a(this).removeClass("el-finder-droppable")},drop:function(i,h){a(this).removeClass("el-finder-droppable");var g=false;h.helper.children(".directory:not(.noaccess,.dropbox)").each(function(){if(b.fm.addPlace(a(this).attr("key"))){g=true;a(this).hide()}});if(g){b.fm.view.renderPlaces();b.updatePlaces();b.fm.view.plc.children("li").children("div").trigger("click")}if(!h.helper.children("div:visible").length){h.helper.hide()}}})}a(document).bind(a.browser.mozilla||a.browser.opera?"keypress":"keydown",function(h){var g=h.ctrlKey||h.metaKey;if(b.lock){return}switch(h.keyCode){case 37:case 38:h.stopPropagation();h.preventDefault();if(h.keyCode==37&&g){b.ui.execIfAllowed("back")}else{e(false,!h.shiftKey)}break;case 39:case 40:h.stopPropagation();h.preventDefault();if(g){b.ui.execIfAllowed("open")}else{e(true,!h.shiftKey)}break}});a(document).bind(a.browser.opera?"keypress":"keydown",function(g){if(b.lock){return}switch(g.keyCode){case 32:g.preventDefault();g.stopPropagation();b.fm.quickLook.toggle();break;case 27:b.fm.quickLook.hide();break}});if(!this.fm.options.disableShortcuts){a(document).bind("keydown",function(h){var g=h.ctrlKey||h.metaKey;if(b.lock){return}switch(h.keyCode){case 8:if(g&&b.ui.isCmdAllowed("rm")){h.preventDefault();b.ui.exec("rm")}break;case 13:if(b.ui.isCmdAllowed("select")){return b.ui.exec("select")}b.ui.execIfAllowed("open");break;case 46:b.ui.execIfAllowed("rm");break;case 65:if(g){h.preventDefault();b.fm.selectAll()}break;case 67:g&&b.ui.execIfAllowed("copy");break;case 73:if(g){h.preventDefault();b.ui.exec("info")}break;case 78:if(g){h.preventDefault();b.ui.execIfAllowed("mkdir")}break;case 85:if(g){h.preventDefault();b.ui.execIfAllowed("upload")}break;case 86:g&&b.ui.execIfAllowed("paste");break;case 88:g&&b.ui.execIfAllowed("cut");break;case 113:b.ui.execIfAllowed("rename");break}})}};this.updateNav=function(){a("a",this.tree).click(function(h){h.preventDefault();var g=a(this),i;if(h.target.nodeName=="DIV"&&a(h.target).hasClass("collapsed")){a(h.target).toggleClass("expanded").parent().next("ul").toggle(300)}else{if(g.attr("key")!=b.fm.cwd.hash){if(g.hasClass("noaccess")||g.hasClass("dropbox")){b.fm.view.error("Access denied")}else{b.ui.exec("open",g.trigger("select")[0])}}else{i=g.children(".collapsed");if(i.length){i.toggleClass("expanded");g.next("ul").toggle(300)}}}});a("a:not(.noaccess,.readonly)",this.tree).droppable({tolerance:"pointer",accept:"(div,tr)[key]",over:function(){a(this).addClass("el-finder-droppable")},out:function(){a(this).removeClass("el-finder-droppable")},drop:function(h,g){a(this).removeClass("el-finder-droppable");b.fm.drop(h,g,a(this).attr("key"))}});this.fm.options.places&&this.updatePlaces()};this.updatePlaces=function(){this.fm.view.plc.children("li").find("li").draggable({scroll:false,stop:function(){if(b.fm.removePlace(a(this).children("a").attr("key"))){a(this).remove();if(!a("li",b.fm.view.plc.children("li")).length){b.fm.view.plc.children("li").find("div").removeClass("collapsed expanded").end().children("ul").hide()}}}})};this.updateCwd=function(){a("[key]",this.cwd).bind("dblclick",function(g){b.fm.select(a(this),true);b.ui.exec(b.ui.isCmdAllowed("select")?"select":"open")}).draggable({delay:3,addClasses:false,appendTo:".el-finder-cwd",revert:true,drag:function(h,g){g.helper.toggleClass("el-finder-drag-copy",h.shiftKey||h.ctrlKey)},helper:function(){var g=a(this),i=a('<div class="el-finder-drag-helper"/>'),j=0;!g.hasClass("ui-selected")&&b.fm.select(g,true);b.cwd.find(".ui-selected").each(function(h){var k=b.fm.options.view=="icons"?a(this).clone().removeClass("ui-selected"):a(b.fm.view.renderIcon(b.fm.cdc[a(this).attr("key")]));if(j++==0||j%12==0){k.css("margin-left",0)}i.append(k)});return i.css("width",(j<=12?85+(j-1)*29:387)+"px")}}).filter(".directory").droppable({tolerance:"pointer",accept:"(div,tr)[key]",over:function(){a(this).addClass("el-finder-droppable")},out:function(){a(this).removeClass("el-finder-droppable")},drop:function(h,g){a(this).removeClass("el-finder-droppable");b.fm.drop(h,g,a(this).attr("key"))}});if(a.browser.msie){a("*",this.cwd).attr("unselectable","on").filter("[key]").bind("dragstart",function(){b.cwd.selectable("disable").removeClass("ui-state-disabled ui-selectable-disabled")}).bind("dragstop",function(){b.cwd.selectable("enable")})}};function e(h,i){var j,g,k;if(!a("[key]",b.cwd).length){return}if(b.fm.selected.length==0){j=a("[key]:"+(h?"first":"last"),b.cwd);b.fm.select(j)}else{if(i){j=a(".ui-selected:"+(h?"last":"first"),b.cwd);g=j[h?"next":"prev"]("[key]");if(g.length){j=g}b.fm.select(j,true)}else{if(b.pointer){k=a('[key="'+b.pointer+'"].ui-selected',b.cwd)}if(!k||!k.length){k=a(".ui-selected:"+(h?"last":"first"),b.cwd)}j=k[h?"next":"prev"]("[key]");if(!j.length){j=k}else{if(!j.hasClass("ui-selected")){b.fm.select(j)}else{if(!k.hasClass("ui-selected")){b.fm.unselect(j)}else{g=k[h?"prev":"next"]("[key]");if(!g.length||!g.hasClass("ui-selected")){b.fm.unselect(k)}else{while((g=h?j.next("[key]"):j.prev("[key]"))&&j.hasClass("ui-selected")){j=g}b.fm.select(j)}}}}}}b.pointer=j.attr("key");b.fm.checkSelectedPos(h)}}})(jQuery);(function($,window,document){$.fn.dataTableSettings=[];var _aoSettings=$.fn.dataTableSettings;$.fn.dataTableExt={};var _oExt=$.fn.dataTableExt;_oExt.sVersion="1.8.1";_oExt.sErrMode="alert";_oExt.iApiIndex=0;_oExt.oApi={};_oExt.afnFiltering=[];_oExt.aoFeatures=[];_oExt.ofnSearch={};_oExt.afnSortData=[];_oExt.oStdClasses={"sPagePrevEnabled":"paginate_enabled_previous","sPagePrevDisabled":"paginate_disabled_previous","sPageNextEnabled":"paginate_enabled_next","sPageNextDisabled":"paginate_disabled_next","sPageJUINext":"","sPageJUIPrev":"","sPageButton":"paginate_button","sPageButtonActive":"paginate_active","sPageButtonStaticDisabled":"paginate_button paginate_button_disabled","sPageFirst":"first","sPagePrevious":"previous","sPageNext":"next","sPageLast":"last","sStripOdd":"odd","sStripEven":"even","sRowEmpty":"dataTables_empty","sWrapper":"dataTables_wrapper","sFilter":"dataTables_filter","sInfo":"dataTables_info","sPaging":"dataTables_paginate paging_","sLength":"dataTables_length","sProcessing":"dataTables_processing","sSortAsc":"sorting_asc","sSortDesc":"sorting_desc","sSortable":"sorting","sSortableAsc":"sorting_asc_disabled","sSortableDesc":"sorting_desc_disabled","sSortableNone":"sorting_disabled","sSortColumn":"sorting_","sSortJUIAsc":"","sSortJUIDesc":"","sSortJUI":"","sSortJUIAscAllowed":"","sSortJUIDescAllowed":"","sSortJUIWrapper":"","sSortIcon":"","sScrollWrapper":"dataTables_scroll","sScrollHead":"dataTables_scrollHead","sScrollHeadInner":"dataTables_scrollHeadInner","sScrollBody":"dataTables_scrollBody","sScrollFoot":"dataTables_scrollFoot","sScrollFootInner":"dataTables_scrollFootInner","sFooterTH":""};_oExt.oJUIClasses={"sPagePrevEnabled":"fg-button ui-button ui-state-default ui-corner-left","sPagePrevDisabled":"fg-button ui-button ui-state-default ui-corner-left ui-state-disabled","sPageNextEnabled":"fg-button ui-button ui-state-default ui-corner-right","sPageNextDisabled":"fg-button ui-button ui-state-default ui-corner-right ui-state-disabled","sPageJUINext":"ui-icon ui-icon-circle-arrow-e","sPageJUIPrev":"ui-icon ui-icon-circle-arrow-w","sPageButton":"fg-button ui-button ui-state-default","sPageButtonActive":"fg-button ui-button ui-state-default ui-state-disabled","sPageButtonStaticDisabled":"fg-button ui-button ui-state-default ui-state-disabled","sPageFirst":"first ui-corner-tl ui-corner-bl","sPagePrevious":"previous","sPageNext":"next","sPageLast":"last ui-corner-tr ui-corner-br","sStripOdd":"odd","sStripEven":"even","sRowEmpty":"dataTables_empty","sWrapper":"dataTables_wrapper","sFilter":"dataTables_filter","sInfo":"dataTables_info","sPaging":"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi "+"ui-buttonset-multi paging_","sLength":"dataTables_length","sProcessing":"dataTables_processing","sSortAsc":"ui-state-default","sSortDesc":"ui-state-default","sSortable":"ui-state-default","sSortableAsc":"ui-state-default","sSortableDesc":"ui-state-default","sSortableNone":"ui-state-default","sSortColumn":"sorting_","sSortJUIAsc":"css_right ui-icon ui-icon-triangle-1-n","sSortJUIDesc":"css_right ui-icon ui-icon-triangle-1-s","sSortJUI":"css_right ui-icon ui-icon-carat-2-n-s","sSortJUIAscAllowed":"css_right ui-icon ui-icon-carat-1-n","sSortJUIDescAllowed":"css_right ui-icon ui-icon-carat-1-s","sSortJUIWrapper":"DataTables_sort_wrapper","sSortIcon":"DataTables_sort_icon","sScrollWrapper":"dataTables_scroll","sScrollHead":"dataTables_scrollHead ui-state-default","sScrollHeadInner":"dataTables_scrollHeadInner","sScrollBody":"dataTables_scrollBody","sScrollFoot":"dataTables_scrollFoot ui-state-default","sScrollFootInner":"dataTables_scrollFootInner","sFooterTH":"ui-state-default"};_oExt.oPagination={"two_button":{"fnInit":function(oSettings,nPaging,fnCallbackDraw){var nPrevious,nNext,nPreviousInner,nNextInner;if(!oSettings.bJUI){nPrevious=document.createElement('div');nNext=document.createElement('div')}else{nPrevious=document.createElement('a');nNext=document.createElement('a');nNextInner=document.createElement('span');nNextInner.className=oSettings.oClasses.sPageJUINext;nNext.appendChild(nNextInner);nPreviousInner=document.createElement('span');nPreviousInner.className=oSettings.oClasses.sPageJUIPrev;nPrevious.appendChild(nPreviousInner)}nPrevious.className=oSettings.oClasses.sPagePrevDisabled;nNext.className=oSettings.oClasses.sPageNextDisabled;nPrevious.title=oSettings.oLanguage.oPaginate.sPrevious;nNext.title=oSettings.oLanguage.oPaginate.sNext;nPaging.appendChild(nPrevious);nPaging.appendChild(nNext);$(nPrevious).bind('click.DT',function(){if(oSettings.oApi._fnPageChange(oSettings,"previous")){fnCallbackDraw(oSettings)}});$(nNext).bind('click.DT',function(){if(oSettings.oApi._fnPageChange(oSettings,"next")){fnCallbackDraw(oSettings)}});$(nPrevious).bind('selectstart.DT',function(){return false});$(nNext).bind('selectstart.DT',function(){return false});if(oSettings.sTableId!==''&&typeof oSettings.aanFeatures.p=="undefined"){nPaging.setAttribute('id',oSettings.sTableId+'_paginate');nPrevious.setAttribute('id',oSettings.sTableId+'_previous');nNext.setAttribute('id',oSettings.sTableId+'_next')}},"fnUpdate":function(oSettings,fnCallbackDraw){if(!oSettings.aanFeatures.p){return}var an=oSettings.aanFeatures.p;for(var i=0,iLen=an.length;i<iLen;i++){if(an[i].childNodes.length!==0){an[i].childNodes[0].className=(oSettings._iDisplayStart===0)?oSettings.oClasses.sPagePrevDisabled:oSettings.oClasses.sPagePrevEnabled;an[i].childNodes[1].className=(oSettings.fnDisplayEnd()==oSettings.fnRecordsDisplay())?oSettings.oClasses.sPageNextDisabled:oSettings.oClasses.sPageNextEnabled}}}},"iFullNumbersShowPages":5,"full_numbers":{"fnInit":function(oSettings,nPaging,fnCallbackDraw){var nFirst=document.createElement('span');var nPrevious=document.createElement('span');var nList=document.createElement('span');var nNext=document.createElement('span');var nLast=document.createElement('span');nFirst.innerHTML=oSettings.oLanguage.oPaginate.sFirst;nPrevious.innerHTML=oSettings.oLanguage.oPaginate.sPrevious;nNext.innerHTML=oSettings.oLanguage.oPaginate.sNext;nLast.innerHTML=oSettings.oLanguage.oPaginate.sLast;var oClasses=oSettings.oClasses;nFirst.className=oClasses.sPageButton+" "+oClasses.sPageFirst;nPrevious.className=oClasses.sPageButton+" "+oClasses.sPagePrevious;nNext.className=oClasses.sPageButton+" "+oClasses.sPageNext;nLast.className=oClasses.sPageButton+" "+oClasses.sPageLast;nPaging.appendChild(nFirst);nPaging.appendChild(nPrevious);nPaging.appendChild(nList);nPaging.appendChild(nNext);nPaging.appendChild(nLast);$(nFirst).bind('click.DT',function(){if(oSettings.oApi._fnPageChange(oSettings,"first")){fnCallbackDraw(oSettings)}});$(nPrevious).bind('click.DT',function(){if(oSettings.oApi._fnPageChange(oSettings,"previous")){fnCallbackDraw(oSettings)}});$(nNext).bind('click.DT',function(){if(oSettings.oApi._fnPageChange(oSettings,"next")){fnCallbackDraw(oSettings)}});$(nLast).bind('click.DT',function(){if(oSettings.oApi._fnPageChange(oSettings,"last")){fnCallbackDraw(oSettings)}});$('span',nPaging).bind('mousedown.DT',function(){return false}).bind('selectstart.DT',function(){return false});if(oSettings.sTableId!==''&&typeof oSettings.aanFeatures.p=="undefined"){nPaging.setAttribute('id',oSettings.sTableId+'_paginate');nFirst.setAttribute('id',oSettings.sTableId+'_first');nPrevious.setAttribute('id',oSettings.sTableId+'_previous');nNext.setAttribute('id',oSettings.sTableId+'_next');nLast.setAttribute('id',oSettings.sTableId+'_last')}},"fnUpdate":function(oSettings,fnCallbackDraw){if(!oSettings.aanFeatures.p){return}var iPageCount=_oExt.oPagination.iFullNumbersShowPages;var iPageCountHalf=Math.floor(iPageCount/2);var iPages=Math.ceil((oSettings.fnRecordsDisplay())/oSettings._iDisplayLength);var iCurrentPage=Math.ceil(oSettings._iDisplayStart/oSettings._iDisplayLength)+1;var sList="";var iStartButton,iEndButton,i,iLen;var oClasses=oSettings.oClasses;if(iPages<iPageCount){iStartButton=1;iEndButton=iPages}else{if(iCurrentPage<=iPageCountHalf){iStartButton=1;iEndButton=iPageCount}else{if(iCurrentPage>=(iPages-iPageCountHalf)){iStartButton=iPages-iPageCount+1;iEndButton=iPages}else{iStartButton=iCurrentPage-Math.ceil(iPageCount/2)+1;iEndButton=iStartButton+iPageCount-1}}}for(i=iStartButton;i<=iEndButton;i++){if(iCurrentPage!=i){sList+='<span class="'+oClasses.sPageButton+'">'+i+'</span>'}else{sList+='<span class="'+oClasses.sPageButtonActive+'">'+i+'</span>'}}var an=oSettings.aanFeatures.p;var anButtons,anStatic,nPaginateList;var fnClick=function(e){var iTarget=(this.innerHTML*1)-1;oSettings._iDisplayStart=iTarget*oSettings._iDisplayLength;fnCallbackDraw(oSettings);e.preventDefault()};var fnFalse=function(){return false};for(i=0,iLen=an.length;i<iLen;i++){if(an[i].childNodes.length===0){continue}var qjPaginateList=$('span:eq(2)',an[i]);qjPaginateList.html(sList);$('span',qjPaginateList).bind('click.DT',fnClick).bind('mousedown.DT',fnFalse).bind('selectstart.DT',fnFalse);anButtons=an[i].getElementsByTagName('span');anStatic=[anButtons[0],anButtons[1],anButtons[anButtons.length-2],anButtons[anButtons.length-1]];$(anStatic).removeClass(oClasses.sPageButton+" "+oClasses.sPageButtonActive+" "+oClasses.sPageButtonStaticDisabled);if(iCurrentPage==1){anStatic[0].className+=" "+oClasses.sPageButtonStaticDisabled;anStatic[1].className+=" "+oClasses.sPageButtonStaticDisabled}else{anStatic[0].className+=" "+oClasses.sPageButton;anStatic[1].className+=" "+oClasses.sPageButton}if(iPages===0||iCurrentPage==iPages||oSettings._iDisplayLength==-1){anStatic[2].className+=" "+oClasses.sPageButtonStaticDisabled;anStatic[3].className+=" "+oClasses.sPageButtonStaticDisabled}else{anStatic[2].className+=" "+oClasses.sPageButton;anStatic[3].className+=" "+oClasses.sPageButton}}}}};_oExt.oSort={"string-asc":function(a,b){if(typeof a!='string'){a=''}if(typeof b!='string'){b=''}var x=a.toLowerCase();var y=b.toLowerCase();return((x<y)?-1:((x>y)?1:0))},"string-desc":function(a,b){if(typeof a!='string'){a=''}if(typeof b!='string'){b=''}var x=a.toLowerCase();var y=b.toLowerCase();return((x<y)?1:((x>y)?-1:0))},"html-asc":function(a,b){var x=a.replace(/<.*?>/g,"").toLowerCase();var y=b.replace(/<.*?>/g,"").toLowerCase();return((x<y)?-1:((x>y)?1:0))},"html-desc":function(a,b){var x=a.replace(/<.*?>/g,"").toLowerCase();var y=b.replace(/<.*?>/g,"").toLowerCase();return((x<y)?1:((x>y)?-1:0))},"date-asc":function(a,b){var x=Date.parse(a);var y=Date.parse(b);if(isNaN(x)||x===""){x=Date.parse("01/01/1970 00:00:00")}if(isNaN(y)||y===""){y=Date.parse("01/01/1970 00:00:00")}return x-y},"date-desc":function(a,b){var x=Date.parse(a);var y=Date.parse(b);if(isNaN(x)||x===""){x=Date.parse("01/01/1970 00:00:00")}if(isNaN(y)||y===""){y=Date.parse("01/01/1970 00:00:00")}return y-x},"numeric-asc":function(a,b){var x=(a=="-"||a==="")?0:a*1;var y=(b=="-"||b==="")?0:b*1;return x-y},"numeric-desc":function(a,b){var x=(a=="-"||a==="")?0:a*1;var y=(b=="-"||b==="")?0:b*1;return y-x}};_oExt.aTypes=[function(sData){if(typeof sData=='number'){return'numeric'}else if(typeof sData!='string'){return null}var sValidFirstChars="0123456789-";var sValidChars="0123456789.";var Char;var bDecimal=false;Char=sData.charAt(0);if(sValidFirstChars.indexOf(Char)==-1){return null}for(var i=1;i<sData.length;i++){Char=sData.charAt(i);if(sValidChars.indexOf(Char)==-1){return null}if(Char=="."){if(bDecimal){return null}bDecimal=true}}return'numeric'},function(sData){var iParse=Date.parse(sData);if((iParse!==null&&!isNaN(iParse))||(typeof sData=='string'&&sData.length===0)){return'date'}return null},function(sData){if(typeof sData=='string'&&sData.indexOf('<')!=-1&&sData.indexOf('>')!=-1){return'html'}return null}];_oExt.fnVersionCheck=function(sVersion){var fnZPad=function(Zpad,count){while(Zpad.length<count){Zpad+='0'}return Zpad};var aThis=_oExt.sVersion.split('.');var aThat=sVersion.split('.');var sThis='',sThat='';for(var i=0,iLen=aThat.length;i<iLen;i++){sThis+=fnZPad(aThis[i],3);sThat+=fnZPad(aThat[i],3)}return parseInt(sThis,10)>=parseInt(sThat,10)};_oExt._oExternConfig={"iNextUnique":0};$.fn.dataTable=function(oInit){function classSettings(){this.fnRecordsTotal=function(){if(this.oFeatures.bServerSide){return parseInt(this._iRecordsTotal,10)}else{return this.aiDisplayMaster.length}};this.fnRecordsDisplay=function(){if(this.oFeatures.bServerSide){return parseInt(this._iRecordsDisplay,10)}else{return this.aiDisplay.length}};this.fnDisplayEnd=function(){if(this.oFeatures.bServerSide){if(this.oFeatures.bPaginate===false||this._iDisplayLength==-1){return this._iDisplayStart+this.aiDisplay.length}else{return Math.min(this._iDisplayStart+this._iDisplayLength,this._iRecordsDisplay)}}else{return this._iDisplayEnd}};this.oInstance=null;this.sInstance=null;this.oFeatures={"bPaginate":true,"bLengthChange":true,"bFilter":true,"bSort":true,"bInfo":true,"bAutoWidth":true,"bProcessing":false,"bSortClasses":true,"bStateSave":false,"bServerSide":false,"bDeferRender":false};this.oScroll={"sX":"","sXInner":"","sY":"","bCollapse":false,"bInfinite":false,"iLoadGap":100,"iBarWidth":0,"bAutoCss":true};this.aanFeatures=[];this.oLanguage={"sProcessing":"Processing...","sLengthMenu":"Show _MENU_ entries","sZeroRecords":"No matching records found","sEmptyTable":"No data available in table","sLoadingRecords":"Loading...","sInfo":"Showing _START_ to _END_ of _TOTAL_ entries","sInfoEmpty":"Showing 0 to 0 of 0 entries","sInfoFiltered":"(filtered from _MAX_ total entries)","sInfoPostFix":"","sSearch":"Search:","sUrl":"","oPaginate":{"sFirst":"First","sPrevious":"Previous","sNext":"Next","sLast":"Last"},"fnInfoCallback":null};this.aoData=[];this.aiDisplay=[];this.aiDisplayMaster=[];this.aoColumns=[];this.aoHeader=[];this.aoFooter=[];this.iNextId=0;this.asDataSearch=[];this.oPreviousSearch={"sSearch":"","bRegex":false,"bSmart":true};this.aoPreSearchCols=[];this.aaSorting=[[0,'asc',0]];this.aaSortingFixed=null;this.asStripClasses=[];this.asDestoryStrips=[];this.sDestroyWidth=0;this.fnRowCallback=null;this.fnHeaderCallback=null;this.fnFooterCallback=null;this.aoDrawCallback=[];this.fnPreDrawCallback=null;this.fnInitComplete=null;this.sTableId="";this.nTable=null;this.nTHead=null;this.nTFoot=null;this.nTBody=null;this.nTableWrapper=null;this.bDeferLoading=false;this.bInitialised=false;this.aoOpenRows=[];this.sDom='lfrtip';this.sPaginationType="two_button";this.iCookieDuration=60*60*2;this.sCookiePrefix="SpryMedia_DataTables_";this.fnCookieCallback=null;this.aoStateSave=[];this.aoStateLoad=[];this.oLoadedState=null;this.sAjaxSource=null;this.sAjaxDataProp='aaData';this.bAjaxDataGet=true;this.jqXHR=null;this.fnServerData=function(url,data,callback,settings){settings.jqXHR=$.ajax({"url":url,"data":data,"success":callback,"dataType":"json","cache":false,"error":function(xhr,error,thrown){if(error=="parsererror"){alert("DataTables warning: JSON data from server could not be parsed. "+"This is caused by a JSON formatting error.")}}})};this.fnFormatNumber=function(iIn){if(iIn<1000){return iIn}else{var s=(iIn+""),a=s.split(""),out="",iLen=s.length;for(var i=0;i<iLen;i++){if(i%3===0&&i!==0){out=','+out}out=a[iLen-i-1]+out}}return out};this.aLengthMenu=[10,25,50,100];this.iDraw=0;this.bDrawing=0;this.iDrawError=-1;this._iDisplayLength=10;this._iDisplayStart=0;this._iDisplayEnd=10;this._iRecordsTotal=0;this._iRecordsDisplay=0;this.bJUI=false;this.oClasses=_oExt.oStdClasses;this.bFiltered=false;this.bSorted=false;this.bSortCellsTop=false;this.oInit=null}this.oApi={};this.fnDraw=function(bComplete){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);if(typeof bComplete!='undefined'&&bComplete===false){_fnCalculateEnd(oSettings);_fnDraw(oSettings)}else{_fnReDraw(oSettings)}};this.fnFilter=function(sInput,iColumn,bRegex,bSmart,bShowGlobal){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);if(!oSettings.oFeatures.bFilter){return}if(typeof bRegex=='undefined'){bRegex=false}if(typeof bSmart=='undefined'){bSmart=true}if(typeof bShowGlobal=='undefined'){bShowGlobal=true}if(typeof iColumn=="undefined"||iColumn===null){_fnFilterComplete(oSettings,{"sSearch":sInput,"bRegex":bRegex,"bSmart":bSmart},1);if(bShowGlobal&&typeof oSettings.aanFeatures.f!='undefined'){var n=oSettings.aanFeatures.f;for(var i=0,iLen=n.length;i<iLen;i++){$('input',n[i]).val(sInput)}}}else{oSettings.aoPreSearchCols[iColumn].sSearch=sInput;oSettings.aoPreSearchCols[iColumn].bRegex=bRegex;oSettings.aoPreSearchCols[iColumn].bSmart=bSmart;_fnFilterComplete(oSettings,oSettings.oPreviousSearch,1)}};this.fnSettings=function(nNode){return _fnSettingsFromNode(this[_oExt.iApiIndex])};this.fnVersionCheck=_oExt.fnVersionCheck;this.fnSort=function(aaSort){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);oSettings.aaSorting=aaSort;_fnSort(oSettings)};this.fnSortListener=function(nNode,iColumn,fnCallback){_fnSortAttachListener(_fnSettingsFromNode(this[_oExt.iApiIndex]),nNode,iColumn,fnCallback)};this.fnAddData=function(mData,bRedraw){if(mData.length===0){return[]}var aiReturn=[];var iTest;var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);if(typeof mData[0]=="object"){for(var i=0;i<mData.length;i++){iTest=_fnAddData(oSettings,mData[i]);if(iTest==-1){return aiReturn}aiReturn.push(iTest)}}else{iTest=_fnAddData(oSettings,mData);if(iTest==-1){return aiReturn}aiReturn.push(iTest)}oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();if(typeof bRedraw=='undefined'||bRedraw){_fnReDraw(oSettings)}return aiReturn};this.fnDeleteRow=function(mTarget,fnCallBack,bRedraw){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);var i,iAODataIndex;iAODataIndex=(typeof mTarget=='object')?_fnNodeToDataIndex(oSettings,mTarget):mTarget;var oData=oSettings.aoData.splice(iAODataIndex,1);var iDisplayIndex=$.inArray(iAODataIndex,oSettings.aiDisplay);oSettings.asDataSearch.splice(iDisplayIndex,1);_fnDeleteIndex(oSettings.aiDisplayMaster,iAODataIndex);_fnDeleteIndex(oSettings.aiDisplay,iAODataIndex);if(typeof fnCallBack=="function"){fnCallBack.call(this,oSettings,oData)}if(oSettings._iDisplayStart>=oSettings.aiDisplay.length){oSettings._iDisplayStart-=oSettings._iDisplayLength;if(oSettings._iDisplayStart<0){oSettings._iDisplayStart=0}}if(typeof bRedraw=='undefined'||bRedraw){_fnCalculateEnd(oSettings);_fnDraw(oSettings)}return oData};this.fnClearTable=function(bRedraw){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);_fnClearTable(oSettings);if(typeof bRedraw=='undefined'||bRedraw){_fnDraw(oSettings)}};this.fnOpen=function(nTr,mHtml,sClass){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);this.fnClose(nTr);var nNewRow=document.createElement("tr");var nNewCell=document.createElement("td");nNewRow.appendChild(nNewCell);nNewCell.className=sClass;nNewCell.colSpan=_fnVisbleColumns(oSettings);if(typeof mHtml.jquery!='undefined'||typeof mHtml=="object"){nNewCell.appendChild(mHtml)}else{nNewCell.innerHTML=mHtml}var nTrs=$('tr',oSettings.nTBody);if($.inArray(nTr,nTrs)!=-1){$(nNewRow).insertAfter(nTr)}oSettings.aoOpenRows.push({"nTr":nNewRow,"nParent":nTr});return nNewRow};this.fnClose=function(nTr){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);for(var i=0;i<oSettings.aoOpenRows.length;i++){if(oSettings.aoOpenRows[i].nParent==nTr){var nTrParent=oSettings.aoOpenRows[i].nTr.parentNode;if(nTrParent){nTrParent.removeChild(oSettings.aoOpenRows[i].nTr)}oSettings.aoOpenRows.splice(i,1);return 0}}return 1};this.fnGetData=function(mRow,iCol){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);if(typeof mRow!='undefined'){var iRow=(typeof mRow=='object')?_fnNodeToDataIndex(oSettings,mRow):mRow;if(typeof iCol!='undefined'){return _fnGetCellData(oSettings,iRow,iCol,'')}return(typeof oSettings.aoData[iRow]!='undefined')?oSettings.aoData[iRow]._aData:null}return _fnGetDataMaster(oSettings)};this.fnGetNodes=function(iRow){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);if(typeof iRow!='undefined'){return(typeof oSettings.aoData[iRow]!='undefined')?oSettings.aoData[iRow].nTr:null}return _fnGetTrNodes(oSettings)};this.fnGetPosition=function(nNode){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);var sNodeName=nNode.nodeName.toUpperCase();if(sNodeName=="TR"){return _fnNodeToDataIndex(oSettings,nNode)}else if(sNodeName=="TD"||sNodeName=="TH"){var iDataIndex=_fnNodeToDataIndex(oSettings,nNode.parentNode);var anCells=_fnGetTdNodes(oSettings,iDataIndex);for(var i=0;i<oSettings.aoColumns.length;i++){if(anCells[i]==nNode){return[iDataIndex,_fnColumnIndexToVisible(oSettings,i),i]}}}return null};this.fnUpdate=function(mData,mRow,iColumn,bRedraw,bAction){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);var iVisibleColumn,i,iLen,sDisplay;var iRow=(typeof mRow=='object')?_fnNodeToDataIndex(oSettings,mRow):mRow;if($.isArray(mData)&&typeof mData=='object'){oSettings.aoData[iRow]._aData=mData.slice();for(i=0;i<oSettings.aoColumns.length;i++){this.fnUpdate(_fnGetCellData(oSettings,iRow,i),iRow,i,false,false)}}else if(typeof mData=='object'){oSettings.aoData[iRow]._aData=$.extend(true,{},mData);for(i=0;i<oSettings.aoColumns.length;i++){this.fnUpdate(_fnGetCellData(oSettings,iRow,i),iRow,i,false,false)}}else{sDisplay=mData;_fnSetCellData(oSettings,iRow,iColumn,sDisplay);if(oSettings.aoColumns[iColumn].fnRender!==null){sDisplay=oSettings.aoColumns[iColumn].fnRender({"iDataRow":iRow,"iDataColumn":iColumn,"aData":oSettings.aoData[iRow]._aData,"oSettings":oSettings});if(oSettings.aoColumns[iColumn].bUseRendered){_fnSetCellData(oSettings,iRow,iColumn,sDisplay)}}if(oSettings.aoData[iRow].nTr!==null){_fnGetTdNodes(oSettings,iRow)[iColumn].innerHTML=sDisplay}}var iDisplayIndex=$.inArray(iRow,oSettings.aiDisplay);oSettings.asDataSearch[iDisplayIndex]=_fnBuildSearchRow(oSettings,_fnGetRowData(oSettings,iRow,'filter'));if(typeof bAction=='undefined'||bAction){_fnAjustColumnSizing(oSettings)}if(typeof bRedraw=='undefined'||bRedraw){_fnReDraw(oSettings)}return 0};this.fnSetColumnVis=function(iCol,bShow,bRedraw){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);var i,iLen;var iColumns=oSettings.aoColumns.length;var nTd,nCell,anTrs,jqChildren,bAppend,iBefore;if(oSettings.aoColumns[iCol].bVisible==bShow){return}if(bShow){var iInsert=0;for(i=0;i<iCol;i++){if(oSettings.aoColumns[i].bVisible){iInsert++}}bAppend=(iInsert>=_fnVisbleColumns(oSettings));if(!bAppend){for(i=iCol;i<iColumns;i++){if(oSettings.aoColumns[i].bVisible){iBefore=i;break}}}for(i=0,iLen=oSettings.aoData.length;i<iLen;i++){if(oSettings.aoData[i].nTr!==null){if(bAppend){oSettings.aoData[i].nTr.appendChild(oSettings.aoData[i]._anHidden[iCol])}else{oSettings.aoData[i].nTr.insertBefore(oSettings.aoData[i]._anHidden[iCol],_fnGetTdNodes(oSettings,i)[iBefore])}}}}else{for(i=0,iLen=oSettings.aoData.length;i<iLen;i++){if(oSettings.aoData[i].nTr!==null){nTd=_fnGetTdNodes(oSettings,i)[iCol];oSettings.aoData[i]._anHidden[iCol]=nTd;nTd.parentNode.removeChild(nTd)}}}oSettings.aoColumns[iCol].bVisible=bShow;_fnDrawHead(oSettings,oSettings.aoHeader);if(oSettings.nTFoot){_fnDrawHead(oSettings,oSettings.aoFooter)}for(i=0,iLen=oSettings.aoOpenRows.length;i<iLen;i++){oSettings.aoOpenRows[i].nTr.colSpan=_fnVisbleColumns(oSettings)}if(typeof bRedraw=='undefined'||bRedraw){_fnAjustColumnSizing(oSettings);_fnDraw(oSettings)}_fnSaveState(oSettings)};this.fnPageChange=function(sAction,bRedraw){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);_fnPageChange(oSettings,sAction);_fnCalculateEnd(oSettings);if(typeof bRedraw=='undefined'||bRedraw){_fnDraw(oSettings)}};this.fnDestroy=function(){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);var nOrig=oSettings.nTableWrapper.parentNode;var nBody=oSettings.nTBody;var i,iLen;oSettings.bDestroying=true;for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){if(oSettings.aoColumns[i].bVisible===false){this.fnSetColumnVis(i,true)}}$(oSettings.nTableWrapper).find('*').andSelf().unbind('.DT');$('tbody>tr>td.'+oSettings.oClasses.sRowEmpty,oSettings.nTable).parent().remove();if(oSettings.nTable!=oSettings.nTHead.parentNode){$('>thead',oSettings.nTable).remove();oSettings.nTable.appendChild(oSettings.nTHead)}if(oSettings.nTFoot&&oSettings.nTable!=oSettings.nTFoot.parentNode){$('>tfoot',oSettings.nTable).remove();oSettings.nTable.appendChild(oSettings.nTFoot)}oSettings.nTable.parentNode.removeChild(oSettings.nTable);$(oSettings.nTableWrapper).remove();oSettings.aaSorting=[];oSettings.aaSortingFixed=[];_fnSortingClasses(oSettings);$(_fnGetTrNodes(oSettings)).removeClass(oSettings.asStripClasses.join(' '));if(!oSettings.bJUI){$('th',oSettings.nTHead).removeClass([_oExt.oStdClasses.sSortable,_oExt.oStdClasses.sSortableAsc,_oExt.oStdClasses.sSortableDesc,_oExt.oStdClasses.sSortableNone].join(' '))}else{$('th',oSettings.nTHead).removeClass([_oExt.oStdClasses.sSortable,_oExt.oJUIClasses.sSortableAsc,_oExt.oJUIClasses.sSortableDesc,_oExt.oJUIClasses.sSortableNone].join(' '));$('th span.'+_oExt.oJUIClasses.sSortIcon,oSettings.nTHead).remove();$('th',oSettings.nTHead).each(function(){var jqWrapper=$('div.'+_oExt.oJUIClasses.sSortJUIWrapper,this);var kids=jqWrapper.contents();$(this).append(kids);jqWrapper.remove()})}if(oSettings.nTableReinsertBefore){nOrig.insertBefore(oSettings.nTable,oSettings.nTableReinsertBefore)}else{nOrig.appendChild(oSettings.nTable)}for(i=0,iLen=oSettings.aoData.length;i<iLen;i++){if(oSettings.aoData[i].nTr!==null){nBody.appendChild(oSettings.aoData[i].nTr)}}if(oSettings.oFeatures.bAutoWidth===true){oSettings.nTable.style.width=_fnStringToCss(oSettings.sDestroyWidth)}$('>tr:even',nBody).addClass(oSettings.asDestoryStrips[0]);$('>tr:odd',nBody).addClass(oSettings.asDestoryStrips[1]);for(i=0,iLen=_aoSettings.length;i<iLen;i++){if(_aoSettings[i]==oSettings){_aoSettings.splice(i,1)}}oSettings=null};this.fnAdjustColumnSizing=function(bRedraw){var oSettings=_fnSettingsFromNode(this[_oExt.iApiIndex]);_fnAjustColumnSizing(oSettings);if(typeof bRedraw=='undefined'||bRedraw){this.fnDraw(false)}else if(oSettings.oScroll.sX!==""||oSettings.oScroll.sY!==""){this.oApi._fnScrollDraw(oSettings)}};function _fnExternApiFunc(sFunc){return function(){var aArgs=[_fnSettingsFromNode(this[_oExt.iApiIndex])].concat(Array.prototype.slice.call(arguments));return _oExt.oApi[sFunc].apply(this,aArgs)}}for(var sFunc in _oExt.oApi){if(sFunc){this[sFunc]=_fnExternApiFunc(sFunc)}}function _fnInitalise(oSettings){var i,iLen,iAjaxStart=oSettings.iInitDisplayStart;if(oSettings.bInitialised===false){setTimeout(function(){_fnInitalise(oSettings)},200);return}_fnAddOptionsHtml(oSettings);_fnBuildHead(oSettings);_fnDrawHead(oSettings,oSettings.aoHeader);if(oSettings.nTFoot){_fnDrawHead(oSettings,oSettings.aoFooter)}_fnProcessingDisplay(oSettings,true);if(oSettings.oFeatures.bAutoWidth){_fnCalculateColumnWidths(oSettings)}for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){if(oSettings.aoColumns[i].sWidth!==null){oSettings.aoColumns[i].nTh.style.width=_fnStringToCss(oSettings.aoColumns[i].sWidth)}}if(oSettings.oFeatures.bSort){_fnSort(oSettings)}else if(oSettings.oFeatures.bFilter){_fnFilterComplete(oSettings,oSettings.oPreviousSearch)}else{oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();_fnCalculateEnd(oSettings);_fnDraw(oSettings)}if(oSettings.sAjaxSource!==null&&!oSettings.oFeatures.bServerSide){oSettings.fnServerData.call(oSettings.oInstance,oSettings.sAjaxSource,[],function(json){var aData=json;if(oSettings.sAjaxDataProp!==""){var fnDataSrc=_fnGetObjectDataFn(oSettings.sAjaxDataProp);aData=fnDataSrc(json)}for(i=0;i<aData.length;i++){_fnAddData(oSettings,aData[i])}oSettings.iInitDisplayStart=iAjaxStart;if(oSettings.oFeatures.bSort){_fnSort(oSettings)}else{oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();_fnCalculateEnd(oSettings);_fnDraw(oSettings)}_fnProcessingDisplay(oSettings,false);_fnInitComplete(oSettings,json)},oSettings);return}if(!oSettings.oFeatures.bServerSide){_fnProcessingDisplay(oSettings,false);_fnInitComplete(oSettings)}}function _fnInitComplete(oSettings,json){oSettings._bInitComplete=true;if(typeof oSettings.fnInitComplete=='function'){if(typeof json!='undefined'){oSettings.fnInitComplete.call(oSettings.oInstance,oSettings,json)}else{oSettings.fnInitComplete.call(oSettings.oInstance,oSettings)}}}function _fnLanguageProcess(oSettings,oLanguage,bInit){_fnMap(oSettings.oLanguage,oLanguage,'sProcessing');_fnMap(oSettings.oLanguage,oLanguage,'sLengthMenu');_fnMap(oSettings.oLanguage,oLanguage,'sEmptyTable');_fnMap(oSettings.oLanguage,oLanguage,'sLoadingRecords');_fnMap(oSettings.oLanguage,oLanguage,'sZeroRecords');_fnMap(oSettings.oLanguage,oLanguage,'sInfo');_fnMap(oSettings.oLanguage,oLanguage,'sInfoEmpty');_fnMap(oSettings.oLanguage,oLanguage,'sInfoFiltered');_fnMap(oSettings.oLanguage,oLanguage,'sInfoPostFix');_fnMap(oSettings.oLanguage,oLanguage,'sSearch');if(typeof oLanguage.oPaginate!='undefined'){_fnMap(oSettings.oLanguage.oPaginate,oLanguage.oPaginate,'sFirst');_fnMap(oSettings.oLanguage.oPaginate,oLanguage.oPaginate,'sPrevious');_fnMap(oSettings.oLanguage.oPaginate,oLanguage.oPaginate,'sNext');_fnMap(oSettings.oLanguage.oPaginate,oLanguage.oPaginate,'sLast')}if(typeof oLanguage.sEmptyTable=='undefined'&&typeof oLanguage.sZeroRecords!='undefined'){_fnMap(oSettings.oLanguage,oLanguage,'sZeroRecords','sEmptyTable')}if(typeof oLanguage.sLoadingRecords=='undefined'&&typeof oLanguage.sZeroRecords!='undefined'){_fnMap(oSettings.oLanguage,oLanguage,'sZeroRecords','sLoadingRecords')}if(bInit){_fnInitalise(oSettings)}}function _fnAddColumn(oSettings,nTh){var iCol=oSettings.aoColumns.length;var oCol={"sType":null,"_bAutoType":true,"bVisible":true,"bSearchable":true,"bSortable":true,"asSorting":['asc','desc'],"sSortingClass":oSettings.oClasses.sSortable,"sSortingClassJUI":oSettings.oClasses.sSortJUI,"sTitle":nTh?nTh.innerHTML:'',"sName":'',"sWidth":null,"sWidthOrig":null,"sClass":null,"fnRender":null,"bUseRendered":true,"iDataSort":iCol,"mDataProp":iCol,"fnGetData":null,"fnSetData":null,"sSortDataType":'std',"sDefaultContent":null,"sContentPadding":"","nTh":nTh?nTh:document.createElement('th'),"nTf":null};oSettings.aoColumns.push(oCol);if(typeof oSettings.aoPreSearchCols[iCol]=='undefined'||oSettings.aoPreSearchCols[iCol]===null){oSettings.aoPreSearchCols[iCol]={"sSearch":"","bRegex":false,"bSmart":true}}else{if(typeof oSettings.aoPreSearchCols[iCol].bRegex=='undefined'){oSettings.aoPreSearchCols[iCol].bRegex=true}if(typeof oSettings.aoPreSearchCols[iCol].bSmart=='undefined'){oSettings.aoPreSearchCols[iCol].bSmart=true}}_fnColumnOptions(oSettings,iCol,null)}function _fnColumnOptions(oSettings,iCol,oOptions){var oCol=oSettings.aoColumns[iCol];if(typeof oOptions!='undefined'&&oOptions!==null){if(typeof oOptions.sType!='undefined'){oCol.sType=oOptions.sType;oCol._bAutoType=false}_fnMap(oCol,oOptions,"bVisible");_fnMap(oCol,oOptions,"bSearchable");_fnMap(oCol,oOptions,"bSortable");_fnMap(oCol,oOptions,"sTitle");_fnMap(oCol,oOptions,"sName");_fnMap(oCol,oOptions,"sWidth");_fnMap(oCol,oOptions,"sWidth","sWidthOrig");_fnMap(oCol,oOptions,"sClass");_fnMap(oCol,oOptions,"fnRender");_fnMap(oCol,oOptions,"bUseRendered");_fnMap(oCol,oOptions,"iDataSort");_fnMap(oCol,oOptions,"mDataProp");_fnMap(oCol,oOptions,"asSorting");_fnMap(oCol,oOptions,"sSortDataType");_fnMap(oCol,oOptions,"sDefaultContent");_fnMap(oCol,oOptions,"sContentPadding")}oCol.fnGetData=_fnGetObjectDataFn(oCol.mDataProp);oCol.fnSetData=_fnSetObjectDataFn(oCol.mDataProp);if(!oSettings.oFeatures.bSort){oCol.bSortable=false}if(!oCol.bSortable||($.inArray('asc',oCol.asSorting)==-1&&$.inArray('desc',oCol.asSorting)==-1)){oCol.sSortingClass=oSettings.oClasses.sSortableNone;oCol.sSortingClassJUI=""}else if(oCol.bSortable||($.inArray('asc',oCol.asSorting)==-1&&$.inArray('desc',oCol.asSorting)==-1)){oCol.sSortingClass=oSettings.oClasses.sSortable;oCol.sSortingClassJUI=oSettings.oClasses.sSortJUI}else if($.inArray('asc',oCol.asSorting)!=-1&&$.inArray('desc',oCol.asSorting)==-1){oCol.sSortingClass=oSettings.oClasses.sSortableAsc;oCol.sSortingClassJUI=oSettings.oClasses.sSortJUIAscAllowed}else if($.inArray('asc',oCol.asSorting)==-1&&$.inArray('desc',oCol.asSorting)!=-1){oCol.sSortingClass=oSettings.oClasses.sSortableDesc;oCol.sSortingClassJUI=oSettings.oClasses.sSortJUIDescAllowed}}function _fnAddData(oSettings,aDataSupplied){var oCol;var aDataIn=(typeof aDataSupplied.length=='number')?aDataSupplied.slice():$.extend(true,{},aDataSupplied);var iRow=oSettings.aoData.length;var oData={"nTr":null,"_iId":oSettings.iNextId++,"_aData":aDataIn,"_anHidden":[],"_sRowStripe":""};oSettings.aoData.push(oData);var nTd,sThisType;for(var i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){oCol=oSettings.aoColumns[i];if(typeof oCol.fnRender=='function'&&oCol.bUseRendered&&oCol.mDataProp!==null){_fnSetCellData(oSettings,iRow,i,oCol.fnRender({"iDataRow":iRow,"iDataColumn":i,"aData":oData._aData,"oSettings":oSettings}))}if(oCol._bAutoType&&oCol.sType!='string'){var sVarType=_fnGetCellData(oSettings,iRow,i,'type');if(sVarType!==null&&sVarType!==''){sThisType=_fnDetectType(sVarType);if(oCol.sType===null){oCol.sType=sThisType}else if(oCol.sType!=sThisType){oCol.sType='string'}}}}oSettings.aiDisplayMaster.push(iRow);if(!oSettings.oFeatures.bDeferRender){_fnCreateTr(oSettings,iRow)}return iRow}function _fnCreateTr(oSettings,iRow){var oData=oSettings.aoData[iRow];var nTd;if(oData.nTr===null){oData.nTr=document.createElement('tr');if(typeof oData._aData.DT_RowId!='undefined'){oData.nTr.setAttribute('id',oData._aData.DT_RowId)}if(typeof oData._aData.DT_RowClass!='undefined'){$(oData.nTr).addClass(oData._aData.DT_RowClass)}for(var i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){var oCol=oSettings.aoColumns[i];nTd=document.createElement('td');if(typeof oCol.fnRender=='function'&&(!oCol.bUseRendered||oCol.mDataProp===null)){nTd.innerHTML=oCol.fnRender({"iDataRow":iRow,"iDataColumn":i,"aData":oData._aData,"oSettings":oSettings})}else{nTd.innerHTML=_fnGetCellData(oSettings,iRow,i,'display')}if(oCol.sClass!==null){nTd.className=oCol.sClass}if(oCol.bVisible){oData.nTr.appendChild(nTd);oData._anHidden[i]=null}else{oData._anHidden[i]=nTd}}}}function _fnGatherData(oSettings){var iLoop,i,iLen,j,jLen,jInner,nTds,nTrs,nTd,aLocalData,iThisIndex,iRow,iRows,iColumn,iColumns,sNodeName;if(oSettings.bDeferLoading||oSettings.sAjaxSource===null){nTrs=oSettings.nTBody.childNodes;for(i=0,iLen=nTrs.length;i<iLen;i++){if(nTrs[i].nodeName.toUpperCase()=="TR"){iThisIndex=oSettings.aoData.length;oSettings.aoData.push({"nTr":nTrs[i],"_iId":oSettings.iNextId++,"_aData":[],"_anHidden":[],"_sRowStripe":''});oSettings.aiDisplayMaster.push(iThisIndex);nTds=nTrs[i].childNodes;jInner=0;for(j=0,jLen=nTds.length;j<jLen;j++){sNodeName=nTds[j].nodeName.toUpperCase();if(sNodeName=="TD"||sNodeName=="TH"){_fnSetCellData(oSettings,iThisIndex,jInner,$.trim(nTds[j].innerHTML));jInner++}}}}}nTrs=_fnGetTrNodes(oSettings);nTds=[];for(i=0,iLen=nTrs.length;i<iLen;i++){for(j=0,jLen=nTrs[i].childNodes.length;j<jLen;j++){nTd=nTrs[i].childNodes[j];sNodeName=nTd.nodeName.toUpperCase();if(sNodeName=="TD"||sNodeName=="TH"){nTds.push(nTd)}}}if(nTds.length!=nTrs.length*oSettings.aoColumns.length){_fnLog(oSettings,1,"Unexpected number of TD elements. Expected "+(nTrs.length*oSettings.aoColumns.length)+" and got "+nTds.length+". DataTables does "+"not support rowspan / colspan in the table body, and there must be one cell for each "+"row/column combination.")}for(iColumn=0,iColumns=oSettings.aoColumns.length;iColumn<iColumns;iColumn++){if(oSettings.aoColumns[iColumn].sTitle===null){oSettings.aoColumns[iColumn].sTitle=oSettings.aoColumns[iColumn].nTh.innerHTML}var bAutoType=oSettings.aoColumns[iColumn]._bAutoType,bRender=typeof oSettings.aoColumns[iColumn].fnRender=='function',bClass=oSettings.aoColumns[iColumn].sClass!==null,bVisible=oSettings.aoColumns[iColumn].bVisible,nCell,sThisType,sRendered,sValType;if(bAutoType||bRender||bClass||!bVisible){for(iRow=0,iRows=oSettings.aoData.length;iRow<iRows;iRow++){nCell=nTds[(iRow*iColumns)+iColumn];if(bAutoType&&oSettings.aoColumns[iColumn].sType!='string'){sValType=_fnGetCellData(oSettings,iRow,iColumn,'type');if(sValType!==''){sThisType=_fnDetectType(sValType);if(oSettings.aoColumns[iColumn].sType===null){oSettings.aoColumns[iColumn].sType=sThisType}else if(oSettings.aoColumns[iColumn].sType!=sThisType){oSettings.aoColumns[iColumn].sType='string'}}}if(bRender){sRendered=oSettings.aoColumns[iColumn].fnRender({"iDataRow":iRow,"iDataColumn":iColumn,"aData":oSettings.aoData[iRow]._aData,"oSettings":oSettings});nCell.innerHTML=sRendered;if(oSettings.aoColumns[iColumn].bUseRendered){_fnSetCellData(oSettings,iRow,iColumn,sRendered)}}if(bClass){nCell.className+=' '+oSettings.aoColumns[iColumn].sClass}if(!bVisible){oSettings.aoData[iRow]._anHidden[iColumn]=nCell;nCell.parentNode.removeChild(nCell)}else{oSettings.aoData[iRow]._anHidden[iColumn]=null}}}}}function _fnBuildHead(oSettings){var i,nTh,iLen,j,jLen;var anTr=oSettings.nTHead.getElementsByTagName('tr');var iThs=oSettings.nTHead.getElementsByTagName('th').length;var iCorrector=0;var jqChildren;if(iThs!==0){for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){nTh=oSettings.aoColumns[i].nTh;if(oSettings.aoColumns[i].sClass!==null){$(nTh).addClass(oSettings.aoColumns[i].sClass)}if(oSettings.aoColumns[i].sTitle!=nTh.innerHTML){nTh.innerHTML=oSettings.aoColumns[i].sTitle}}}else{var nTr=document.createElement("tr");for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){nTh=oSettings.aoColumns[i].nTh;nTh.innerHTML=oSettings.aoColumns[i].sTitle;if(oSettings.aoColumns[i].sClass!==null){$(nTh).addClass(oSettings.aoColumns[i].sClass)}nTr.appendChild(nTh)}$(oSettings.nTHead).html('')[0].appendChild(nTr);_fnDetectHeader(oSettings.aoHeader,oSettings.nTHead)}if(oSettings.bJUI){for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){nTh=oSettings.aoColumns[i].nTh;var nDiv=document.createElement('div');nDiv.className=oSettings.oClasses.sSortJUIWrapper;$(nTh).contents().appendTo(nDiv);var nSpan=document.createElement('span');nSpan.className=oSettings.oClasses.sSortIcon;nDiv.appendChild(nSpan);nTh.appendChild(nDiv)}}var fnNoSelect=function(e){this.onselectstart=function(){return false};return false};if(oSettings.oFeatures.bSort){for(i=0;i<oSettings.aoColumns.length;i++){if(oSettings.aoColumns[i].bSortable!==false){_fnSortAttachListener(oSettings,oSettings.aoColumns[i].nTh,i);$(oSettings.aoColumns[i].nTh).bind('mousedown.DT',fnNoSelect)}else{$(oSettings.aoColumns[i].nTh).addClass(oSettings.oClasses.sSortableNone)}}}if(oSettings.oClasses.sFooterTH!==""){$('>tr>th',oSettings.nTFoot).addClass(oSettings.oClasses.sFooterTH)}if(oSettings.nTFoot!==null){var anCells=_fnGetUniqueThs(oSettings,null,oSettings.aoFooter);for(i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){if(typeof anCells[i]!='undefined'){oSettings.aoColumns[i].nTf=anCells[i]}}}}function _fnDrawHead(oSettings,aoSource,bIncludeHidden){var i,iLen,j,jLen,k,kLen;var aoLocal=[];var aApplied=[];var iColumns=oSettings.aoColumns.length;var iRowspan,iColspan;if(typeof bIncludeHidden=='undefined'){bIncludeHidden=false}for(i=0,iLen=aoSource.length;i<iLen;i++){aoLocal[i]=aoSource[i].slice();aoLocal[i].nTr=aoSource[i].nTr;for(j=iColumns-1;j>=0;j--){if(!oSettings.aoColumns[j].bVisible&&!bIncludeHidden){aoLocal[i].splice(j,1)}}aApplied.push([])}for(i=0,iLen=aoLocal.length;i<iLen;i++){if(aoLocal[i].nTr){for(k=0,kLen=aoLocal[i].nTr.childNodes.length;k<kLen;k++){aoLocal[i].nTr.removeChild(aoLocal[i].nTr.childNodes[0])}}for(j=0,jLen=aoLocal[i].length;j<jLen;j++){iRowspan=1;iColspan=1;if(typeof aApplied[i][j]=='undefined'){aoLocal[i].nTr.appendChild(aoLocal[i][j].cell);aApplied[i][j]=1;while(typeof aoLocal[i+iRowspan]!='undefined'&&aoLocal[i][j].cell==aoLocal[i+iRowspan][j].cell){aApplied[i+iRowspan][j]=1;iRowspan++}while(typeof aoLocal[i][j+iColspan]!='undefined'&&aoLocal[i][j].cell==aoLocal[i][j+iColspan].cell){for(k=0;k<iRowspan;k++){aApplied[i+k][j+iColspan]=1}iColspan++}aoLocal[i][j].cell.setAttribute('rowspan',iRowspan);aoLocal[i][j].cell.setAttribute('colspan',iColspan)}}}}function _fnDraw(oSettings){var i,iLen;var anRows=[];var iRowCount=0;var bRowError=false;var iStrips=oSettings.asStripClasses.length;var iOpenRows=oSettings.aoOpenRows.length;if(oSettings.fnPreDrawCallback!==null&&oSettings.fnPreDrawCallback.call(oSettings.oInstance,oSettings)===false){return}oSettings.bDrawing=true;if(typeof oSettings.iInitDisplayStart!='undefined'&&oSettings.iInitDisplayStart!=-1){if(oSettings.oFeatures.bServerSide){oSettings._iDisplayStart=oSettings.iInitDisplayStart}else{oSettings._iDisplayStart=(oSettings.iInitDisplayStart>=oSettings.fnRecordsDisplay())?0:oSettings.iInitDisplayStart}oSettings.iInitDisplayStart=-1;_fnCalculateEnd(oSettings)}if(oSettings.bDeferLoading){oSettings.bDeferLoading=false;oSettings.iDraw++}else if(!oSettings.oFeatures.bServerSide){oSettings.iDraw++}else if(!oSettings.bDestroying&&!_fnAjaxUpdate(oSettings)){return}if(oSettings.aiDisplay.length!==0){var iStart=oSettings._iDisplayStart;var iEnd=oSettings._iDisplayEnd;if(oSettings.oFeatures.bServerSide){iStart=0;iEnd=oSettings.aoData.length}for(var j=iStart;j<iEnd;j++){var aoData=oSettings.aoData[oSettings.aiDisplay[j]];if(aoData.nTr===null){_fnCreateTr(oSettings,oSettings.aiDisplay[j])}var nRow=aoData.nTr;if(iStrips!==0){var sStrip=oSettings.asStripClasses[iRowCount%iStrips];if(aoData._sRowStripe!=sStrip){$(nRow).removeClass(aoData._sRowStripe).addClass(sStrip);aoData._sRowStripe=sStrip}}if(typeof oSettings.fnRowCallback=="function"){nRow=oSettings.fnRowCallback.call(oSettings.oInstance,nRow,oSettings.aoData[oSettings.aiDisplay[j]]._aData,iRowCount,j);if(!nRow&&!bRowError){_fnLog(oSettings,0,"A node was not returned by fnRowCallback");bRowError=true}}anRows.push(nRow);iRowCount++;if(iOpenRows!==0){for(var k=0;k<iOpenRows;k++){if(nRow==oSettings.aoOpenRows[k].nParent){anRows.push(oSettings.aoOpenRows[k].nTr)}}}}}else{anRows[0]=document.createElement('tr');if(typeof oSettings.asStripClasses[0]!='undefined'){anRows[0].className=oSettings.asStripClasses[0]}var sZero=oSettings.oLanguage.sZeroRecords.replace('_MAX_',oSettings.fnFormatNumber(oSettings.fnRecordsTotal()));if(oSettings.iDraw==1&&oSettings.sAjaxSource!==null&&!oSettings.oFeatures.bServerSide){sZero=oSettings.oLanguage.sLoadingRecords}else if(typeof oSettings.oLanguage.sEmptyTable!='undefined'&&oSettings.fnRecordsTotal()===0){sZero=oSettings.oLanguage.sEmptyTable}var nTd=document.createElement('td');nTd.setAttribute('valign',"top");nTd.colSpan=_fnVisbleColumns(oSettings);nTd.className=oSettings.oClasses.sRowEmpty;nTd.innerHTML=sZero;anRows[iRowCount].appendChild(nTd)}if(typeof oSettings.fnHeaderCallback=='function'){oSettings.fnHeaderCallback.call(oSettings.oInstance,$('>tr',oSettings.nTHead)[0],_fnGetDataMaster(oSettings),oSettings._iDisplayStart,oSettings.fnDisplayEnd(),oSettings.aiDisplay)}if(typeof oSettings.fnFooterCallback=='function'){oSettings.fnFooterCallback.call(oSettings.oInstance,$('>tr',oSettings.nTFoot)[0],_fnGetDataMaster(oSettings),oSettings._iDisplayStart,oSettings.fnDisplayEnd(),oSettings.aiDisplay)}var nAddFrag=document.createDocumentFragment(),nRemoveFrag=document.createDocumentFragment(),nBodyPar,nTrs;if(oSettings.nTBody){nBodyPar=oSettings.nTBody.parentNode;nRemoveFrag.appendChild(oSettings.nTBody);if(!oSettings.oScroll.bInfinite||!oSettings._bInitComplete||oSettings.bSorted||oSettings.bFiltered){nTrs=oSettings.nTBody.childNodes;for(i=nTrs.length-1;i>=0;i--){nTrs[i].parentNode.removeChild(nTrs[i])}}for(i=0,iLen=anRows.length;i<iLen;i++){nAddFrag.appendChild(anRows[i])}oSettings.nTBody.appendChild(nAddFrag);if(nBodyPar!==null){nBodyPar.appendChild(oSettings.nTBody)}}for(i=oSettings.aoDrawCallback.length-1;i>=0;i--){oSettings.aoDrawCallback[i].fn.call(oSettings.oInstance,oSettings)}oSettings.bSorted=false;oSettings.bFiltered=false;oSettings.bDrawing=false;if(oSettings.oFeatures.bServerSide){_fnProcessingDisplay(oSettings,false);if(typeof oSettings._bInitComplete=='undefined'){_fnInitComplete(oSettings)}}}function _fnReDraw(oSettings){if(oSettings.oFeatures.bSort){_fnSort(oSettings,oSettings.oPreviousSearch)}else if(oSettings.oFeatures.bFilter){_fnFilterComplete(oSettings,oSettings.oPreviousSearch)}else{_fnCalculateEnd(oSettings);_fnDraw(oSettings)}}function _fnAjaxUpdate(oSettings){if(oSettings.bAjaxDataGet){_fnProcessingDisplay(oSettings,true);var iColumns=oSettings.aoColumns.length;var aoData=[],mDataProp;var i;oSettings.iDraw++;aoData.push({"name":"sEcho","value":oSettings.iDraw});aoData.push({"name":"iColumns","value":iColumns});aoData.push({"name":"sColumns","value":_fnColumnOrdering(oSettings)});aoData.push({"name":"iDisplayStart","value":oSettings._iDisplayStart});aoData.push({"name":"iDisplayLength","value":oSettings.oFeatures.bPaginate!==false?oSettings._iDisplayLength:-1});for(i=0;i<iColumns;i++){mDataProp=oSettings.aoColumns[i].mDataProp;aoData.push({"name":"mDataProp_"+i,"value":typeof(mDataProp)=="function"?'function':mDataProp})}if(oSettings.oFeatures.bFilter!==false){aoData.push({"name":"sSearch","value":oSettings.oPreviousSearch.sSearch});aoData.push({"name":"bRegex","value":oSettings.oPreviousSearch.bRegex});for(i=0;i<iColumns;i++){aoData.push({"name":"sSearch_"+i,"value":oSettings.aoPreSearchCols[i].sSearch});aoData.push({"name":"bRegex_"+i,"value":oSettings.aoPreSearchCols[i].bRegex});aoData.push({"name":"bSearchable_"+i,"value":oSettings.aoColumns[i].bSearchable})}}if(oSettings.oFeatures.bSort!==false){var iFixed=oSettings.aaSortingFixed!==null?oSettings.aaSortingFixed.length:0;var iUser=oSettings.aaSorting.length;aoData.push({"name":"iSortingCols","value":iFixed+iUser});for(i=0;i<iFixed;i++){aoData.push({"name":"iSortCol_"+i,"value":oSettings.aaSortingFixed[i][0]});aoData.push({"name":"sSortDir_"+i,"value":oSettings.aaSortingFixed[i][1]})}for(i=0;i<iUser;i++){aoData.push({"name":"iSortCol_"+(i+iFixed),"value":oSettings.aaSorting[i][0]});aoData.push({"name":"sSortDir_"+(i+iFixed),"value":oSettings.aaSorting[i][1]})}for(i=0;i<iColumns;i++){aoData.push({"name":"bSortable_"+i,"value":oSettings.aoColumns[i].bSortable})}}oSettings.fnServerData.call(oSettings.oInstance,oSettings.sAjaxSource,aoData,function(json){_fnAjaxUpdateDraw(oSettings,json)},oSettings);return false}else{return true}}function _fnAjaxUpdateDraw(oSettings,json){if(typeof json.sEcho!='undefined'){if(json.sEcho*1<oSettings.iDraw){return}else{oSettings.iDraw=json.sEcho*1}}if(!oSettings.oScroll.bInfinite||(oSettings.oScroll.bInfinite&&(oSettings.bSorted||oSettings.bFiltered))){_fnClearTable(oSettings)}oSettings._iRecordsTotal=json.iTotalRecords;oSettings._iRecordsDisplay=json.iTotalDisplayRecords;var sOrdering=_fnColumnOrdering(oSettings);var bReOrder=(typeof json.sColumns!='undefined'&&sOrdering!==""&&json.sColumns!=sOrdering);if(bReOrder){var aiIndex=_fnReOrderIndex(oSettings,json.sColumns)}var fnDataSrc=_fnGetObjectDataFn(oSettings.sAjaxDataProp);var aData=fnDataSrc(json);for(var i=0,iLen=aData.length;i<iLen;i++){if(bReOrder){var aDataSorted=[];for(var j=0,jLen=oSettings.aoColumns.length;j<jLen;j++){aDataSorted.push(aData[i][aiIndex[j]])}_fnAddData(oSettings,aDataSorted)}else{_fnAddData(oSettings,aData[i])}}oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();oSettings.bAjaxDataGet=false;_fnDraw(oSettings);oSettings.bAjaxDataGet=true;_fnProcessingDisplay(oSettings,false)}function _fnAddOptionsHtml(oSettings){var nHolding=document.createElement('div');oSettings.nTable.parentNode.insertBefore(nHolding,oSettings.nTable);oSettings.nTableWrapper=document.createElement('div');oSettings.nTableWrapper.className=oSettings.oClasses.sWrapper;if(oSettings.sTableId!==''){oSettings.nTableWrapper.setAttribute('id',oSettings.sTableId+'_wrapper')}oSettings.nTableReinsertBefore=oSettings.nTable.nextSibling;var nInsertNode=oSettings.nTableWrapper;var aDom=oSettings.sDom.split('');var nTmp,iPushFeature,cOption,nNewNode,cNext,sAttr,j;for(var i=0;i<aDom.length;i++){iPushFeature=0;cOption=aDom[i];if(cOption=='<'){nNewNode=document.createElement('div');cNext=aDom[i+1];if(cNext=="'"||cNext=='"'){sAttr="";j=2;while(aDom[i+j]!=cNext){sAttr+=aDom[i+j];j++}if(sAttr=="H"){sAttr="fg-toolbar ui-toolbar ui-widget-header ui-corner-tl ui-corner-tr ui-helper-clearfix"}else if(sAttr=="F"){sAttr="fg-toolbar ui-toolbar ui-widget-header ui-corner-bl ui-corner-br ui-helper-clearfix"}if(sAttr.indexOf('.')!=-1){var aSplit=sAttr.split('.');nNewNode.setAttribute('id',aSplit[0].substr(1,aSplit[0].length-1));nNewNode.className=aSplit[1]}else if(sAttr.charAt(0)=="#"){nNewNode.setAttribute('id',sAttr.substr(1,sAttr.length-1))}else{nNewNode.className=sAttr}i+=j}nInsertNode.appendChild(nNewNode);nInsertNode=nNewNode}else if(cOption=='>'){nInsertNode=nInsertNode.parentNode}else if(cOption=='l'&&oSettings.oFeatures.bPaginate&&oSettings.oFeatures.bLengthChange){nTmp=_fnFeatureHtmlLength(oSettings);iPushFeature=1}else if(cOption=='f'&&oSettings.oFeatures.bFilter){nTmp=_fnFeatureHtmlFilter(oSettings);iPushFeature=1}else if(cOption=='r'&&oSettings.oFeatures.bProcessing){nTmp=_fnFeatureHtmlProcessing(oSettings);iPushFeature=1}else if(cOption=='t'){nTmp=_fnFeatureHtmlTable(oSettings);iPushFeature=1}else if(cOption=='i'&&oSettings.oFeatures.bInfo){nTmp=_fnFeatureHtmlInfo(oSettings);iPushFeature=1}else if(cOption=='p'&&oSettings.oFeatures.bPaginate){nTmp=_fnFeatureHtmlPaginate(oSettings);iPushFeature=1}else if(_oExt.aoFeatures.length!==0){var aoFeatures=_oExt.aoFeatures;for(var k=0,kLen=aoFeatures.length;k<kLen;k++){if(cOption==aoFeatures[k].cFeature){nTmp=aoFeatures[k].fnInit(oSettings);if(nTmp){iPushFeature=1}break}}}if(iPushFeature==1&&nTmp!==null){if(typeof oSettings.aanFeatures[cOption]!='object'){oSettings.aanFeatures[cOption]=[]}oSettings.aanFeatures[cOption].push(nTmp);nInsertNode.appendChild(nTmp)}}nHolding.parentNode.replaceChild(oSettings.nTableWrapper,nHolding)}function _fnFeatureHtmlTable(oSettings){if(oSettings.oScroll.sX===""&&oSettings.oScroll.sY===""){return oSettings.nTable}var nScroller=document.createElement('div'),nScrollHead=document.createElement('div'),nScrollHeadInner=document.createElement('div'),nScrollBody=document.createElement('div'),nScrollFoot=document.createElement('div'),nScrollFootInner=document.createElement('div'),nScrollHeadTable=oSettings.nTable.cloneNode(false),nScrollFootTable=oSettings.nTable.cloneNode(false),nThead=oSettings.nTable.getElementsByTagName('thead')[0],nTfoot=oSettings.nTable.getElementsByTagName('tfoot').length===0?null:oSettings.nTable.getElementsByTagName('tfoot')[0],oClasses=(typeof oInit.bJQueryUI!='undefined'&&oInit.bJQueryUI)?_oExt.oJUIClasses:_oExt.oStdClasses;nScrollHead.appendChild(nScrollHeadInner);nScrollFoot.appendChild(nScrollFootInner);nScrollBody.appendChild(oSettings.nTable);nScroller.appendChild(nScrollHead);nScroller.appendChild(nScrollBody);nScrollHeadInner.appendChild(nScrollHeadTable);nScrollHeadTable.appendChild(nThead);if(nTfoot!==null){nScroller.appendChild(nScrollFoot);nScrollFootInner.appendChild(nScrollFootTable);nScrollFootTable.appendChild(nTfoot)}nScroller.className=oClasses.sScrollWrapper;nScrollHead.className=oClasses.sScrollHead;nScrollHeadInner.className=oClasses.sScrollHeadInner;nScrollBody.className=oClasses.sScrollBody;nScrollFoot.className=oClasses.sScrollFoot;nScrollFootInner.className=oClasses.sScrollFootInner;if(oSettings.oScroll.bAutoCss){nScrollHead.style.overflow="hidden";nScrollHead.style.position="relative";nScrollFoot.style.overflow="hidden";nScrollBody.style.overflow="auto"}nScrollHead.style.border="0";nScrollHead.style.width="100%";nScrollFoot.style.border="0";nScrollHeadInner.style.width="150%";nScrollHeadTable.removeAttribute('id');nScrollHeadTable.style.marginLeft="0";oSettings.nTable.style.marginLeft="0";if(nTfoot!==null){nScrollFootTable.removeAttribute('id');nScrollFootTable.style.marginLeft="0"}var nCaptions=$('>caption',oSettings.nTable);for(var i=0,iLen=nCaptions.length;i<iLen;i++){nScrollHeadTable.appendChild(nCaptions[i])}if(oSettings.oScroll.sX!==""){nScrollHead.style.width=_fnStringToCss(oSettings.oScroll.sX);nScrollBody.style.width=_fnStringToCss(oSettings.oScroll.sX);if(nTfoot!==null){nScrollFoot.style.width=_fnStringToCss(oSettings.oScroll.sX)}$(nScrollBody).scroll(function(e){nScrollHead.scrollLeft=this.scrollLeft;if(nTfoot!==null){nScrollFoot.scrollLeft=this.scrollLeft}})}if(oSettings.oScroll.sY!==""){nScrollBody.style.height=_fnStringToCss(oSettings.oScroll.sY)}oSettings.aoDrawCallback.push({"fn":_fnScrollDraw,"sName":"scrolling"});if(oSettings.oScroll.bInfinite){$(nScrollBody).scroll(function(){if(!oSettings.bDrawing){if($(this).scrollTop()+$(this).height()>$(oSettings.nTable).height()-oSettings.oScroll.iLoadGap){if(oSettings.fnDisplayEnd()<oSettings.fnRecordsDisplay()){_fnPageChange(oSettings,'next');_fnCalculateEnd(oSettings);_fnDraw(oSettings)}}}})}oSettings.nScrollHead=nScrollHead;oSettings.nScrollFoot=nScrollFoot;return nScroller}function _fnScrollDraw(o){var nScrollHeadInner=o.nScrollHead.getElementsByTagName('div')[0],nScrollHeadTable=nScrollHeadInner.getElementsByTagName('table')[0],nScrollBody=o.nTable.parentNode,i,iLen,j,jLen,anHeadToSize,anHeadSizers,anFootSizers,anFootToSize,oStyle,iVis,iWidth,aApplied=[],iSanityWidth;var nTheadSize=o.nTable.getElementsByTagName('thead');if(nTheadSize.length>0){o.nTable.removeChild(nTheadSize[0])}if(o.nTFoot!==null){var nTfootSize=o.nTable.getElementsByTagName('tfoot');if(nTfootSize.length>0){o.nTable.removeChild(nTfootSize[0])}}nTheadSize=o.nTHead.cloneNode(true);o.nTable.insertBefore(nTheadSize,o.nTable.childNodes[0]);if(o.nTFoot!==null){nTfootSize=o.nTFoot.cloneNode(true);o.nTable.insertBefore(nTfootSize,o.nTable.childNodes[1])}if(o.oScroll.sX===""){nScrollBody.style.width='100%';nScrollHeadInner.parentNode.style.width='100%'}var nThs=_fnGetUniqueThs(o,nTheadSize);for(i=0,iLen=nThs.length;i<iLen;i++){iVis=_fnVisibleToColumnIndex(o,i);nThs[i].style.width=o.aoColumns[iVis].sWidth}if(o.nTFoot!==null){_fnApplyToChildren(function(n){n.style.width=""},nTfootSize.getElementsByTagName('tr'))}iSanityWidth=$(o.nTable).outerWidth();if(o.oScroll.sX===""){o.nTable.style.width="100%";if($.browser.msie&&$.browser.version<=7){o.nTable.style.width=_fnStringToCss($(o.nTable).outerWidth()-o.oScroll.iBarWidth)}}else{if(o.oScroll.sXInner!==""){o.nTable.style.width=_fnStringToCss(o.oScroll.sXInner)}else if(iSanityWidth==$(nScrollBody).width()&&$(nScrollBody).height()<$(o.nTable).height()){o.nTable.style.width=_fnStringToCss(iSanityWidth-o.oScroll.iBarWidth);if($(o.nTable).outerWidth()>iSanityWidth-o.oScroll.iBarWidth){o.nTable.style.width=_fnStringToCss(iSanityWidth)}}else{o.nTable.style.width=_fnStringToCss(iSanityWidth)}}iSanityWidth=$(o.nTable).outerWidth();if(o.oScroll.sX===""){nScrollBody.style.width=_fnStringToCss(iSanityWidth+o.oScroll.iBarWidth);nScrollHeadInner.parentNode.style.width=_fnStringToCss(iSanityWidth+o.oScroll.iBarWidth)}anHeadToSize=o.nTHead.getElementsByTagName('tr');anHeadSizers=nTheadSize.getElementsByTagName('tr');_fnApplyToChildren(function(nSizer,nToSize){oStyle=nSizer.style;oStyle.paddingTop="0";oStyle.paddingBottom="0";oStyle.borderTopWidth="0";oStyle.borderBottomWidth="0";oStyle.height=0;iWidth=$(nSizer).width();nToSize.style.width=_fnStringToCss(iWidth);aApplied.push(iWidth)},anHeadSizers,anHeadToSize);$(anHeadSizers).height(0);if(o.nTFoot!==null){anFootSizers=nTfootSize.getElementsByTagName('tr');anFootToSize=o.nTFoot.getElementsByTagName('tr');_fnApplyToChildren(function(nSizer,nToSize){oStyle=nSizer.style;oStyle.paddingTop="0";oStyle.paddingBottom="0";oStyle.borderTopWidth="0";oStyle.borderBottomWidth="0";oStyle.height=0;iWidth=$(nSizer).width();nToSize.style.width=_fnStringToCss(iWidth);aApplied.push(iWidth)},anFootSizers,anFootToSize);$(anFootSizers).height(0)}_fnApplyToChildren(function(nSizer){nSizer.innerHTML="";nSizer.style.width=_fnStringToCss(aApplied.shift())},anHeadSizers);if(o.nTFoot!==null){_fnApplyToChildren(function(nSizer){nSizer.innerHTML="";nSizer.style.width=_fnStringToCss(aApplied.shift())},anFootSizers)}if($(o.nTable).outerWidth()<iSanityWidth){if(o.oScroll.sX===""){_fnLog(o,1,"The table cannot fit into the current element which will cause column"+" misalignment. It is suggested that you enable x-scrolling or increase the width"+" the table has in which to be drawn")}else if(o.oScroll.sXInner!==""){_fnLog(o,1,"The table cannot fit into the current element which will cause column"+" misalignment. It is suggested that you increase the sScrollXInner property to"+" allow it to draw in a larger area, or simply remove that parameter to allow"+" automatic calculation")}}if(o.oScroll.sY===""){if($.browser.msie&&$.browser.version<=7){nScrollBody.style.height=_fnStringToCss(o.nTable.offsetHeight+o.oScroll.iBarWidth)}}if(o.oScroll.sY!==""&&o.oScroll.bCollapse){nScrollBody.style.height=_fnStringToCss(o.oScroll.sY);var iExtra=(o.oScroll.sX!==""&&o.nTable.offsetWidth>nScrollBody.offsetWidth)?o.oScroll.iBarWidth:0;if(o.nTable.offsetHeight<nScrollBody.offsetHeight){nScrollBody.style.height=_fnStringToCss($(o.nTable).height()+iExtra)}}var iOuterWidth=$(o.nTable).outerWidth();nScrollHeadTable.style.width=_fnStringToCss(iOuterWidth);nScrollHeadInner.style.width=_fnStringToCss(iOuterWidth+o.oScroll.iBarWidth);if(o.nTFoot!==null){var nScrollFootInner=o.nScrollFoot.getElementsByTagName('div')[0],nScrollFootTable=nScrollFootInner.getElementsByTagName('table')[0];nScrollFootInner.style.width=_fnStringToCss(o.nTable.offsetWidth+o.oScroll.iBarWidth);nScrollFootTable.style.width=_fnStringToCss(o.nTable.offsetWidth)}if(o.bSorted||o.bFiltered){nScrollBody.scrollTop=0}}function _fnAjustColumnSizing(oSettings){if(oSettings.oFeatures.bAutoWidth===false){return false}_fnCalculateColumnWidths(oSettings);for(var i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){oSettings.aoColumns[i].nTh.style.width=oSettings.aoColumns[i].sWidth}}function _fnFeatureHtmlFilter(oSettings){var sSearchStr=oSettings.oLanguage.sSearch;sSearchStr=(sSearchStr.indexOf('_INPUT_')!==-1)?sSearchStr.replace('_INPUT_','<input type="text" />'):sSearchStr===""?'<input type="text" />':sSearchStr+' <input type="text" />';var nFilter=document.createElement('div');nFilter.className=oSettings.oClasses.sFilter;nFilter.innerHTML='<label>'+sSearchStr+'</label>';if(oSettings.sTableId!==''&&typeof oSettings.aanFeatures.f=="undefined"){nFilter.setAttribute('id',oSettings.sTableId+'_filter')}var jqFilter=$("input",nFilter);jqFilter.val(oSettings.oPreviousSearch.sSearch.replace('"','&quot;'));jqFilter.bind('keyup.DT',function(e){var n=oSettings.aanFeatures.f;for(var i=0,iLen=n.length;i<iLen;i++){if(n[i]!=this.parentNode){$('input',n[i]).val(this.value)}}if(this.value!=oSettings.oPreviousSearch.sSearch){_fnFilterComplete(oSettings,{"sSearch":this.value,"bRegex":oSettings.oPreviousSearch.bRegex,"bSmart":oSettings.oPreviousSearch.bSmart})}});jqFilter.bind('keypress.DT',function(e){if(e.keyCode==13){return false}});return nFilter}function _fnFilterComplete(oSettings,oInput,iForce){_fnFilter(oSettings,oInput.sSearch,iForce,oInput.bRegex,oInput.bSmart);for(var i=0;i<oSettings.aoPreSearchCols.length;i++){_fnFilterColumn(oSettings,oSettings.aoPreSearchCols[i].sSearch,i,oSettings.aoPreSearchCols[i].bRegex,oSettings.aoPreSearchCols[i].bSmart)}if(_oExt.afnFiltering.length!==0){_fnFilterCustom(oSettings)}oSettings.bFiltered=true;oSettings._iDisplayStart=0;_fnCalculateEnd(oSettings);_fnDraw(oSettings);_fnBuildSearchArray(oSettings,0)}function _fnFilterCustom(oSettings){var afnFilters=_oExt.afnFiltering;for(var i=0,iLen=afnFilters.length;i<iLen;i++){var iCorrector=0;for(var j=0,jLen=oSettings.aiDisplay.length;j<jLen;j++){var iDisIndex=oSettings.aiDisplay[j-iCorrector];if(!afnFilters[i](oSettings,_fnGetRowData(oSettings,iDisIndex,'filter'),iDisIndex)){oSettings.aiDisplay.splice(j-iCorrector,1);iCorrector++}}}}function _fnFilterColumn(oSettings,sInput,iColumn,bRegex,bSmart){if(sInput===""){return}var iIndexCorrector=0;var rpSearch=_fnFilterCreateSearch(sInput,bRegex,bSmart);for(var i=oSettings.aiDisplay.length-1;i>=0;i--){var sData=_fnDataToSearch(_fnGetCellData(oSettings,oSettings.aiDisplay[i],iColumn,'filter'),oSettings.aoColumns[iColumn].sType);if(!rpSearch.test(sData)){oSettings.aiDisplay.splice(i,1);iIndexCorrector++}}}function _fnFilter(oSettings,sInput,iForce,bRegex,bSmart){var i;var rpSearch=_fnFilterCreateSearch(sInput,bRegex,bSmart);if(typeof iForce=='undefined'||iForce===null){iForce=0}if(_oExt.afnFiltering.length!==0){iForce=1}if(sInput.length<=0){oSettings.aiDisplay.splice(0,oSettings.aiDisplay.length);oSettings.aiDisplay=oSettings.aiDisplayMaster.slice()}else{if(oSettings.aiDisplay.length==oSettings.aiDisplayMaster.length||oSettings.oPreviousSearch.sSearch.length>sInput.length||iForce==1||sInput.indexOf(oSettings.oPreviousSearch.sSearch)!==0){oSettings.aiDisplay.splice(0,oSettings.aiDisplay.length);_fnBuildSearchArray(oSettings,1);for(i=0;i<oSettings.aiDisplayMaster.length;i++){if(rpSearch.test(oSettings.asDataSearch[i])){oSettings.aiDisplay.push(oSettings.aiDisplayMaster[i])}}}else{var iIndexCorrector=0;for(i=0;i<oSettings.asDataSearch.length;i++){if(!rpSearch.test(oSettings.asDataSearch[i])){oSettings.aiDisplay.splice(i-iIndexCorrector,1);iIndexCorrector++}}}}oSettings.oPreviousSearch.sSearch=sInput;oSettings.oPreviousSearch.bRegex=bRegex;oSettings.oPreviousSearch.bSmart=bSmart}function _fnBuildSearchArray(oSettings,iMaster){oSettings.asDataSearch.splice(0,oSettings.asDataSearch.length);var aArray=(typeof iMaster!='undefined'&&iMaster==1)?oSettings.aiDisplayMaster:oSettings.aiDisplay;for(var i=0,iLen=aArray.length;i<iLen;i++){oSettings.asDataSearch[i]=_fnBuildSearchRow(oSettings,_fnGetRowData(oSettings,aArray[i],'filter'))}}function _fnBuildSearchRow(oSettings,aData){var sSearch='';if(typeof oSettings.__nTmpFilter=='undefined'){oSettings.__nTmpFilter=document.createElement('div')}var nTmp=oSettings.__nTmpFilter;for(var j=0,jLen=oSettings.aoColumns.length;j<jLen;j++){if(oSettings.aoColumns[j].bSearchable){var sData=aData[j];sSearch+=_fnDataToSearch(sData,oSettings.aoColumns[j].sType)+'  '}}if(sSearch.indexOf('&')!==-1){nTmp.innerHTML=sSearch;sSearch=nTmp.textContent?nTmp.textContent:nTmp.innerText;sSearch=sSearch.replace(/\n/g," ").replace(/\r/g,"")}return sSearch}function _fnFilterCreateSearch(sSearch,bRegex,bSmart){var asSearch,sRegExpString;if(bSmart){asSearch=bRegex?sSearch.split(' '):_fnEscapeRegex(sSearch).split(' ');sRegExpString='^(?=.*?'+asSearch.join(')(?=.*?')+').*$';return new RegExp(sRegExpString,"i")}else{sSearch=bRegex?sSearch:_fnEscapeRegex(sSearch);return new RegExp(sSearch,"i")}}function _fnDataToSearch(sData,sType){if(typeof _oExt.ofnSearch[sType]=="function"){return _oExt.ofnSearch[sType](sData)}else if(sType=="html"){return sData.replace(/\n/g," ").replace(/<.*?>/g,"")}else if(typeof sData=="string"){return sData.replace(/\n/g," ")}else if(sData===null){return''}return sData}function _fnSort(oSettings,bApplyClasses){var iDataSort,iDataType,i,iLen,j,jLen,aaSort=[],aiOrig=[],oSort=_oExt.oSort,aoData=oSettings.aoData,aoColumns=oSettings.aoColumns;if(!oSettings.oFeatures.bServerSide&&(oSettings.aaSorting.length!==0||oSettings.aaSortingFixed!==null)){if(oSettings.aaSortingFixed!==null){aaSort=oSettings.aaSortingFixed.concat(oSettings.aaSorting)}else{aaSort=oSettings.aaSorting.slice()}for(i=0;i<aaSort.length;i++){var iColumn=aaSort[i][0];var iVisColumn=_fnColumnIndexToVisible(oSettings,iColumn);var sDataType=oSettings.aoColumns[iColumn].sSortDataType;if(typeof _oExt.afnSortData[sDataType]!='undefined'){var aData=_oExt.afnSortData[sDataType](oSettings,iColumn,iVisColumn);for(j=0,jLen=aoData.length;j<jLen;j++){_fnSetCellData(oSettings,j,iColumn,aData[j])}}}for(i=0,iLen=oSettings.aiDisplayMaster.length;i<iLen;i++){aiOrig[oSettings.aiDisplayMaster[i]]=i}var iSortLen=aaSort.length;oSettings.aiDisplayMaster.sort(function(a,b){var iTest,iDataSort,sDataType;for(i=0;i<iSortLen;i++){iDataSort=aoColumns[aaSort[i][0]].iDataSort;sDataType=aoColumns[iDataSort].sType;iTest=oSort[(sDataType?sDataType:'string')+"-"+aaSort[i][1]](_fnGetCellData(oSettings,a,iDataSort,'sort'),_fnGetCellData(oSettings,b,iDataSort,'sort'));if(iTest!==0){return iTest}}return oSort['numeric-asc'](aiOrig[a],aiOrig[b])})}if((typeof bApplyClasses=='undefined'||bApplyClasses)&&!oSettings.oFeatures.bDeferRender){_fnSortingClasses(oSettings)}oSettings.bSorted=true;if(oSettings.oFeatures.bFilter){_fnFilterComplete(oSettings,oSettings.oPreviousSearch,1)}else{oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();oSettings._iDisplayStart=0;_fnCalculateEnd(oSettings);_fnDraw(oSettings)}}function _fnSortAttachListener(oSettings,nNode,iDataIndex,fnCallback){$(nNode).bind('click.DT',function(e){if(oSettings.aoColumns[iDataIndex].bSortable===false){return}var fnInnerSorting=function(){var iColumn,iNextSort;if(e.shiftKey){var bFound=false;for(var i=0;i<oSettings.aaSorting.length;i++){if(oSettings.aaSorting[i][0]==iDataIndex){bFound=true;iColumn=oSettings.aaSorting[i][0];iNextSort=oSettings.aaSorting[i][2]+1;if(typeof oSettings.aoColumns[iColumn].asSorting[iNextSort]=='undefined'){oSettings.aaSorting.splice(i,1)}else{oSettings.aaSorting[i][1]=oSettings.aoColumns[iColumn].asSorting[iNextSort];oSettings.aaSorting[i][2]=iNextSort}break}}if(bFound===false){oSettings.aaSorting.push([iDataIndex,oSettings.aoColumns[iDataIndex].asSorting[0],0])}}else{if(oSettings.aaSorting.length==1&&oSettings.aaSorting[0][0]==iDataIndex){iColumn=oSettings.aaSorting[0][0];iNextSort=oSettings.aaSorting[0][2]+1;if(typeof oSettings.aoColumns[iColumn].asSorting[iNextSort]=='undefined'){iNextSort=0}oSettings.aaSorting[0][1]=oSettings.aoColumns[iColumn].asSorting[iNextSort];oSettings.aaSorting[0][2]=iNextSort}else{oSettings.aaSorting.splice(0,oSettings.aaSorting.length);oSettings.aaSorting.push([iDataIndex,oSettings.aoColumns[iDataIndex].asSorting[0],0])}}_fnSort(oSettings)};if(!oSettings.oFeatures.bProcessing){fnInnerSorting()}else{_fnProcessingDisplay(oSettings,true);setTimeout(function(){fnInnerSorting();if(!oSettings.oFeatures.bServerSide){_fnProcessingDisplay(oSettings,false)}},0)}if(typeof fnCallback=='function'){fnCallback(oSettings)}})}function _fnSortingClasses(oSettings){var i,iLen,j,jLen,iFound;var aaSort,sClass;var iColumns=oSettings.aoColumns.length;var oClasses=oSettings.oClasses;for(i=0;i<iColumns;i++){if(oSettings.aoColumns[i].bSortable){$(oSettings.aoColumns[i].nTh).removeClass(oClasses.sSortAsc+" "+oClasses.sSortDesc+" "+oSettings.aoColumns[i].sSortingClass)}}if(oSettings.aaSortingFixed!==null){aaSort=oSettings.aaSortingFixed.concat(oSettings.aaSorting)}else{aaSort=oSettings.aaSorting.slice()}for(i=0;i<oSettings.aoColumns.length;i++){if(oSettings.aoColumns[i].bSortable){sClass=oSettings.aoColumns[i].sSortingClass;iFound=-1;for(j=0;j<aaSort.length;j++){if(aaSort[j][0]==i){sClass=(aaSort[j][1]=="asc")?oClasses.sSortAsc:oClasses.sSortDesc;iFound=j;break}}$(oSettings.aoColumns[i].nTh).addClass(sClass);if(oSettings.bJUI){var jqSpan=$("span",oSettings.aoColumns[i].nTh);jqSpan.removeClass(oClasses.sSortJUIAsc+" "+oClasses.sSortJUIDesc+" "+oClasses.sSortJUI+" "+oClasses.sSortJUIAscAllowed+" "+oClasses.sSortJUIDescAllowed);var sSpanClass;if(iFound==-1){sSpanClass=oSettings.aoColumns[i].sSortingClassJUI}else if(aaSort[iFound][1]=="asc"){sSpanClass=oClasses.sSortJUIAsc}else{sSpanClass=oClasses.sSortJUIDesc}jqSpan.addClass(sSpanClass)}}else{$(oSettings.aoColumns[i].nTh).addClass(oSettings.aoColumns[i].sSortingClass)}}sClass=oClasses.sSortColumn;if(oSettings.oFeatures.bSort&&oSettings.oFeatures.bSortClasses){var nTds=_fnGetTdNodes(oSettings);if(oSettings.oFeatures.bDeferRender){$(nTds).removeClass(sClass+'1 '+sClass+'2 '+sClass+'3')}else if(nTds.length>=iColumns){for(i=0;i<iColumns;i++){if(nTds[i].className.indexOf(sClass+"1")!=-1){for(j=0,jLen=(nTds.length/iColumns);j<jLen;j++){nTds[(iColumns*j)+i].className=$.trim(nTds[(iColumns*j)+i].className.replace(sClass+"1",""))}}else if(nTds[i].className.indexOf(sClass+"2")!=-1){for(j=0,jLen=(nTds.length/iColumns);j<jLen;j++){nTds[(iColumns*j)+i].className=$.trim(nTds[(iColumns*j)+i].className.replace(sClass+"2",""))}}else if(nTds[i].className.indexOf(sClass+"3")!=-1){for(j=0,jLen=(nTds.length/iColumns);j<jLen;j++){nTds[(iColumns*j)+i].className=$.trim(nTds[(iColumns*j)+i].className.replace(" "+sClass+"3",""))}}}}var iClass=1,iTargetCol;for(i=0;i<aaSort.length;i++){iTargetCol=parseInt(aaSort[i][0],10);for(j=0,jLen=(nTds.length/iColumns);j<jLen;j++){nTds[(iColumns*j)+iTargetCol].className+=" "+sClass+iClass}if(iClass<3){iClass++}}}}function _fnFeatureHtmlPaginate(oSettings){if(oSettings.oScroll.bInfinite){return null}var nPaginate=document.createElement('div');nPaginate.className=oSettings.oClasses.sPaging+oSettings.sPaginationType;_oExt.oPagination[oSettings.sPaginationType].fnInit(oSettings,nPaginate,function(oSettings){_fnCalculateEnd(oSettings);_fnDraw(oSettings)});if(typeof oSettings.aanFeatures.p=="undefined"){oSettings.aoDrawCallback.push({"fn":function(oSettings){_oExt.oPagination[oSettings.sPaginationType].fnUpdate(oSettings,function(oSettings){_fnCalculateEnd(oSettings);_fnDraw(oSettings)})},"sName":"pagination"})}return nPaginate}function _fnPageChange(oSettings,sAction){var iOldStart=oSettings._iDisplayStart;if(sAction=="first"){oSettings._iDisplayStart=0}else if(sAction=="previous"){oSettings._iDisplayStart=oSettings._iDisplayLength>=0?oSettings._iDisplayStart-oSettings._iDisplayLength:0;if(oSettings._iDisplayStart<0){oSettings._iDisplayStart=0}}else if(sAction=="next"){if(oSettings._iDisplayLength>=0){if(oSettings._iDisplayStart+oSettings._iDisplayLength<oSettings.fnRecordsDisplay()){oSettings._iDisplayStart+=oSettings._iDisplayLength}}else{oSettings._iDisplayStart=0}}else if(sAction=="last"){if(oSettings._iDisplayLength>=0){var iPages=parseInt((oSettings.fnRecordsDisplay()-1)/oSettings._iDisplayLength,10)+1;oSettings._iDisplayStart=(iPages-1)*oSettings._iDisplayLength}else{oSettings._iDisplayStart=0}}else{_fnLog(oSettings,0,"Unknown paging action: "+sAction)}return iOldStart!=oSettings._iDisplayStart}function _fnFeatureHtmlInfo(oSettings){var nInfo=document.createElement('div');nInfo.className=oSettings.oClasses.sInfo;if(typeof oSettings.aanFeatures.i=="undefined"){oSettings.aoDrawCallback.push({"fn":_fnUpdateInfo,"sName":"information"});if(oSettings.sTableId!==''){nInfo.setAttribute('id',oSettings.sTableId+'_info')}}return nInfo}function _fnUpdateInfo(oSettings){if(!oSettings.oFeatures.bInfo||oSettings.aanFeatures.i.length===0){return}var iStart=oSettings._iDisplayStart+1,iEnd=oSettings.fnDisplayEnd(),iMax=oSettings.fnRecordsTotal(),iTotal=oSettings.fnRecordsDisplay(),sStart=oSettings.fnFormatNumber(iStart),sEnd=oSettings.fnFormatNumber(iEnd),sMax=oSettings.fnFormatNumber(iMax),sTotal=oSettings.fnFormatNumber(iTotal),sOut;if(oSettings.oScroll.bInfinite){sStart=oSettings.fnFormatNumber(1)}if(oSettings.fnRecordsDisplay()===0&&oSettings.fnRecordsDisplay()==oSettings.fnRecordsTotal()){sOut=oSettings.oLanguage.sInfoEmpty+oSettings.oLanguage.sInfoPostFix}else if(oSettings.fnRecordsDisplay()===0){sOut=oSettings.oLanguage.sInfoEmpty+' '+oSettings.oLanguage.sInfoFiltered.replace('_MAX_',sMax)+oSettings.oLanguage.sInfoPostFix}else if(oSettings.fnRecordsDisplay()==oSettings.fnRecordsTotal()){sOut=oSettings.oLanguage.sInfo.replace('_START_',sStart).replace('_END_',sEnd).replace('_TOTAL_',sTotal)+oSettings.oLanguage.sInfoPostFix}else{sOut=oSettings.oLanguage.sInfo.replace('_START_',sStart).replace('_END_',sEnd).replace('_TOTAL_',sTotal)+' '+oSettings.oLanguage.sInfoFiltered.replace('_MAX_',oSettings.fnFormatNumber(oSettings.fnRecordsTotal()))+oSettings.oLanguage.sInfoPostFix}if(oSettings.oLanguage.fnInfoCallback!==null){sOut=oSettings.oLanguage.fnInfoCallback(oSettings,iStart,iEnd,iMax,iTotal,sOut)}var n=oSettings.aanFeatures.i;for(var i=0,iLen=n.length;i<iLen;i++){$(n[i]).html(sOut)}}function _fnFeatureHtmlLength(oSettings){if(oSettings.oScroll.bInfinite){return null}var sName=(oSettings.sTableId==="")?"":'name="'+oSettings.sTableId+'_length"';var sStdMenu='<select size="1" '+sName+'>';var i,iLen;if(oSettings.aLengthMenu.length==2&&typeof oSettings.aLengthMenu[0]=='object'&&typeof oSettings.aLengthMenu[1]=='object'){for(i=0,iLen=oSettings.aLengthMenu[0].length;i<iLen;i++){sStdMenu+='<option value="'+oSettings.aLengthMenu[0][i]+'">'+oSettings.aLengthMenu[1][i]+'</option>'}}else{for(i=0,iLen=oSettings.aLengthMenu.length;i<iLen;i++){sStdMenu+='<option value="'+oSettings.aLengthMenu[i]+'">'+oSettings.aLengthMenu[i]+'</option>'}}sStdMenu+='</select>';var nLength=document.createElement('div');if(oSettings.sTableId!==''&&typeof oSettings.aanFeatures.l=="undefined"){nLength.setAttribute('id',oSettings.sTableId+'_length')}nLength.className=oSettings.oClasses.sLength;nLength.innerHTML='<label>'+oSettings.oLanguage.sLengthMenu.replace('_MENU_',sStdMenu)+'</label>';$('select option[value="'+oSettings._iDisplayLength+'"]',nLength).attr("selected",true);$('select',nLength).bind('change.DT',function(e){var iVal=$(this).val();var n=oSettings.aanFeatures.l;for(i=0,iLen=n.length;i<iLen;i++){if(n[i]!=this.parentNode){$('select',n[i]).val(iVal)}}oSettings._iDisplayLength=parseInt(iVal,10);_fnCalculateEnd(oSettings);if(oSettings.fnDisplayEnd()==oSettings.fnRecordsDisplay()){oSettings._iDisplayStart=oSettings.fnDisplayEnd()-oSettings._iDisplayLength;if(oSettings._iDisplayStart<0){oSettings._iDisplayStart=0}}if(oSettings._iDisplayLength==-1){oSettings._iDisplayStart=0}_fnDraw(oSettings)});return nLength}function _fnFeatureHtmlProcessing(oSettings){var nProcessing=document.createElement('div');if(oSettings.sTableId!==''&&typeof oSettings.aanFeatures.r=="undefined"){nProcessing.setAttribute('id',oSettings.sTableId+'_processing')}nProcessing.innerHTML=oSettings.oLanguage.sProcessing;nProcessing.className=oSettings.oClasses.sProcessing;oSettings.nTable.parentNode.insertBefore(nProcessing,oSettings.nTable);return nProcessing}function _fnProcessingDisplay(oSettings,bShow){if(oSettings.oFeatures.bProcessing){var an=oSettings.aanFeatures.r;for(var i=0,iLen=an.length;i<iLen;i++){an[i].style.visibility=bShow?"visible":"hidden"}}}function _fnVisibleToColumnIndex(oSettings,iMatch){var iColumn=-1;for(var i=0;i<oSettings.aoColumns.length;i++){if(oSettings.aoColumns[i].bVisible===true){iColumn++}if(iColumn==iMatch){return i}}return null}function _fnColumnIndexToVisible(oSettings,iMatch){var iVisible=-1;for(var i=0;i<oSettings.aoColumns.length;i++){if(oSettings.aoColumns[i].bVisible===true){iVisible++}if(i==iMatch){return oSettings.aoColumns[i].bVisible===true?iVisible:null}}return null}function _fnNodeToDataIndex(s,n){var i,iLen;for(i=s._iDisplayStart,iLen=s._iDisplayEnd;i<iLen;i++){if(s.aoData[s.aiDisplay[i]].nTr==n){return s.aiDisplay[i]}}for(i=0,iLen=s.aoData.length;i<iLen;i++){if(s.aoData[i].nTr==n){return i}}return null}function _fnVisbleColumns(oS){var iVis=0;for(var i=0;i<oS.aoColumns.length;i++){if(oS.aoColumns[i].bVisible===true){iVis++}}return iVis}function _fnCalculateEnd(oSettings){if(oSettings.oFeatures.bPaginate===false){oSettings._iDisplayEnd=oSettings.aiDisplay.length}else{if(oSettings._iDisplayStart+oSettings._iDisplayLength>oSettings.aiDisplay.length||oSettings._iDisplayLength==-1){oSettings._iDisplayEnd=oSettings.aiDisplay.length}else{oSettings._iDisplayEnd=oSettings._iDisplayStart+oSettings._iDisplayLength}}}function _fnConvertToWidth(sWidth,nParent){if(!sWidth||sWidth===null||sWidth===''){return 0}if(typeof nParent=="undefined"){nParent=document.getElementsByTagName('body')[0]}var iWidth;var nTmp=document.createElement("div");nTmp.style.width=_fnStringToCss(sWidth);nParent.appendChild(nTmp);iWidth=nTmp.offsetWidth;nParent.removeChild(nTmp);return(iWidth)}function _fnCalculateColumnWidths(oSettings){var iTableWidth=oSettings.nTable.offsetWidth;var iUserInputs=0;var iTmpWidth;var iVisibleColumns=0;var iColums=oSettings.aoColumns.length;var i,iIndex,iCorrector,iWidth;var oHeaders=$('th',oSettings.nTHead);for(i=0;i<iColums;i++){if(oSettings.aoColumns[i].bVisible){iVisibleColumns++;if(oSettings.aoColumns[i].sWidth!==null){iTmpWidth=_fnConvertToWidth(oSettings.aoColumns[i].sWidthOrig,oSettings.nTable.parentNode);if(iTmpWidth!==null){oSettings.aoColumns[i].sWidth=_fnStringToCss(iTmpWidth)}iUserInputs++}}}if(iColums==oHeaders.length&&iUserInputs===0&&iVisibleColumns==iColums&&oSettings.oScroll.sX===""&&oSettings.oScroll.sY===""){for(i=0;i<oSettings.aoColumns.length;i++){iTmpWidth=$(oHeaders[i]).width();if(iTmpWidth!==null){oSettings.aoColumns[i].sWidth=_fnStringToCss(iTmpWidth)}}}else{var nCalcTmp=oSettings.nTable.cloneNode(false),nTheadClone=oSettings.nTHead.cloneNode(true),nBody=document.createElement('tbody'),nTr=document.createElement('tr'),nDivSizing;nCalcTmp.removeAttribute("id");nCalcTmp.appendChild(nTheadClone);if(oSettings.nTFoot!==null){nCalcTmp.appendChild(oSettings.nTFoot.cloneNode(true));_fnApplyToChildren(function(n){n.style.width=""},nCalcTmp.getElementsByTagName('tr'))}nCalcTmp.appendChild(nBody);nBody.appendChild(nTr);var jqColSizing=$('thead th',nCalcTmp);if(jqColSizing.length===0){jqColSizing=$('tbody tr:eq(0)>td',nCalcTmp)}var nThs=_fnGetUniqueThs(oSettings,nTheadClone);iCorrector=0;for(i=0;i<iColums;i++){var oColumn=oSettings.aoColumns[i];if(oColumn.bVisible&&oColumn.sWidthOrig!==null&&oColumn.sWidthOrig!==""){nThs[i-iCorrector].style.width=_fnStringToCss(oColumn.sWidthOrig)}else if(oColumn.bVisible){nThs[i-iCorrector].style.width=""}else{iCorrector++}}for(i=0;i<iColums;i++){if(oSettings.aoColumns[i].bVisible){var nTd=_fnGetWidestNode(oSettings,i);if(nTd!==null){nTd=nTd.cloneNode(true);if(oSettings.aoColumns[i].sContentPadding!==""){nTd.innerHTML+=oSettings.aoColumns[i].sContentPadding}nTr.appendChild(nTd)}}}var nWrapper=oSettings.nTable.parentNode;nWrapper.appendChild(nCalcTmp);if(oSettings.oScroll.sX!==""&&oSettings.oScroll.sXInner!==""){nCalcTmp.style.width=_fnStringToCss(oSettings.oScroll.sXInner)}else if(oSettings.oScroll.sX!==""){nCalcTmp.style.width="";if($(nCalcTmp).width()<nWrapper.offsetWidth){nCalcTmp.style.width=_fnStringToCss(nWrapper.offsetWidth)}}else if(oSettings.oScroll.sY!==""){nCalcTmp.style.width=_fnStringToCss(nWrapper.offsetWidth)}nCalcTmp.style.visibility="hidden";_fnScrollingWidthAdjust(oSettings,nCalcTmp);var oNodes=$("tbody tr:eq(0)",nCalcTmp).children();if(oNodes.length===0){oNodes=_fnGetUniqueThs(oSettings,$('thead',nCalcTmp)[0])}if(oSettings.oScroll.sX!==""){var iTotal=0;iCorrector=0;for(i=0;i<oSettings.aoColumns.length;i++){if(oSettings.aoColumns[i].bVisible){if(oSettings.aoColumns[i].sWidthOrig===null){iTotal+=$(oNodes[iCorrector]).outerWidth()}else{iTotal+=parseInt(oSettings.aoColumns[i].sWidth.replace('px',''),10)+($(oNodes[iCorrector]).outerWidth()-$(oNodes[iCorrector]).width())}iCorrector++}}nCalcTmp.style.width=_fnStringToCss(iTotal);oSettings.nTable.style.width=_fnStringToCss(iTotal)}iCorrector=0;for(i=0;i<oSettings.aoColumns.length;i++){if(oSettings.aoColumns[i].bVisible){iWidth=$(oNodes[iCorrector]).width();if(iWidth!==null&&iWidth>0){oSettings.aoColumns[i].sWidth=_fnStringToCss(iWidth)}iCorrector++}}oSettings.nTable.style.width=_fnStringToCss($(nCalcTmp).outerWidth());nCalcTmp.parentNode.removeChild(nCalcTmp)}}function _fnScrollingWidthAdjust(oSettings,n){if(oSettings.oScroll.sX===""&&oSettings.oScroll.sY!==""){var iOrigWidth=$(n).width();n.style.width=_fnStringToCss($(n).outerWidth()-oSettings.oScroll.iBarWidth)}else if(oSettings.oScroll.sX!==""){n.style.width=_fnStringToCss($(n).outerWidth())}}function _fnGetWidestNode(oSettings,iCol){var iMaxIndex=_fnGetMaxLenString(oSettings,iCol);if(iMaxIndex<0){return null}if(oSettings.aoData[iMaxIndex].nTr===null){var n=document.createElement('td');n.innerHTML=_fnGetCellData(oSettings,iMaxIndex,iCol,'');return n}return _fnGetTdNodes(oSettings,iMaxIndex)[iCol]}function _fnGetMaxLenString(oSettings,iCol){var iMax=-1;var iMaxIndex=-1;for(var i=0;i<oSettings.aoData.length;i++){var s=_fnGetCellData(oSettings,i,iCol,'display')+"";s=s.replace(/<.*?>/g,"");if(s.length>iMax){iMax=s.length;iMaxIndex=i}}return iMaxIndex}function _fnStringToCss(s){if(s===null){return"0px"}if(typeof s=='number'){if(s<0){return"0px"}return s+"px"}var c=s.charCodeAt(s.length-1);if(c<0x30||c>0x39){return s}return s+"px"}function _fnArrayCmp(aArray1,aArray2){if(aArray1.length!=aArray2.length){return 1}for(var i=0;i<aArray1.length;i++){if(aArray1[i]!=aArray2[i]){return 2}}return 0}function _fnDetectType(sData){var aTypes=_oExt.aTypes;var iLen=aTypes.length;for(var i=0;i<iLen;i++){var sType=aTypes[i](sData);if(sType!==null){return sType}}return'string'}function _fnSettingsFromNode(nTable){for(var i=0;i<_aoSettings.length;i++){if(_aoSettings[i].nTable==nTable){return _aoSettings[i]}}return null}function _fnGetDataMaster(oSettings){var aData=[];var iLen=oSettings.aoData.length;for(var i=0;i<iLen;i++){aData.push(oSettings.aoData[i]._aData)}return aData}function _fnGetTrNodes(oSettings){var aNodes=[];for(var i=0,iLen=oSettings.aoData.length;i<iLen;i++){if(oSettings.aoData[i].nTr!==null){aNodes.push(oSettings.aoData[i].nTr)}}return aNodes}function _fnGetTdNodes(oSettings,iIndividualRow){var anReturn=[];var iCorrector;var anTds;var iRow,iRows=oSettings.aoData.length,iColumn,iColumns,oData,sNodeName,iStart=0,iEnd=iRows;if(typeof iIndividualRow!='undefined'){iStart=iIndividualRow;iEnd=iIndividualRow+1}for(iRow=iStart;iRow<iEnd;iRow++){oData=oSettings.aoData[iRow];if(oData.nTr!==null){anTds=[];for(iColumn=0,iColumns=oData.nTr.childNodes.length;iColumn<iColumns;iColumn++){sNodeName=oData.nTr.childNodes[iColumn].nodeName.toLowerCase();if(sNodeName=='td'||sNodeName=='th'){anTds.push(oData.nTr.childNodes[iColumn])}}iCorrector=0;for(iColumn=0,iColumns=oSettings.aoColumns.length;iColumn<iColumns;iColumn++){if(oSettings.aoColumns[iColumn].bVisible){anReturn.push(anTds[iColumn-iCorrector])}else{anReturn.push(oData._anHidden[iColumn]);iCorrector++}}}}return anReturn}function _fnEscapeRegex(sVal){var acEscape=['/','.','*','+','?','|','(',')','[',']','{','}','\\','$','^'];var reReplace=new RegExp('(\\'+acEscape.join('|\\')+')','g');return sVal.replace(reReplace,'\\$1')}function _fnDeleteIndex(a,iTarget){var iTargetIndex=-1;for(var i=0,iLen=a.length;i<iLen;i++){if(a[i]==iTarget){iTargetIndex=i}else if(a[i]>iTarget){a[i]--}}if(iTargetIndex!=-1){a.splice(iTargetIndex,1)}}function _fnReOrderIndex(oSettings,sColumns){var aColumns=sColumns.split(',');var aiReturn=[];for(var i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){for(var j=0;j<iLen;j++){if(oSettings.aoColumns[i].sName==aColumns[j]){aiReturn.push(j);break}}}return aiReturn}function _fnColumnOrdering(oSettings){var sNames='';for(var i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){sNames+=oSettings.aoColumns[i].sName+','}if(sNames.length==iLen){return""}return sNames.slice(0,-1)}function _fnLog(oSettings,iLevel,sMesg){var sAlert=oSettings.sTableId===""?"DataTables warning: "+sMesg:"DataTables warning (table id = '"+oSettings.sTableId+"'): "+sMesg;if(iLevel===0){if(_oExt.sErrMode=='alert'){alert(sAlert)}else{throw sAlert}return}else if(typeof console!='undefined'&&typeof console.log!='undefined'){console.log(sAlert)}}function _fnClearTable(oSettings){oSettings.aoData.splice(0,oSettings.aoData.length);oSettings.aiDisplayMaster.splice(0,oSettings.aiDisplayMaster.length);oSettings.aiDisplay.splice(0,oSettings.aiDisplay.length);_fnCalculateEnd(oSettings)}function _fnSaveState(oSettings){if(!oSettings.oFeatures.bStateSave||typeof oSettings.bDestroying!='undefined'){return}var i,iLen,sTmp;var sValue="{";sValue+='"iCreate":'+new Date().getTime()+',';sValue+='"iStart":'+(oSettings.oScroll.bInfinite?0:oSettings._iDisplayStart)+',';sValue+='"iEnd":'+(oSettings.oScroll.bInfinite?oSettings._iDisplayLength:oSettings._iDisplayEnd)+',';sValue+='"iLength":'+oSettings._iDisplayLength+',';sValue+='"sFilter":"'+encodeURIComponent(oSettings.oPreviousSearch.sSearch)+'",';sValue+='"sFilterEsc":'+!oSettings.oPreviousSearch.bRegex+',';sValue+='"aaSorting":[ ';for(i=0;i<oSettings.aaSorting.length;i++){sValue+='['+oSettings.aaSorting[i][0]+',"'+oSettings.aaSorting[i][1]+'"],'}sValue=sValue.substring(0,sValue.length-1);sValue+="],";sValue+='"aaSearchCols":[ ';for(i=0;i<oSettings.aoPreSearchCols.length;i++){sValue+='["'+encodeURIComponent(oSettings.aoPreSearchCols[i].sSearch)+'",'+!oSettings.aoPreSearchCols[i].bRegex+'],'}sValue=sValue.substring(0,sValue.length-1);sValue+="],";sValue+='"abVisCols":[ ';for(i=0;i<oSettings.aoColumns.length;i++){sValue+=oSettings.aoColumns[i].bVisible+","}sValue=sValue.substring(0,sValue.length-1);sValue+="]";for(i=0,iLen=oSettings.aoStateSave.length;i<iLen;i++){sTmp=oSettings.aoStateSave[i].fn(oSettings,sValue);if(sTmp!==""){sValue=sTmp}}sValue+="}";_fnCreateCookie(oSettings.sCookiePrefix+oSettings.sInstance,sValue,oSettings.iCookieDuration,oSettings.sCookiePrefix,oSettings.fnCookieCallback)}function _fnLoadState(oSettings,oInit){if(!oSettings.oFeatures.bStateSave){return}var oData,i,iLen;var sData=_fnReadCookie(oSettings.sCookiePrefix+oSettings.sInstance);if(sData!==null&&sData!==''){try{oData=(typeof $.parseJSON=='function')?$.parseJSON(sData.replace(/'/g,'"')):eval('('+sData+')')}catch(e){return}for(i=0,iLen=oSettings.aoStateLoad.length;i<iLen;i++){if(!oSettings.aoStateLoad[i].fn(oSettings,oData)){return}}oSettings.oLoadedState=$.extend(true,{},oData);oSettings._iDisplayStart=oData.iStart;oSettings.iInitDisplayStart=oData.iStart;oSettings._iDisplayEnd=oData.iEnd;oSettings._iDisplayLength=oData.iLength;oSettings.oPreviousSearch.sSearch=decodeURIComponent(oData.sFilter);oSettings.aaSorting=oData.aaSorting.slice();oSettings.saved_aaSorting=oData.aaSorting.slice();if(typeof oData.sFilterEsc!='undefined'){oSettings.oPreviousSearch.bRegex=!oData.sFilterEsc}if(typeof oData.aaSearchCols!='undefined'){for(i=0;i<oData.aaSearchCols.length;i++){oSettings.aoPreSearchCols[i]={"sSearch":decodeURIComponent(oData.aaSearchCols[i][0]),"bRegex":!oData.aaSearchCols[i][1]}}}if(typeof oData.abVisCols!='undefined'){oInit.saved_aoColumns=[];for(i=0;i<oData.abVisCols.length;i++){oInit.saved_aoColumns[i]={};oInit.saved_aoColumns[i].bVisible=oData.abVisCols[i]}}}}function _fnCreateCookie(sName,sValue,iSecs,sBaseName,fnCallback){var date=new Date();date.setTime(date.getTime()+(iSecs*1000));var aParts=window.location.pathname.split('/');var sNameFile=sName+'_'+aParts.pop().replace(/[\/:]/g,"").toLowerCase();var sFullCookie,oData;if(fnCallback!==null){oData=(typeof $.parseJSON=='function')?$.parseJSON(sValue):eval('('+sValue+')');sFullCookie=fnCallback(sNameFile,oData,date.toGMTString(),aParts.join('/')+"/")}else{sFullCookie=sNameFile+"="+encodeURIComponent(sValue)+"; expires="+date.toGMTString()+"; path="+aParts.join('/')+"/"}var sOldName="",iOldTime=9999999999999;var iLength=_fnReadCookie(sNameFile)!==null?document.cookie.length:sFullCookie.length+document.cookie.length;if(iLength+10>4096){var aCookies=document.cookie.split(';');for(var i=0,iLen=aCookies.length;i<iLen;i++){if(aCookies[i].indexOf(sBaseName)!=-1){var aSplitCookie=aCookies[i].split('=');try{oData=eval('('+decodeURIComponent(aSplitCookie[1])+')')}catch(e){continue}if(typeof oData.iCreate!='undefined'&&oData.iCreate<iOldTime){sOldName=aSplitCookie[0];iOldTime=oData.iCreate}}}if(sOldName!==""){document.cookie=sOldName+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path="+aParts.join('/')+"/"}}document.cookie=sFullCookie}function _fnReadCookie(sName){var aParts=window.location.pathname.split('/'),sNameEQ=sName+'_'+aParts[aParts.length-1].replace(/[\/:]/g,"").toLowerCase()+'=',sCookieContents=document.cookie.split(';');for(var i=0;i<sCookieContents.length;i++){var c=sCookieContents[i];while(c.charAt(0)==' '){c=c.substring(1,c.length)}if(c.indexOf(sNameEQ)===0){return decodeURIComponent(c.substring(sNameEQ.length,c.length))}}return null}function _fnDetectHeader(aLayout,nThead){var nTrs=nThead.getElementsByTagName('tr');var nCell;var i,j,k,l,iLen,jLen,iColShifted;var fnShiftCol=function(a,i,j){while(typeof a[i][j]!='undefined'){j++}return j};aLayout.splice(0,aLayout.length);for(i=0,iLen=nTrs.length;i<iLen;i++){aLayout.push([])}for(i=0,iLen=nTrs.length;i<iLen;i++){var iColumn=0;for(j=0,jLen=nTrs[i].childNodes.length;j<jLen;j++){nCell=nTrs[i].childNodes[j];if(nCell.nodeName.toUpperCase()=="TD"||nCell.nodeName.toUpperCase()=="TH"){var iColspan=nCell.getAttribute('colspan')*1;var iRowspan=nCell.getAttribute('rowspan')*1;iColspan=(!iColspan||iColspan===0||iColspan===1)?1:iColspan;iRowspan=(!iRowspan||iRowspan===0||iRowspan===1)?1:iRowspan;iColShifted=fnShiftCol(aLayout,i,iColumn);for(l=0;l<iColspan;l++){for(k=0;k<iRowspan;k++){aLayout[i+k][iColShifted+l]={"cell":nCell,"unique":iColspan==1?true:false};aLayout[i+k].nTr=nTrs[i]}}}}}}function _fnGetUniqueThs(oSettings,nHeader,aLayout){var aReturn=[];if(typeof aLayout=='undefined'){aLayout=oSettings.aoHeader;if(typeof nHeader!='undefined'){aLayout=[];_fnDetectHeader(aLayout,nHeader)}}for(var i=0,iLen=aLayout.length;i<iLen;i++){for(var j=0,jLen=aLayout[i].length;j<jLen;j++){if(aLayout[i][j].unique&&(typeof aReturn[j]=='undefined'||!oSettings.bSortCellsTop)){aReturn[j]=aLayout[i][j].cell}}}return aReturn}function _fnScrollBarWidth(){var inner=document.createElement('p');var style=inner.style;style.width="100%";style.height="200px";var outer=document.createElement('div');style=outer.style;style.position="absolute";style.top="0px";style.left="0px";style.visibility="hidden";style.width="200px";style.height="150px";style.overflow="hidden";outer.appendChild(inner);document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow='scroll';var w2=inner.offsetWidth;if(w1==w2){w2=outer.clientWidth}document.body.removeChild(outer);return(w1-w2)}function _fnApplyToChildren(fn,an1,an2){for(var i=0,iLen=an1.length;i<iLen;i++){for(var j=0,jLen=an1[i].childNodes.length;j<jLen;j++){if(an1[i].childNodes[j].nodeType==1){if(typeof an2!='undefined'){fn(an1[i].childNodes[j],an2[i].childNodes[j])}else{fn(an1[i].childNodes[j])}}}}}function _fnMap(oRet,oSrc,sName,sMappedName){if(typeof sMappedName=='undefined'){sMappedName=sName}if(typeof oSrc[sName]!='undefined'){oRet[sMappedName]=oSrc[sName]}}function _fnGetRowData(oSettings,iRow,sSpecific){var out=[];for(var i=0,iLen=oSettings.aoColumns.length;i<iLen;i++){out.push(_fnGetCellData(oSettings,iRow,i,sSpecific))}return out}function _fnGetCellData(oSettings,iRow,iCol,sSpecific){var sData;var oCol=oSettings.aoColumns[iCol];var oData=oSettings.aoData[iRow]._aData;if((sData=oCol.fnGetData(oData))===undefined){if(oSettings.iDrawError!=oSettings.iDraw&&oCol.sDefaultContent===null){_fnLog(oSettings,0,"Requested unknown parameter '"+oCol.mDataProp+"' from the data source for row "+iRow);oSettings.iDrawError=oSettings.iDraw}return oCol.sDefaultContent}if(sData===null&&oCol.sDefaultContent!==null){sData=oCol.sDefaultContent}if(sSpecific=='display'&&sData===null){return''}return sData}function _fnSetCellData(oSettings,iRow,iCol,val){var oCol=oSettings.aoColumns[iCol];var oData=oSettings.aoData[iRow]._aData;oCol.fnSetData(oData,val)}function _fnGetObjectDataFn(mSource){if(mSource===null){return function(data){return null}}else if(typeof mSource=='function'){return function(data){return mSource(data)}}else if(typeof mSource=='string'&&mSource.indexOf('.')!=-1){var a=mSource.split('.');if(a.length==2){return function(data){return data[a[0]][a[1]]}}else if(a.length==3){return function(data){return data[a[0]][a[1]][a[2]]}}else{return function(data){for(var i=0,iLen=a.length;i<iLen;i++){data=data[a[i]]}return data}}}else{return function(data){return data[mSource]}}}function _fnSetObjectDataFn(mSource){if(mSource===null){return function(data,val){}}else if(typeof mSource=='function'){return function(data,val){return mSource(data,val)}}else if(typeof mSource=='string'&&mSource.indexOf('.')!=-1){var a=mSource.split('.');if(a.length==2){return function(data,val){data[a[0]][a[1]]=val}}else if(a.length==3){return function(data,val){data[a[0]][a[1]][a[2]]=val}}else{return function(data,val){for(var i=0,iLen=a.length-1;i<iLen;i++){data=data[a[i]]}data[a[a.length-1]]=val}}}else{return function(data,val){data[mSource]=val}}}this.oApi._fnExternApiFunc=_fnExternApiFunc;this.oApi._fnInitalise=_fnInitalise;this.oApi._fnInitComplete=_fnInitComplete;this.oApi._fnLanguageProcess=_fnLanguageProcess;this.oApi._fnAddColumn=_fnAddColumn;this.oApi._fnColumnOptions=_fnColumnOptions;this.oApi._fnAddData=_fnAddData;this.oApi._fnCreateTr=_fnCreateTr;this.oApi._fnGatherData=_fnGatherData;this.oApi._fnBuildHead=_fnBuildHead;this.oApi._fnDrawHead=_fnDrawHead;this.oApi._fnDraw=_fnDraw;this.oApi._fnReDraw=_fnReDraw;this.oApi._fnAjaxUpdate=_fnAjaxUpdate;this.oApi._fnAjaxUpdateDraw=_fnAjaxUpdateDraw;this.oApi._fnAddOptionsHtml=_fnAddOptionsHtml;this.oApi._fnFeatureHtmlTable=_fnFeatureHtmlTable;this.oApi._fnScrollDraw=_fnScrollDraw;this.oApi._fnAjustColumnSizing=_fnAjustColumnSizing;this.oApi._fnFeatureHtmlFilter=_fnFeatureHtmlFilter;this.oApi._fnFilterComplete=_fnFilterComplete;this.oApi._fnFilterCustom=_fnFilterCustom;this.oApi._fnFilterColumn=_fnFilterColumn;this.oApi._fnFilter=_fnFilter;this.oApi._fnBuildSearchArray=_fnBuildSearchArray;this.oApi._fnBuildSearchRow=_fnBuildSearchRow;this.oApi._fnFilterCreateSearch=_fnFilterCreateSearch;this.oApi._fnDataToSearch=_fnDataToSearch;this.oApi._fnSort=_fnSort;this.oApi._fnSortAttachListener=_fnSortAttachListener;this.oApi._fnSortingClasses=_fnSortingClasses;this.oApi._fnFeatureHtmlPaginate=_fnFeatureHtmlPaginate;this.oApi._fnPageChange=_fnPageChange;this.oApi._fnFeatureHtmlInfo=_fnFeatureHtmlInfo;this.oApi._fnUpdateInfo=_fnUpdateInfo;this.oApi._fnFeatureHtmlLength=_fnFeatureHtmlLength;this.oApi._fnFeatureHtmlProcessing=_fnFeatureHtmlProcessing;this.oApi._fnProcessingDisplay=_fnProcessingDisplay;this.oApi._fnVisibleToColumnIndex=_fnVisibleToColumnIndex;this.oApi._fnColumnIndexToVisible=_fnColumnIndexToVisible;this.oApi._fnNodeToDataIndex=_fnNodeToDataIndex;this.oApi._fnVisbleColumns=_fnVisbleColumns;this.oApi._fnCalculateEnd=_fnCalculateEnd;this.oApi._fnConvertToWidth=_fnConvertToWidth;this.oApi._fnCalculateColumnWidths=_fnCalculateColumnWidths;this.oApi._fnScrollingWidthAdjust=_fnScrollingWidthAdjust;this.oApi._fnGetWidestNode=_fnGetWidestNode;this.oApi._fnGetMaxLenString=_fnGetMaxLenString;this.oApi._fnStringToCss=_fnStringToCss;this.oApi._fnArrayCmp=_fnArrayCmp;this.oApi._fnDetectType=_fnDetectType;this.oApi._fnSettingsFromNode=_fnSettingsFromNode;this.oApi._fnGetDataMaster=_fnGetDataMaster;this.oApi._fnGetTrNodes=_fnGetTrNodes;this.oApi._fnGetTdNodes=_fnGetTdNodes;this.oApi._fnEscapeRegex=_fnEscapeRegex;this.oApi._fnDeleteIndex=_fnDeleteIndex;this.oApi._fnReOrderIndex=_fnReOrderIndex;this.oApi._fnColumnOrdering=_fnColumnOrdering;this.oApi._fnLog=_fnLog;this.oApi._fnClearTable=_fnClearTable;this.oApi._fnSaveState=_fnSaveState;this.oApi._fnLoadState=_fnLoadState;this.oApi._fnCreateCookie=_fnCreateCookie;this.oApi._fnReadCookie=_fnReadCookie;this.oApi._fnDetectHeader=_fnDetectHeader;this.oApi._fnGetUniqueThs=_fnGetUniqueThs;this.oApi._fnScrollBarWidth=_fnScrollBarWidth;this.oApi._fnApplyToChildren=_fnApplyToChildren;this.oApi._fnMap=_fnMap;this.oApi._fnGetRowData=_fnGetRowData;this.oApi._fnGetCellData=_fnGetCellData;this.oApi._fnSetCellData=_fnSetCellData;this.oApi._fnGetObjectDataFn=_fnGetObjectDataFn;this.oApi._fnSetObjectDataFn=_fnSetObjectDataFn;var _that=this;return this.each(function(){var i=0,iLen,j,jLen,k,kLen;for(i=0,iLen=_aoSettings.length;i<iLen;i++){if(_aoSettings[i].nTable==this){if(typeof oInit=='undefined'||(typeof oInit.bRetrieve!='undefined'&&oInit.bRetrieve===true)){return _aoSettings[i].oInstance}else if(typeof oInit.bDestroy!='undefined'&&oInit.bDestroy===true){_aoSettings[i].oInstance.fnDestroy();break}else{_fnLog(_aoSettings[i],0,"Cannot reinitialise DataTable.\n\n"+"To retrieve the DataTables object for this table, please pass either no arguments "+"to the dataTable() function, or set bRetrieve to true. Alternatively, to destory "+"the old table and create a new one, set bDestroy to true (note that a lot of "+"changes to the configuration can be made through the API which is usually much "+"faster).");return}}if(_aoSettings[i].sTableId!==""&&_aoSettings[i].sTableId==this.getAttribute('id')){_aoSettings.splice(i,1);break}}var oSettings=new classSettings();_aoSettings.push(oSettings);var bInitHandedOff=false;var bUsePassedData=false;var sId=this.getAttribute('id');if(sId!==null){oSettings.sTableId=sId;oSettings.sInstance=sId}else{oSettings.sInstance=_oExt._oExternConfig.iNextUnique++}if(this.nodeName.toLowerCase()!='table'){_fnLog(oSettings,0,"Attempted to initialise DataTables on a node which is not a "+"table: "+this.nodeName);return}oSettings.nTable=this;oSettings.oInstance=_that.length==1?_that:$(this).dataTable();oSettings.oApi=_that.oApi;oSettings.sDestroyWidth=$(this).width();if(typeof oInit!='undefined'&&oInit!==null){oSettings.oInit=oInit;_fnMap(oSettings.oFeatures,oInit,"bPaginate");_fnMap(oSettings.oFeatures,oInit,"bLengthChange");_fnMap(oSettings.oFeatures,oInit,"bFilter");_fnMap(oSettings.oFeatures,oInit,"bSort");_fnMap(oSettings.oFeatures,oInit,"bInfo");_fnMap(oSettings.oFeatures,oInit,"bProcessing");_fnMap(oSettings.oFeatures,oInit,"bAutoWidth");_fnMap(oSettings.oFeatures,oInit,"bSortClasses");_fnMap(oSettings.oFeatures,oInit,"bServerSide");_fnMap(oSettings.oFeatures,oInit,"bDeferRender");_fnMap(oSettings.oScroll,oInit,"sScrollX","sX");_fnMap(oSettings.oScroll,oInit,"sScrollXInner","sXInner");_fnMap(oSettings.oScroll,oInit,"sScrollY","sY");_fnMap(oSettings.oScroll,oInit,"bScrollCollapse","bCollapse");_fnMap(oSettings.oScroll,oInit,"bScrollInfinite","bInfinite");_fnMap(oSettings.oScroll,oInit,"iScrollLoadGap","iLoadGap");_fnMap(oSettings.oScroll,oInit,"bScrollAutoCss","bAutoCss");_fnMap(oSettings,oInit,"asStripClasses");_fnMap(oSettings,oInit,"fnPreDrawCallback");_fnMap(oSettings,oInit,"fnRowCallback");_fnMap(oSettings,oInit,"fnHeaderCallback");_fnMap(oSettings,oInit,"fnFooterCallback");_fnMap(oSettings,oInit,"fnCookieCallback");_fnMap(oSettings,oInit,"fnInitComplete");_fnMap(oSettings,oInit,"fnServerData");_fnMap(oSettings,oInit,"fnFormatNumber");_fnMap(oSettings,oInit,"aaSorting");_fnMap(oSettings,oInit,"aaSortingFixed");_fnMap(oSettings,oInit,"aLengthMenu");_fnMap(oSettings,oInit,"sPaginationType");_fnMap(oSettings,oInit,"sAjaxSource");_fnMap(oSettings,oInit,"sAjaxDataProp");_fnMap(oSettings,oInit,"iCookieDuration");_fnMap(oSettings,oInit,"sCookiePrefix");_fnMap(oSettings,oInit,"sDom");_fnMap(oSettings,oInit,"bSortCellsTop");_fnMap(oSettings,oInit,"oSearch","oPreviousSearch");_fnMap(oSettings,oInit,"aoSearchCols","aoPreSearchCols");_fnMap(oSettings,oInit,"iDisplayLength","_iDisplayLength");_fnMap(oSettings,oInit,"bJQueryUI","bJUI");_fnMap(oSettings.oLanguage,oInit,"fnInfoCallback");if(typeof oInit.fnDrawCallback=='function'){oSettings.aoDrawCallback.push({"fn":oInit.fnDrawCallback,"sName":"user"})}if(typeof oInit.fnStateSaveCallback=='function'){oSettings.aoStateSave.push({"fn":oInit.fnStateSaveCallback,"sName":"user"})}if(typeof oInit.fnStateLoadCallback=='function'){oSettings.aoStateLoad.push({"fn":oInit.fnStateLoadCallback,"sName":"user"})}if(oSettings.oFeatures.bServerSide&&oSettings.oFeatures.bSort&&oSettings.oFeatures.bSortClasses){oSettings.aoDrawCallback.push({"fn":_fnSortingClasses,"sName":"server_side_sort_classes"})}else if(oSettings.oFeatures.bDeferRender){oSettings.aoDrawCallback.push({"fn":_fnSortingClasses,"sName":"defer_sort_classes"})}if(typeof oInit.bJQueryUI!='undefined'&&oInit.bJQueryUI){oSettings.oClasses=_oExt.oJUIClasses;if(typeof oInit.sDom=='undefined'){oSettings.sDom='<"H"lfr>t<"F"ip>'}}if(oSettings.oScroll.sX!==""||oSettings.oScroll.sY!==""){oSettings.oScroll.iBarWidth=_fnScrollBarWidth()}if(typeof oInit.iDisplayStart!='undefined'&&typeof oSettings.iInitDisplayStart=='undefined'){oSettings.iInitDisplayStart=oInit.iDisplayStart;oSettings._iDisplayStart=oInit.iDisplayStart}if(typeof oInit.bStateSave!='undefined'){oSettings.oFeatures.bStateSave=oInit.bStateSave;_fnLoadState(oSettings,oInit);oSettings.aoDrawCallback.push({"fn":_fnSaveState,"sName":"state_save"})}if(typeof oInit.iDeferLoading!='undefined'){oSettings.bDeferLoading=true;oSettings._iRecordsTotal=oInit.iDeferLoading;oSettings._iRecordsDisplay=oInit.iDeferLoading}if(typeof oInit.aaData!='undefined'){bUsePassedData=true}if(typeof oInit!='undefined'&&typeof oInit.aoData!='undefined'){oInit.aoColumns=oInit.aoData}if(typeof oInit.oLanguage!='undefined'){if(typeof oInit.oLanguage.sUrl!='undefined'&&oInit.oLanguage.sUrl!==""){oSettings.oLanguage.sUrl=oInit.oLanguage.sUrl;$.getJSON(oSettings.oLanguage.sUrl,null,function(json){_fnLanguageProcess(oSettings,json,true)});bInitHandedOff=true}else{_fnLanguageProcess(oSettings,oInit.oLanguage,false)}}}else{oInit={}}if(typeof oInit.asStripClasses=='undefined'){oSettings.asStripClasses.push(oSettings.oClasses.sStripOdd);oSettings.asStripClasses.push(oSettings.oClasses.sStripEven)}var bStripeRemove=false;var anRows=$('>tbody>tr',this);for(i=0,iLen=oSettings.asStripClasses.length;i<iLen;i++){if(anRows.filter(":lt(2)").hasClass(oSettings.asStripClasses[i])){bStripeRemove=true;break}}if(bStripeRemove){oSettings.asDestoryStrips=['',''];if($(anRows[0]).hasClass(oSettings.oClasses.sStripOdd)){oSettings.asDestoryStrips[0]+=oSettings.oClasses.sStripOdd+" "}if($(anRows[0]).hasClass(oSettings.oClasses.sStripEven)){oSettings.asDestoryStrips[0]+=oSettings.oClasses.sStripEven}if($(anRows[1]).hasClass(oSettings.oClasses.sStripOdd)){oSettings.asDestoryStrips[1]+=oSettings.oClasses.sStripOdd+" "}if($(anRows[1]).hasClass(oSettings.oClasses.sStripEven)){oSettings.asDestoryStrips[1]+=oSettings.oClasses.sStripEven}anRows.removeClass(oSettings.asStripClasses.join(' '))}var anThs=[];var aoColumnsInit;var nThead=this.getElementsByTagName('thead');if(nThead.length!==0){_fnDetectHeader(oSettings.aoHeader,nThead[0]);anThs=_fnGetUniqueThs(oSettings)}if(typeof oInit.aoColumns=='undefined'){aoColumnsInit=[];for(i=0,iLen=anThs.length;i<iLen;i++){aoColumnsInit.push(null)}}else{aoColumnsInit=oInit.aoColumns}for(i=0,iLen=aoColumnsInit.length;i<iLen;i++){if(typeof oInit.saved_aoColumns!='undefined'&&oInit.saved_aoColumns.length==iLen){if(aoColumnsInit[i]===null){aoColumnsInit[i]={}}aoColumnsInit[i].bVisible=oInit.saved_aoColumns[i].bVisible}_fnAddColumn(oSettings,anThs?anThs[i]:null)}if(typeof oInit.aoColumnDefs!='undefined'){for(i=oInit.aoColumnDefs.length-1;i>=0;i--){var aTargets=oInit.aoColumnDefs[i].aTargets;if(!$.isArray(aTargets)){_fnLog(oSettings,1,'aTargets must be an array of targets, not a '+(typeof aTargets))}for(j=0,jLen=aTargets.length;j<jLen;j++){if(typeof aTargets[j]=='number'&&aTargets[j]>=0){while(oSettings.aoColumns.length<=aTargets[j]){_fnAddColumn(oSettings)}_fnColumnOptions(oSettings,aTargets[j],oInit.aoColumnDefs[i])}else if(typeof aTargets[j]=='number'&&aTargets[j]<0){_fnColumnOptions(oSettings,oSettings.aoColumns.length+aTargets[j],oInit.aoColumnDefs[i])}else if(typeof aTargets[j]=='string'){for(k=0,kLen=oSettings.aoColumns.length;k<kLen;k++){if(aTargets[j]=="_all"||$(oSettings.aoColumns[k].nTh).hasClass(aTargets[j])){_fnColumnOptions(oSettings,k,oInit.aoColumnDefs[i])}}}}}}if(typeof aoColumnsInit!='undefined'){for(i=0,iLen=aoColumnsInit.length;i<iLen;i++){_fnColumnOptions(oSettings,i,aoColumnsInit[i])}}for(i=0,iLen=oSettings.aaSorting.length;i<iLen;i++){if(oSettings.aaSorting[i][0]>=oSettings.aoColumns.length){oSettings.aaSorting[i][0]=0}var oColumn=oSettings.aoColumns[oSettings.aaSorting[i][0]];if(typeof oSettings.aaSorting[i][2]=='undefined'){oSettings.aaSorting[i][2]=0}if(typeof oInit.aaSorting=="undefined"&&typeof oSettings.saved_aaSorting=="undefined"){oSettings.aaSorting[i][1]=oColumn.asSorting[0]}for(j=0,jLen=oColumn.asSorting.length;j<jLen;j++){if(oSettings.aaSorting[i][1]==oColumn.asSorting[j]){oSettings.aaSorting[i][2]=j;break}}}_fnSortingClasses(oSettings);var thead=$('>thead',this);if(thead.length===0){thead=[document.createElement('thead')];this.appendChild(thead[0])}oSettings.nTHead=thead[0];var tbody=$('>tbody',this);if(tbody.length===0){tbody=[document.createElement('tbody')];this.appendChild(tbody[0])}oSettings.nTBody=tbody[0];var tfoot=$('>tfoot',this);if(tfoot.length>0){oSettings.nTFoot=tfoot[0];_fnDetectHeader(oSettings.aoFooter,oSettings.nTFoot)}if(bUsePassedData){for(i=0;i<oInit.aaData.length;i++){_fnAddData(oSettings,oInit.aaData[i])}}else{_fnGatherData(oSettings)}oSettings.aiDisplay=oSettings.aiDisplayMaster.slice();oSettings.bInitialised=true;if(bInitHandedOff===false){_fnInitalise(oSettings)}})}})(jQuery,window,document);$.fn.wl_Alert=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Alert.methods[method]){return $.fn.wl_Alert.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Alert')){var opts=$.extend({},$this.data('wl_Alert'),method)}else{var opts=$.extend({},$.fn.wl_Alert.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}if(!$this.data('wl_Alert')){$this.data('wl_Alert',{});$this.bind('click.wl_Alert',function(event){event.preventDefault();if(!$this.data('wl_Alert').sticky){$.fn.wl_Alert.methods.close.call($this[0])}}).find('a').bind('click.wl_Alert',function(event){event.stopPropagation()})}else{}if($this.is(':hidden')){$this.slideDown(opts.speed/2)}if(opts)$.extend($this.data('wl_Alert'),opts)})};$.fn.wl_Alert.defaults={speed:500,sticky:false,onBeforeClose:function(element){},onClose:function(element){}};$.fn.wl_Alert.version='1.0';$.fn.wl_Alert.methods={close:function(){var $this=$(this),opts=$this.data('wl_Alert');if(opts.onBeforeClose.call(this,$this)===false){return false};$this.fadeOutSlide(opts.speed,function(){opts.onClose.call($this[0],$this)})},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Alert.defaults[key]!==undefined||$.fn.wl_Alert.defaults[key]==null){$this.data('wl_Alert')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.wl_Alert=function(text,cssclass,insert,after,options){$('div.alert').each(function(){var _this=$(this);if(_this.text()==text){_this.slideUp($.fn.wl_Alert.defaults.speed)}});var al=$('<div class="alert '+cssclass+'">'+text+'</div>').hide();(after)?al.appendTo(insert).wl_Alert():al.prependTo(insert).wl_Alert(options);return al};$.fn.wl_Autocomplete=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Autocomplete.methods[method]){return $.fn.wl_Autocomplete.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Autocomplete')){var opts=$.extend({},$this.data('wl_Autocomplete'),method)}else{var opts=$.extend({},$.fn.wl_Autocomplete.defaults,method,$this.data())}}else{try{return $this.autocomplete(method,args[1],args[2])}catch(e){$.error('Method "'+method+'" does not exist')}}if(!$this.data('wl_Autocomplete')){$this.data('wl_Autocomplete',{});if($.isFunction(window[opts.source])){opts.source=window[opts.source].call(this)}if(typeof opts.source==='string'){opts.source=$.parseData(opts.source,true)}$this.autocomplete(opts)}else{}if(opts)$.extend($this.data('wl_Autocomplete'),opts)})};$.fn.wl_Autocomplete.defaults={};$.fn.wl_Autocomplete.version='1.0';$.fn.wl_Autocomplete.methods={set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Autocomplete.defaults[key]!==undefined||$.fn.wl_Autocomplete.defaults[key]==null){$this.data('wl_Autocomplete')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Breadcrumb=function(method){var args=arguments;return this.each(function(){var $this=$(this),$li=$this.find('li');$a=$this.find('a');if($.fn.wl_Breadcrumb.methods[method]){return $.fn.wl_Breadcrumb.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Breadcrumb')){var opts=$.extend({},$this.data('wl_Breadcrumb'),method)}else{var opts=$.extend({},$.fn.wl_Breadcrumb.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}var $current=$this.find('a.active').eq(0);if(!$current.length)$current=$a.eq(opts.start);if(!$this.data('wl_Breadcrumb')){$this.data('wl_Breadcrumb',{});$a.each(function(i){var _this=$(this);_this.data('id',i);if(opts.numbers)_this.text((i+1)+'. '+_this.text())});$li.each(function(i){var _this=$(this);if(_this.attr('class')){$a.eq(i).wrapInner('<span class="'+_this.attr('class')+'"/>');_this.removeAttr('class')}});if($.browser.msie)$li.filter(':last').addClass('last');$this.delegate('a','click.wl_Breadcrumb',function(){var opts=$this.data('wl_Breadcrumb')||opts;if(opts.disabled)return false;var _this=$(this);if(!opts.allownextonly||_this.data('id')-$this.find('a.active').data('id')<=1){$.fn.wl_Breadcrumb.methods.activate.call($this[0],_this);opts.onChange.call($this[0],_this,_this.data('id'))}return false});if(opts.connect){var $connect=$('#'+opts.connect),$pages=$connect.children();$connect.find('.next').bind('click.wl_Breadcrumb',function(){$this.wl_Breadcrumb('next');return false});$connect.find('.prev').bind('click.wl_Breadcrumb',function(){$this.wl_Breadcrumb('prev');return false});$pages.hide().eq(opts.start).show()}if(opts.disabled){$this.wl_Breadcrumb('disable')}}else{}if(opts)$.extend($this.data('wl_Breadcrumb'),opts);$.fn.wl_Breadcrumb.methods.activate.call(this,$current)})};$.fn.wl_Breadcrumb.defaults={start:0,numbers:false,allownextonly:false,disabled:false,connect:null,onChange:function(){}};$.fn.wl_Breadcrumb.version='1.0';$.fn.wl_Breadcrumb.methods={activate:function(element){var $this=$(this);if(typeof element==='number'){element=$this.find('li').eq(element).find('a');element.trigger('click.wl_Breadcrumb');return false}var _opts=$this.data('wl_Breadcrumb');$this.find('a').removeClass('active previous');element.parent().prevAll().find('a').addClass('previous');element.addClass('active');if(_opts.connect){var $connect=$('#'+_opts.connect),$pages=$connect.children();$pages.hide().eq(element.data('id')).show()}},disable:function(){var $this=$(this);$this.wl_Breadcrumb('set','disabled',true);$this.addClass('disabled')},enable:function(){var $this=$(this);$this.wl_Breadcrumb('set','disabled',false);$this.removeClass('disabled')},next:function(){var $this=$(this);$this.find('a.active').parent().next().find('a').trigger('click.wl_Breadcrumb')},prev:function(){var $this=$(this);$this.find('a.active').parent().prev().find('a').trigger('click.wl_Breadcrumb')},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Breadcrumb.defaults[key]!==undefined||$.fn.wl_Breadcrumb.defaults[key]==null){$this.data('wl_Breadcrumb')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Calendar=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Calendar.methods[method]){return $.fn.wl_Calendar.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Calendar')){var opts=$.extend({},$this.data('wl_Calendar'),method)}else{var opts=$.extend({},$.fn.wl_Calendar.defaults,method,$this.data())}}else{try{return $this.fullCalendar(method,args[1],args[2],args[3],args[4])}catch(e){$.error('Method "'+method+'" does not exist')}}if(!$this.data('wl_Calendar')){$this.data('wl_Calendar',{});opts.theme=true;switch(opts.header){case'small':opts.header={left:'title',right:'prev,next'};break;case'small-today':opts.header={left:'title',right:'prev,today,next'};break;default:}$this.fullCalendar(opts)}else{}if(opts)$.extend($this.data('wl_Calendar'),opts)})};$.fn.wl_Calendar.defaults={};$.fn.wl_Calendar.version='1.0';$.fn.wl_Calendar.methods={set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Calendar.defaults[key]!==undefined||$.fn.wl_Calendar.defaults[key]==null){$this.data('wl_Calendar')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Chart=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Chart.methods[method]){return $.fn.wl_Chart.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Chart')){var opts=$.extend({},$this.data('wl_Chart'),method)}else{var opts=$.extend({},$.fn.wl_Chart.defaults,method,$this.data())}}else{try{return $this.data('wl_Chart').plot[method](args[1],args[2])}catch(e){$.error('Method "'+method+'" does not exist')}}if(!/^(lines|bars|pie)$/.test(opts.type)){$.error('Type of "'+opts.type+'" is not allowed')}if(!$this.data('wl_Chart')){$this.data('wl_Chart',{});$(window).bind('resize.wl_Chart',function(){$this.data('wl_Chart').holder.width('99%');$.fn.wl_Chart.methods.draw.call($this[0])});opts.holder=$('<div/>',{'class':'chart'}).css({width:(opts.width||$this.width()||'100%')/100*99,height:opts.height||300}).insertAfter($this)}else{opts.holder.unbind("plothover").unbind('mouseout')}opts.width=opts.holder.width();(opts.hideTable)?$this.hide():$this.show();opts.holder.bind("plotclick",function(event,pos,item){if(item){var patt={};switch(opts.type){case'bars':patt['value']=item.datapoint[1];patt['label']=item.series.xaxis.ticks[item.dataIndex].label;patt['id']=item.seriesIndex;break;case'pie':patt['value']=item.datapoint[1][0][1];patt['label']=item.series.xaxis.options.ticks[0][1];patt['id']=item.seriesIndex;break;default:patt['value']=item.datapoint[1];patt['label']=item.series.xaxis.ticks[item.datapoint[0]].label;patt['id']=item.seriesIndex}patt['legend']=item.series.label;opts.onClick.call($this[0],patt['value'],patt['legend'],patt['label'],patt['id'],item)}});if(opts.tooltip){opts.holder.tipsy($.extend({},config.tooltip,{fallback:'',followMouse:true,gravity:opts.tooltipGravity||'n'}));var prev=null,text;opts.holder.bind("plothover",function(e,pos,item){if(item){if(item.datapoint.toString()!=prev){var patt={};prev=item.datapoint.toString();switch(opts.type){case'bars':patt['value']=(opts.stack)?item.datapoint[1]-item.datapoint[2]:item.datapoint[1];patt['label']=item.series.xaxis.ticks[item.dataIndex].label;patt['id']=item.seriesIndex;break;case'pie':patt['value']=item.datapoint[1][0][1];patt['label']=item.series.xaxis.options.ticks[0][1];patt['id']=item.seriesIndex;break;default:patt['value']=item.datapoint[1];patt['label']=item.series.xaxis.ticks[item.datapoint[0]].label;patt['id']=item.seriesIndex}patt['legend']=item.series.label;if($.isFunction(opts.tooltipPattern)){text=opts.tooltipPattern.call($this[0],patt['value'],patt['legend'],patt['label'],patt['id'],item)}else{text=opts.tooltipPattern.replace(/%1/g,patt['value']).replace(/%2/g,patt['legend']).replace(/%3/g,patt['label']).replace(/%4/g,patt['id'])}opts.holder.tipsy('setTitel',text);opts.holder.tipsy('show')}else{return}}else{opts.holder.tipsy('hide');prev=null}}).bind('mouseout',function(){opts.holder.tipsy('hide');prev=null})}if(!$.isArray(opts.colors)){opts.colors=$.parseData(opts.colors,true)}var colors=[];if(!$.isEmptyObject(opts.data)){if(opts.xlabels){opts.xlabels=$.map(opts.xlabels,function(value,key){return[[key,value]]})}else{opts.xlabels=function(){var ret=[];$.each(opts.data,function(i,e){$.map(opts.data[i].data,function(value,key){ret[value[0]]=key})});return $.map(ret,function(value,key){return key})}()}colors=$.map(opts.data,function(value,key){return opts.colors[key%opts.colors.length]})}else if($.isEmptyObject(opts.data)&&$this.is('table')){opts.xlabels=opts.xlabels||[];opts.data=[];switch(opts.orientation){case'horizontal':var $xlabels=$this.find('thead th'),$legends=$this.find('tbody th'),$rows=$this.find('tbody tr');var legendlength=$legends.length;if(legendlength)$xlabels=$xlabels.slice(1);$rows.each(function(i,row){var data=$(row).find('td'),_d=[];data.each(function(j,td){var d=parseFloat(td.innerHTML);if(!isNaN(d))_d.push([j,(d||0)]);opts.xlabels.push([j,$xlabels.eq(j).text()])});opts.data.push({'label':$legends.eq(i).text(),'data':(opts.type!='pie')?_d:_d[0][1]});colors[i]=$rows.eq(i).data('color')||opts.colors[i]||colors[i%opts.colors.length]});break;case'vertical':var $xlabels=$this.find('tbody th'),$legends=$this.find('thead th'),$rows=$this.find('tbody tr');var legendlength=$legends.length;if(legendlength){$legends=$legends.slice(1);legendlength--}var _d=[];$rows.each(function(i,row){var data=$(row).find('td');data.each(function(j,td){var d=parseFloat(td.innerHTML);_d[j]=_d[j]||[];if(!isNaN(d))_d[j].push([i,(d||0)])});opts.xlabels.push([i,$xlabels.eq(i).text()])});for(var i=0;i<legendlength;i++){opts.data.push({'label':$legends.eq(i).text(),'data':_d[i]});colors[i]=opts.colors[i]||colors[i%opts.colors.length]}break;default:$.error('Orientation "'+opts.orientation+'" is not allowed')}}else{$.error('No data or data table!')}opts.colors=colors;var std={};switch(opts.type){case'bars':std={points:{show:(opts.points!==null)?opts.points:false},bars:{order:(opts.stack)?null:true,show:true,border:false,fill:(opts.fill!==null)?opts.fill:true,fillColor:(opts.fillColor!==null)?opts.fillColor:null,align:opts.align||'center',horizontal:opts.horizontal||false,barWidth:opts.barWidth||(opts.stack)?0.85:0.85/opts.data.length,lineWidth:(opts.lineWidth!==null)?opts.lineWidth:0},lines:{show:false},pie:{show:false}};break;case'pie':std={points:{show:(opts.points!==null)?opts.points:true},bars:{show:false},lines:{show:false},pie:{show:true,label:true,tilt:opts.tilt||1,innerRadius:(opts.innerRadius)?opts.innerRadius:0,radius:(opts.tilt&&!opts.radius)?0.8:opts.radius||1,shadowSize:2}};break;case'lines':default:std={points:{show:(opts.points!==null)?opts.points:true},bars:{show:false},lines:{show:true,lineWidth:(opts.lineWidth!==null)?opts.lineWidth:4,fill:(opts.fill!==null)?opts.fill:false,fillColor:(opts.fillColor!==null)?opts.fillColor:null},pie:{show:false}}}var options=$.extend(true,{},{series:$.extend(true,{},{stack:(opts.stack)?true:null,points:{show:opts.points}},std),shadowSize:opts.shadowSize||0,grid:{hoverable:opts.tooltip,clickable:true,color:'#666',borderWidth:null},legend:{show:opts.legend,position:(/^(ne|nw|se|sw)$/.test(opts.legendPosition))?opts.legendPosition:'ne'},colors:opts.colors,xaxis:{ticks:opts.xlabels}},opts.flot);opts.flotobj=$.extend({},opts.flotobj,options);if(opts)$.extend($this.data('wl_Chart'),opts);$.fn.wl_Chart.methods.draw.call(this)})};$.fn.wl_Chart.defaults={width:null,height:300,hideTable:true,data:{},stack:false,type:'lines',points:null,shadowSize:2,fill:null,fillColor:null,lineWidth:null,legend:true,legendPosition:"ne",tooltip:true,tooltipGravity:'n',tooltipPattern:function(value,legend,label,id,itemobj){return"value is "+value+" from "+legend+" at "+label+" ("+id+")"},orientation:'horizontal',colors:['#b2e7b2','#f0b7b7','#b5f0f0','#e8e8b3','#efb7ef','#bbb6f0'],flot:{},onClick:function(value,legend,label,id,itemobj){}};$.fn.wl_Chart.version='1.2';$.fn.wl_Chart.methods={draw:function(){var $this=$(this),_opts=$this.data('wl_Chart');$this.data('wl_Chart').plot=$.plot(_opts.holder,_opts.data,_opts.flotobj)},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Chart.defaults[key]!==undefined||$.fn.wl_Chart.defaults[key]==null){$this.data('wl_Chart')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Color=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Color.methods[method]){return $.fn.wl_Color.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Color')){var opts=$.extend({},$this.data('wl_Color'),method)}else{var opts=$.extend({},$.fn.wl_Color.defaults,method,$this.data())}}else{try{return $this.miniColors(method,args[1])}catch(e){$.error('Method "'+method+'" does not exist')}}if(!$this.data('wl_Color')){$this.data('wl_Color',{});$this.bind('mousewheel.wl_Color',function(event,delta){if(opts.mousewheel){event.preventDefault();var delta=(delta<0)?-1:1,hsb=$this.data('hsb');if(event.shiftKey){hsb.s-=delta*2;hsb.s=Math.round(Math.max(0,Math.min(100,hsb.s)))}else if(event.altKey&&event.shiftKey){hsb.h+=delta*5;hsb.h=Math.round(hsb.h)}else{hsb.b+=delta*2;hsb.b=Math.round(Math.max(0,Math.min(100,hsb.b)))}$this.miniColors('value',hsb);$this.trigger('change.wl_Color')}});$this.miniColors($.extend({},{change:function(hex,rgb){$(this).trigger('change.wl_Color')}}),opts).trigger('keyup.miniColors');$this.bind('change.wl_Color',function(){var val=$(this).val();if(val&&!/^#/.test(val))val='#'+val;$(this).val(val);opts.onChange.call($this[0],$(this).data('hsb'),val)}).attr('maxlength',7);var val=$this.val();if(val&&!/^#/.test($this.val())){$this.val('#'+val.substr(0,6))}}else{}if(opts)$.extend($this.data('wl_Color'),opts)})};$.fn.wl_Color.defaults={mousewheel:true,onChange:function(hsb,rgb){}};$.fn.wl_Color.version='1.0';$.fn.wl_Color.methods={destroy:function(){var $this=$(this);$this.removeData('wl_Color');$this.miniColors('destroy')},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Color.defaults[key]!==undefined){$this.data('wl_Color')[key]=value}else if(key=='value'){$this.val(value).trigger('keyup.miniColors')}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Date=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Date.methods[method]){return $.fn.wl_Date.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Date')){var opts=$.extend({},$this.data('wl_Date'),method)}else{var opts=$.extend({},$.fn.wl_Date.defaults,method,$this.data())}}else{try{return $this.datepicker(method,args[1],args[2])}catch(e){$.error('Method "'+method+'" does not exist')}}if(!$this.data('wl_Date')){$this.data('wl_Date',{});$this.datepicker(opts);$this.bind('mousewheel.wl_Date',function(event,delta){if(opts.mousewheel){event.preventDefault();delta=(delta<0)?-1:1;if(event.shiftKey){var _date=$this.datepicker('getDate');delta*=new Date(_date.getFullYear(),_date.getMonth()+1,0).getDate()}$.fn.wl_Date.methods.changeDay.call($this[0],delta)}});if(opts.value){var today=new Date().getTime();switch(opts.value){case'now':case'today':$this.datepicker('setDate',new Date());break;case'next':case'tomorrow':$this.datepicker('setDate',new Date(today+864e5*1));break;case'prev':case'yesterday':$this.datepicker('setDate',new Date(today+864e5*-1));break;default:if(!isNaN(opts.value))$this.datepicker('setDate',new Date(today+864e5*opts.value))}}if(opts.disabled){$.fn.wl_Date.methods.disable.call(this)}}else{}if(opts)$.extend($this.data('wl_Date'),opts)})};$.fn.wl_Date.defaults={value:null,mousewheel:true};$.fn.wl_Date.version='1.0';$.fn.wl_Date.methods={disable:function(){var $this=$(this);$this.datepicker('disable');$this.data('wl_Date').disabled=true},enable:function(){var $this=$(this);$this.datepicker('enable');$this.data('wl_Date').disabled=false},next:function(){$.fn.wl_Date.methods.changeDay.call(this,1)},prev:function(){$.fn.wl_Date.methods.changeDay.call(this,-1)},changeDay:function(delta){var $this=$(this),_current=$this.datepicker('getDate')||new Date();_current.setDate(_current.getDate()+delta);$this.datepicker('setDate',_current)},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Date.defaults[key]!==undefined||$.fn.wl_Date.defaults[key]==null){$this.data('wl_Date')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Editor=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Editor.methods[method]){return $.fn.wl_Editor.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Editor')){var opts=$.extend({},$this.data('wl_Editor'),method)}else{var opts=$.extend({},$.fn.wl_Editor.defaults,method,$this.data())}}else{try{return $this.wysiwyg(method,args[1],args[2],args[3])}catch(e){$.error('Method "'+method+'" does not exist')}}if(!$this.data('wl_Editor')){$this.data('wl_Editor',{});opts.buttons=opts.buttons.split('|')||opts.buttons;opts.eOpts={initialContent:opts.initialContent,css:opts.css};var controls={};$.each(opts.buttons,function(i,id){controls[id]={visible:true}});$.extend(true,opts.eOpts,{controls:controls},opts.eOpts);$this.wysiwyg(opts.eOpts)}else{}if(opts)$.extend($this.data('wl_Editor'),opts)})};$.fn.wl_Editor.defaults={css:'css/light/editor.css',buttons:'bold|italic|underline|strikeThrough|justifyLeft|justifyCenter|justifyRight|justifyFull|highlight|colorpicker|indent|outdent|subscript|superscript|undo|redo|insertOrderedList|insertUnorderedList|insertHorizontalRule|createLink|insertImage|h1|h2|h3|h4|h5|h6|paragraph|rtl|ltr|cut|copy|paste|increaseFontSize|decreaseFontSize|html|code|removeFormat|insertTable',initialContent:""};$.fn.wl_Editor.version='1.1';$.fn.wl_Editor.methods={destroy:function(){var $this=$(this);$this.wysiwyg('destroy');$this.removeData('wl_Editor')},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Editor.defaults[key]!==undefined||$.fn.wl_Editor.defaults[key]==null){$this.data('wl_Editor')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_File=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_File.methods[method]){return $.fn.wl_File.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_File')){var opts=$.extend({},$this.data('wl_File'),method)}else{var opts=$.extend({},$.fn.wl_File.defaults,method,$this.data())}}else{try{return $this.fileupload(method,args[1],args[2],args[3],args[4])}catch(e){$.error('Method "'+method+'" does not exist')}}if(!$this.data('wl_File')){$this.data('wl_File',{});var queue={},files=[],queuelength=0,tempdata,maxNumberOfFiles,dragdropsupport=isEventSupported('dragstart')&&isEventSupported('drop')&&!!window.FileReader;opts.multiple=($this.is('[multiple]')||typeof $this.prop('multiple')==='string')||opts.multiple;opts.queue={};opts.files=[];if(typeof opts.allowedExtensions==='string')opts.allowedExtensions=$.parseData(opts.allowedExtensions);opts.ui=$('<div>',{'class':'fileuploadui'}).insertAfter($this);if(!opts.autoUpload){opts.uiStart=$('<a>',{'class':'btn small fileupload_start','title':opts.text.start}).html(opts.text.start).bind('click',function(){$.each(queue,function(file){upload(queue[file].data)})}).appendTo(opts.ui)}opts.uiCancel=$('<a>',{'class':'btn small fileupload_cancel','title':opts.text.cancel_all}).html(opts.text.cancel_all).appendTo(opts.ui).bind('click',function(){var _this=$(this),el=opts.filepool.find('li');el.addClass('error');if(!$this.data('wl_File'))$this.data('wl_File',tempdata);files=$this.data('wl_File').files=[];queuelength=0;$.each(queue,function(name){if(queue[name]){queue[name].fileupload.abort();delete queue[name]}});el.delay(700).fadeOut(function(){opts.filepool.trigger('change');_this.text(opts.text.cancel_all).attr('title',opts.text.cancel_all);$(this).remove()});opts.onDelete.call($this[0],$.map(el,function(k,v){return $(k).data('fileName')}))});opts.filepool=$('<ul>',{'class':'fileuploadpool'}).insertAfter($this).delegate('a.cancel','click',function(){var el=$(this).parent(),name=el.data('fileName');if(!$this.data('wl_File'))$this.data('wl_File',tempdata);$this.data('wl_File').files=files=$.map(files,function(filename){if(filename!=name)return filename});queue[name].fileupload.abort();delete queue[name];queuelength--;el.addClass('error').delay(700).fadeOut();opts.onCancel.call($this[0],name);opts.filepool.trigger('change')}).delegate('a.remove','click',function(){var el=$(this).parent(),name=el.data('fileName');if(!$this.data('wl_File'))$this.data('wl_File',tempdata);$this.data('wl_File').files=files=$.map(files,function(filename){if(filename!=name)return filename});el.fadeOut();opts.onDelete.call($this[0],[name]);opts.filepool.trigger('change')}).addClass((!opts.multiple)?'single':'multiple').addClass((dragdropsupport)?'drop':'nodrop');$this.fileupload({url:opts.url,dropZone:(opts.dragAndDrop)?opts.filepool:null,fileInput:$this,singleFileUploads:true,sequentialUploads:opts.sequentialUploads,paramName:opts.paramName+'[]',formData:opts.formData,add:function(e,data){if(!opts.multiple){opts.uiCancel.click();opts.filepool.find('li').remove()}$.each(data.files,function(i,file){file.ext=file.name.substring(file.name.lastIndexOf('.')+1).toLowerCase();queuelength++;var error=getError(file);if(!error){addFile(file,data)}else{queuelength--;opts.onFileError.call($this[0],error,file)}});if($this.data('wl_File')){$this.data('wl_File').queue=queue;tempdata=$this.data('wl_File')}else if(tempdata){tempdata.queue=queue}opts.filepool.trigger('change');opts.onAdd.call($this[0],e,data);if(opts.autoUpload)upload(data)},send:function(e,data){$.each(data.files,function(i,file){queue[file.name].element.addClass(data.textStatus);queue[file.name].progress.width('100%');queue[file.name].status.text(opts.text.uploading)});opts.uiCancel.text(opts.text.cancel_all).attr('title',opts.text.cancel_all);return opts.onSend.call($this[0],e,data)},done:function(e,data){$this.data('wl_File',tempdata);$.each(data.files,function(i,file){if(queue[file.name]){queue[file.name].element.addClass(data.textStatus);queue[file.name].progress.width('100%');queue[file.name].status.text(opts.text.done);queue[file.name].cancel.removeAttr('class').addClass('remove').attr('title',opts.text.remove);if($.inArray(file.name,files)==-1){files.push(file.name);$this.data('wl_File').files=files}queuelength--;delete queue[file.name]}});opts.onDone.call($this[0],e,data);if($.isEmptyObject(queue)){opts.filepool.trigger('change');opts.uiCancel.text(opts.text.remove_all).attr('title',opts.text.remove_all);opts.onFinish.call($this[0],e,data)}},fail:function(e,data){opts.onFail.call($this[0],e,data)},always:function(e,data){opts.onAlways.call($this[0],e,data)},progress:function(e,data){$.each(data.files,function(i,file){if(queue[file.name]){var percentage=Math.round(parseInt(data.loaded/data.total*100,10));queue[file.name].progress.width(percentage+'%');queue[file.name].status.text(opts.text.uploading+percentage+'%')}});opts.onProgress.call($this[0],e,data)},progressall:function(e,data){opts.onProgressAll.call($this[0],e,data)},start:function(e){opts.onStart.call($this[0],e)},stop:function(e){opts.onStop.call($this[0],e)},change:function(e,data){opts.onChange.call($this[0],e,data)},drop:function(e,data){opts.onDrop.call($this[0],e,data)},dragover:function(e){opts.onDragOver.call($this[0],e)}})}else{}function upload(data){$.each(data.files,function(i,file){if(queue[file.name])queue[file.name].fileupload=data.submit()})}function addFile(file,data){var name=file.name;var html=$('<li><span class="name">'+name+'</span><span class="progress"></span><span class="status">'+opts.text.ready+'</span><a class="cancel" title="'+opts.text.cancel+'">'+opts.text.cancel+'</a></li>').data('fileName',name).appendTo(opts.filepool);queue[name]={element:html,data:data,progress:html.find('.progress'),status:html.find('.status'),cancel:html.find('.cancel')}}function getError(file){if(opts.maxNumberOfFiles&&(files.length>=opts.maxNumberOfFiles||queuelength>opts.maxNumberOfFiles)){return{msg:'maxNumberOfFiles',code:1}}if(opts.allowedExtensions&&$.inArray(file.ext,opts.allowedExtensions)==-1){return{msg:'allowedExtensions',code:2}}if(typeof file.size==='number'&&opts.maxFileSize&&file.size>opts.maxFileSize){return{msg:'maxFileSize',code:3}}if(typeof file.size==='number'&&opts.minFileSize&&file.size<opts.minFileSize){return{msg:'minFileSize',code:4}}return null}function isEventSupported(eventName){var element=document.createElement('div');eventName='on'+eventName;var isSupported=eventName in element;if(!isSupported){if(!element.setAttribute){element=document.createElement('div')}if(element.setAttribute&&element.removeAttribute){element.setAttribute(eventName,'');isSupported=typeof element[eventName]=='function';if(typeof element[eventName]!=undefined){element[eventName]=undefined}element.removeAttribute(eventName)}}element=null;return isSupported}if(opts)$.extend($this.data('wl_File'),opts)})};$.fn.wl_File.defaults={url:'upload.php',autoUpload:true,paramName:'files',multiple:false,allowedExtensions:false,maxNumberOfFiles:0,maxFileSize:0,minFileSize:0,sequentialUploads:false,dragAndDrop:true,formData:{},text:{ready:'ready',cancel:'cancel',remove:'remove',uploading:'uploading...',done:'done',start:'start upload',add_files:'add files',cancel_all:'cancel upload',remove_all:'remove all'},onAdd:function(e,data){},onDelete:function(files){},onCancel:function(file){},onSend:function(e,data){},onDone:function(e,data){},onFinish:function(e,data){},onFail:function(e,data){},onAlways:function(e,data){},onProgress:function(e,data){},onProgressAll:function(e,data){},onStart:function(e){},onStop:function(e){},onChange:function(e,data){},onDrop:function(e,data){},onDragOver:function(e){},onFileError:function(error,fileobj){}};$.fn.wl_File.version='1.2';$.fn.wl_File.methods={reset:function(){var $this=$(this),opts=$this.data('wl_File');if($.uniform)$this.next().html($.uniform.options.fileDefaultText);opts.filepool.empty();opts.uiCancel.attr('title',opts.text.cancel_all).text(opts.text.cancel_all);$this.data('wl_File').files=[]},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_File.defaults[key]!==undefined||$.fn.wl_File.defaults[key]==null){$this.data('wl_File')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.confirm=function(text,callback,cancelcallback){var options=$.extend(true,{},$.alert.defaults,$.confirm.defaults);if(options.nativ){if(result=confirm(unescape(text))){if($.isFunction(callback))callback.call(this)}else{if($.isFunction(cancelcallback))cancelcallback.call(this)}return}var cb=function(){if($.isFunction(callback))callback.call(this);$(this).dialog('close');$('#wl_dialog').remove()},ccb=function(){if($.isFunction(cancelcallback))cancelcallback.call(this);$(this).dialog('close');$('#wl_dialog').remove()};options=$.extend({},{buttons:[{text:options.text.ok,click:cb},{text:options.text.cancel,click:ccb}]},options);return $.alert(unescape(text),options)};$.confirm.defaults={text:{header:'Please confirm',ok:'Yes',cancel:'No'}};$.prompt=function(text,value,callback,cancelcallback){var options=$.extend(true,{},$.alert.defaults,$.prompt.defaults);if(options.nativ){var val=prompt(unescape($.trim(text)),unescape(value));if($.isFunction(callback)&&val!==null){callback.call(this,val)}else{if($.isFunction(cancelcallback))cancelcallback.call(this)}return}var cb=function(value){if($.isFunction(callback))callback.call(this,value);$(this).dialog('close');$('#wl_dialog').remove()},ccb=function(){if($.isFunction(cancelcallback))cancelcallback.call(this);$(this).dialog('close');$('#wl_dialog').remove()};options=$.extend({},{buttons:[{text:options.text.ok,click:function(){cb.call(this,$('#wl_promptinputfield').val())}},{text:options.text.cancel,click:ccb}],open:function(){$('#wl_promptinputfield').focus().select();$('#wl_promptinputfield').uniform();$('#wl_promptinputform').bind('submit',function(event){event.preventDefault();cb.call(this,$('#wl_promptinputfield').val());$(this).parent().dialog('close');$('#wl_dialog').remove()})}},options);return $.alert('<p>'+unescape(text)+'</p><form id="wl_promptinputform"><input id="wl_promptinputfield" name="wl_promptinputfield" value="'+unescape(value)+'"></form>',options)};$.prompt.defaults={text:{header:'Please prompt',ok:'OK',cancel:'Cancel'}};$.alert=function(content,options){if(!options){var options=$.extend(true,{},{buttons:[{text:$.alert.defaults.text.ok,click:function(){$(this).dialog('close');$('#wl_dialog').remove()}}]},$.alert.defaults)}if(options.nativ){alert(content);return}var container=$('<div/>',{id:'wl_dialog'}).appendTo('body');if(options.text.header){container.attr('title',options.text.header)}container.html(content.replace(/\n/g,'<br>'));container.dialog(options);return{close:function(callback){container.dialog('close');container.remove();if($.isFunction(callback))callback.call(this)},setHeader:function(text){this.set('title',text)},setBody:function(html){container.html(html)},set:function(option,value){container.dialog("option",option,value)}}};$.alert.defaults={nativ:false,resizable:false,modal:true,text:{header:'Notification',ok:'OK'}};$.msg=function(content,options){var options=$.extend({},$.msg.defaults,options);var container=$('#wl_msg'),msgbox;if(!container.length){container=$('<div/>',{id:'wl_msg'}).appendTo('body').data('msgcount',0);var topoffset=parseInt(container.css('top'),10);container.bind('mouseenter',function(){container.data('pause',true)}).bind('mouseleave',function(){container.data('pause',false)});container.delegate('.msg-close','click',function(){container.data('pause',false);close($(this).parent())});container.delegate('.msg-box-close','click',function(){container.fadeOutSlide(options.fadeTime)});$(window).unbind('scroll.wl_msg').bind('scroll.wl_msg',function(){var pos=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;if(pos>topoffset){(window.navigator.standalone===undefined)?container.css({position:'fixed',top:10}):container.css({top:pos+10})}else{(window.navigator.standalone===undefined)?container.removeAttr('style'):container.css({top:topoffset})}}).trigger('scroll.wl_msg')}if(!content)return false;var count=container.data('msgcount');function getHTML(content,headline){return'<div class="msg-box"><h3>'+(headline||'')+'</h3><a class="msg-close">close</a><div class="msg-content">'+content.replace('\n','<br>')+'</div></div>'}function create(){msgbox=$(getHTML(content,options.header)),closeall=$('.msg-box-close');if(count){if(!closeall.length){msgbox.appendTo(container);$('<div class="msg-box-close">close all</div>').appendTo(container).fadeInSlide(options.fadeTime)}else{msgbox.insertBefore(closeall)}}else{msgbox.appendTo(container)}msgbox.fadeInSlide(options.fadeTime);container.data('msgcount',++count);if(!options.sticky){close(msgbox,options.live)}}function close(item,delay,callback){if($.isFunction(delay)){callback=delay;delay=0}else if(!delay){delay=0}setTimeout(function(){if(!container.data('pause')){item.fadeOutSlide(options.fadeTime,function(){var count=$('.msg-box').length;if(count<2&&$('.msg-box-close').length){$('.msg-box-close').fadeOutSlide(options.fadeTime)}container.data('msgcount',count);if($.isFunction(callback))callback.call(item)})}else{close(item,delay)}},delay)}create();return{close:function(callback){close(msgbox,callback)},setHeader:function(text){msgbox.find('h3').eq(0).text(text)},setBody:function(html){msgbox.find('.msg-content').eq(0).html(html)},closeAll:function(callback){container.fadeOutSlide(options.fadeTime,function(){if($.isFunction(callback))callback.call(this)})}}};$.msg.defaults={header:null,live:5000,topoffset:90,fadeTime:500,sticky:false};$(document).ready(function(){$.msg(false)});$.fn.wl_Fileexplorer=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Fileexplorer.methods[method]){return $.fn.wl_Fileexplorer.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Fileexplorer')){var opts=$.extend({},$this.data('wl_Fileexplorer'),method)}else{var opts=$.extend({},$.fn.wl_Fileexplorer.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}if(!$this.data('wl_Fileexplorer')){$this.data('wl_Fileexplorer',{});$this.elfinder(opts)}else{}if(opts)$.extend($this.data('wl_Fileexplorer'),opts)})};$.fn.wl_Fileexplorer.defaults={url:'elfinder/php/connector.php',toolbar:[['back','reload','open','select','quicklook','info','rename','copy','cut','paste','rm','mkdir','mkfile','upload','duplicate','edit','archive','extract','resize','icons','list','help']]};$.fn.wl_Fileexplorer.version='1.0';$.fn.wl_Fileexplorer.methods={set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Fileexplorer.defaults[key]!==undefined||$.fn.wl_Fileexplorer.defaults[key]==null){$this.data('wl_Fileexplorer')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Form=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Form.methods[method]){return $.fn.wl_Form.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Form')){var opts=$.extend({},$this.data('wl_Form'),method)}else{var opts=$.extend({},$.fn.wl_Form.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}var $inputs=$this.find('input,textarea,select,div.date,div.slider'),$submitbtn=(opts.submitButton instanceof jQuery)?opts.submitButton:$this.find(opts.submitButton),$resetbtn=(opts.resetButton instanceof jQuery)?opts.resetButton:$this.find(opts.resetButton);if(!$this.data('wl_Form')){$this.data('wl_Form',{});opts.action=$this.attr('action')||opts.action;opts.method=$this.attr('method')||opts.method;$this.bind({'submit.wl_Form':function(event){event.preventDefault();return false},'reset.wl_Form':function(event){event.preventDefault();return false}});$submitbtn.bind('click.wl_Form',function(event){$.fn.wl_Form.methods.submit.call($this[0]);return false});$resetbtn.bind('click.wl_Form',function(event){$.fn.wl_Form.methods.reset.call($this[0]);return false});$inputs.each(function(){var _this=$(this),_row=_this.closest('section'),_label=_row.find('label').eq(0).html()||this.name||this.id||'';if(_this.is('[required]')||typeof _this.prop('required')=='string'){_this.data('required',true);if(!_row.find('span.required').length)_row.find('label').eq(0).append('&nbsp;<span class="required">&nbsp;</span>')}_this.data('wl_label',_label.replace(/<span>([^<]+)<\/span>|<([^>]+)\/?>/g,''));_this.data('wl_initdata',function(){var _type=_this.attr("type");if(_type=="checkbox"||_type=="radio"){return _this.prop("checked")}else if(_this.data('wl_Date')){return _this.datepicker('getDate')}else if(_this.data('wl_Slider')){if(!_this.data('wl_Slider').connect){if(_this.data('wl_Slider').range){return _this.slider('option','values')}else{return _this.slider('option','value')}}}else{return _this.val()}}())});if(opts.status&&!$submitbtn.closest('div').is('span.wl_formstatus')){$submitbtn.closest('div').append('<span class="wl_formstatus"></span>')}if(opts.parseQuery){$this.wl_Form.methods.unserialize.call(this)}}else{}if(opts)$.extend($this.data('wl_Form'),opts)})};$.fn.wl_Form.defaults={submitButton:'button.submit',resetButton:'button.reset',method:'post',action:null,ajax:true,serialize:false,parseQuery:true,dataType:'text',status:true,sent:false,confirmSend:true,text:{required:'This field is required',valid:'This field is invalid',password:'This password is to short',passwordmatch:'This password doesn\'t match',fileinqueue:'There is at least one file in the queue',incomplete:'Please fill out the form correctly!',send:'send form...',sendagain:'send again?',success:'form sent!',error:'error while sending!',parseerror:'Can\'t unserialize query string:\n %e'},tooltip:{gravity:'nw'},onRequireError:function(element){},onValidError:function(element){},onPasswordError:function(element){},onFileError:function(element){},onBeforePrepare:function(){},onBeforeSubmit:function(data){},onReset:function(){},onComplete:function(textStatus,jqXHR){},onError:function(textStatus,error,jqXHR){},onSuccess:function(data,textStatus,jqXHR){}};$.fn.wl_Form.version='1.3.3';$.fn.wl_Form.methods={disable:function(){var $this=$(this),_inputs=$this.find($this.data('wl_Form').submitButton+',input,textarea,select,div.date,div.slider');_inputs.each(function(){var _this=$(this);if(_this.is('div')){if(_this.is('div.slider')&&_this.data('wl_Slider')){_this.wl_Slider('disable')}else if(_this.is('div.date')&&_this.data('wl_Date')){_this.wl_Date('disable')}}else{_this.prop('disabled',true)}});$this.data('wl_Form').disabled=true},enable:function(){var $this=$(this),_inputs=$this.find($this.data('wl_Form').submitButton+',input,textarea,select,div.date,div.slider');_inputs.each(function(){var _this=$(this);if(_this.is('div')){if(_this.is('div.slider')&&_this.data('wl_Slider')){_this.wl_Slider('enable')}else if(_this.is('div.date')&&_this.data('wl_Date')){_this.wl_Date('enable')}}else{_this.prop('disabled',false)}});$this.data('wl_Form').disabled=false},reset:function(){var $this=$(this),_inputs=$this.find('input,textarea,select,div.date,div.slider');if($this.data('wl_Form').onReset.call($this[0])===false)return false;$this.find('section.error').removeClass('error');_inputs.each(function(){var _this=$(this),_type=_this.attr("type");if(_type=="checkbox"){_this.prop("checked",_this.data('wl_initdata')).trigger('change')}else if(_type=="radio"){_this.prop("checked",_this.data('wl_initdata')).trigger('change')}else if(_this.data('wl_Date')){_this.datepicker('setDate',_this.data('wl_initdata'))}else if(_this.data('wl_Time')){_this.val(_this.data('wl_initdata'))}else if(_this.data('wl_Multiselect')){_this.wl_Multiselect('clear');_this.wl_Multiselect('select',_this.data('wl_initdata'))}else if(_this.data('wl_Slider')){if(!_this.data('wl_Slider').connect){if(_this.data('wl_Slider').range){_this.slider('option','values',$.parseData(_this.data('wl_initdata')))}else{_this.slider('option','value',_this.data('wl_initdata'))}_this.wl_Slider("change");_this.wl_Slider("slide")}}else if(_this.data('wl_File')){_this.wl_File('reset')}else if(_this.data('wl_Editor')){_this.val(_this.data('wl_initdata')).wysiwyg("setContent",_this.data('wl_initdata'))}else if(_this.data('wl_Color')){_this.wl_Color('set','value',_this.data('wl_initdata'))}else{_this.val(_this.data('wl_initdata')).trigger('change');if(_this.is('[placeholder]')){if(_this.data('wl_initdata')==""||_this.data('wl_initdata')==_this.attr("placeholder")){_this.addClass("placeholder").val(_this.attr("placeholder")).data("uservalue",false)}else{_this.removeClass("placeholder").data("uservalue",true)}}}})},submit:function(){var $this=$(this),_data={},_opts=$this.data('wl_Form'),_inputs=$this.find('input,textarea,select,div.date,div.slider'),_statusel=$this.find('.wl_formstatus'),_requiredelements=Array(),_validelements=Array(),_passwordelements=Array(),_fileelements=Array(),_submit=true,_submitbtn=(_opts.submitButton instanceof jQuery)?_opts.submitButton:$this.find(_opts.submitButton),_callbackReturn,_addHiddenField=function(after,id,name,value){if(!$('#'+id).length)$('<input>',{type:'hidden',id:id,name:name,value:value}).insertAfter(after)};_statusel.text("");_inputs.each(function(i,e){var _this=$(this),_row=_this.closest('section');_row.removeClass('error');if(_this.prop('placeholder')&&_this.val()==_this.prop('placeholder')&&!_this.data('uservalue')){_this.val('')}if(_this.data('required')){if((!_this.val()||_this.is(':checkbox')&&!_this.is(':checked'))&&!_this.data('wl_File')){_requiredelements.push(_this);_submit=false}else if(_this.is(':radio')){var checked=$('input[name='+_this.attr('name')+']:checked');if(!checked.length){_requiredelements.push(_this);_submit=false}}else if(_this.data('wl_File')&&!_this.data('wl_File').files.length){_requiredelements.push(_row.find('.fileuploadpool').eq(0));_submit=false}}if(_this.data('wl_Valid')&&!_this.data('wl_Valid').valid){_validelements.push(_this);_submit=false}if(_this.data('wl_File')&&!$.isEmptyObject(_this.data('wl_File').queue)){_fileelements.push(_row.find('.fileuploadpool').eq(0));_submit=false}if(_this.data('wl_Password')){var value=_this.val();if((_this.data('wl_Password').confirm&&_this.data('wl_Password').connect&&value!=$('#'+_this.data('wl_Password').connect).val())||(value&&value.length<_this.data('wl_Password').minLength)){_passwordelements.push(_this);_submit=false}}});if(!_submit){$.each(_requiredelements,function(i,e){var _row=e.closest('section');_row.addClass('error');_opts.onRequireError.call(e[0],e);e.tipsy($.extend({},config.tooltip,_opts.tooltip,{trigger:'manual',fallback:e.data('errortext')||_opts.text.required}));e.tipsy('show');if(e.is(':radio')){var radiosiblings=$('input[name='+e.attr('name')+']');radiosiblings.bind('focus.tooltip, click.tooltip, change.tooltip',function(){e.unbind('focus.tooltip, click.tooltip, change.tooltip').tipsy('hide')})}else{e.bind('focus.tooltip, click.tooltip, change.tooltip',function(){$(this).unbind('focus.tooltip, click.tooltip, change.tooltip').tipsy('hide')})}});$.each(_validelements,function(i,e){var _row=e.closest('section');_row.addClass('error');_opts.onValidError.call(e[0],e);e.tipsy($.extend({},config.tooltip,_opts.tooltip,{trigger:'manual',fallback:e.data('errortext')||e.data('wl_Valid').errortext||_opts.text.valid}));e.tipsy('show');e.bind('focus.tooltip, click.tooltip',function(){$(this).unbind('focus.tooltip, click.tooltip').tipsy('hide')})});$.each(_passwordelements,function(i,e){var text='',value=e.val(),_row=e.closest('section');_row.addClass('error');if(e.data('wl_Password').confirm){var connect=$('#'+e.data('wl_Password').connect);if(value!=connect.val()){connect.tipsy($.extend({},config.tooltip,_opts.tooltip,{trigger:'manual',fallback:connect.data('errortext')||_opts.text.passwordmatch}));connect.tipsy('show');connect.bind('focus.tooltip, click.tooltip',function(){$(this).unbind('focus.tooltip, click.tooltip').tipsy('hide')})}}if(value.length<e.data('wl_Password').minLength){_opts.onPasswordError.call(e[0],e);e.tipsy($.extend({},config.tooltip,_opts.tooltip,{trigger:'manual',fallback:e.data('errortext')||_opts.text.password}));e.tipsy('show');e.bind('focus.tooltip, click.tooltip',function(){$(this).unbind('focus.tooltip, click.tooltip').tipsy('hide')})}});$.each(_fileelements,function(i,e){var _row=e.closest('section');_row.addClass('error');_opts.onFileError.call(e[0],e);e.tipsy($.extend({},config.tooltip,_opts.tooltip,{trigger:'manual',fallback:e.data('errortext')||_opts.text.fileinqueue}));e.tipsy('show');e.bind('focus.tooltip, click.tooltip, change.tooltip',function(){$(this).unbind('focus.tooltip, click.tooltip, change.tooltip').tipsy('hide')})});_statusel.text(_opts.text.incomplete);return false}if(_opts.confirmSend&&_opts.sent===true){$.confirm(_opts.text.sendagain,function(){_opts.sent=false;$.fn.wl_Form.methods.submit.call($this[0])});return false}if(_opts.onBeforePrepare.call($this[0])===false){return false}_inputs.each(function(i,e){var _el=$(e),key=_el.attr('name')||e.id,value=null;if(_el.data('wl_Date')){var connect=$this.find('input[data-connect='+e.id+']').eq(0),dateobj=new Date(_el.datepicker('getDate')),date=dateobj.getFullYear()+'-'+$.leadingZero(dateobj.getMonth()+1)+'-'+$.leadingZero(dateobj.getDate());if(dateobj.getTime()){if(connect.length){value=date+' '+(connect.data('wl_Time').time||'00:00');if(!_opts.ajax)_addHiddenField(_el,key+'_wlHidden',key,value)}else{value=date;if(!_opts.ajax)_el.val(value)}}if(!_opts.ajax&&_el.is('div')){_addHiddenField(_el,key+'_wlHidden',key,value)}_data[key]=value}else if(_el.data('wl_Slider')){if(!_el.data('wl_Slider').connect){if(_el.data('wl_Slider').range!==true){value=_el.slider('option','value');if(!_opts.ajax)_addHiddenField(_el,key+'_wlHidden',key,value)}else{value=_el.slider('option','values');if(!_opts.ajax){for(var i=value.length-1;i>=0;i--){_addHiddenField(_el,key+'_'+i+'_wlHidden',key+'[]',value[i])}}}_data[key]=value}else{if(!_opts.ajax){if(_el.data('wl_Slider').range!==true){var input=$('#'+_el.data('wl_Slider').connect);if(!input.attr('name'))input.attr('name',_el.data('wl_Slider').connect)}else{var connect=$.parseData(_el.data('wl_Slider').connect,true);var input1=$('#'+connect[0]);var input2=$('#'+connect[1]);if(!input1.attr('name'))input1.attr('name',connect[0]);if(!input2.attr('name'))input2.attr('name',connect[1])}}}}else if(_el.data('wl_Editor')){_el.wysiwyg('save');_data[key]=_el.val()}else if(_el.data('wl_File')){_data[key]=_el.data('wl_File').files;if($.isEmptyObject(_data[key])){_data[key]=null;if(!_opts.ajax)_addHiddenField(_el,key+'_wlHidden',key,'null')}else{if(!_opts.ajax){for(var i=_data[key].length-1;i>=0;i--){_addHiddenField(_el,key+'_'+i+'_wlHidden',key+'[]',_data[key][i])}}}}else if(_el.data('wl_Time')){if(!_el.data('wl_Time').connect){_data[key]=_el.data('wl_Time').time;if(!_opts.ajax)_addHiddenField(_el,key+'_wlHidden',key,_el.data('wl_Time').time)}}else if(_el.data('wl_Password')){if(!_el.data('wl_Password').confirmfield)_data[key]=_el.val();if(!_opts.ajax&&_el.data('wl_Password').confirmfield)_el.prop('disabled',true)}else if(_el.is(':radio')){if(_el.is(':checked')){_data[key]=(_el.val()!='on')?_el.val():e.id}}else if(_el.is(':checkbox')){if(/\[\]$/.test(key)){_data[key]=_data[key]||[];if(_el.is(':checked')){var val=_el.val();_data[key].push((val!='on')?val:_el.attr('id')||val)}}else{_data[key]=_el.is(':checked')}if(!_opts.ajax)_addHiddenField(_el,key+'_wlHidden',key,_data[key])}else if(_el.data('wl_Number')){value=_el.val();if(isNaN(value)){value=null}_data[key]=value}else{var val=_el.val();if(/\[\]$/.test(key)&&!$.isArray(val)){_data[key]=_data[key]||[];_data[key].push(val)}else{_data[key]=val}}});var submitbtnname=_submitbtn.attr('name');if(submitbtnname){_data[submitbtnname]=_submitbtn.attr('value')||true;if(!_opts.ajax)_addHiddenField(_submitbtn,submitbtnname+'_wlHidden',submitbtnname,_data[submitbtnname])}_callbackReturn=_opts.onBeforeSubmit.call($this[0],_data);if(_callbackReturn===false){return false}else if(typeof _callbackReturn=='object'){_data=_callbackReturn}if(_opts.serialize){_data=$.param(_data)}_statusel.text(_opts.text.send);if(!_opts.ajax){$this.unbind('submit.wl_Form');$this.submit();return false}$.fn.wl_Form.methods.disable.call(this);$.ajax({url:_opts.action,type:_opts.method,data:_data,dataType:_opts.dataType,success:function(data,textStatus,jqXHR){_statusel.textFadeOut(_opts.text.success);_opts.onSuccess.call($this[0],data,textStatus,jqXHR)},complete:function(jqXHR,textStatus){$.fn.wl_Form.methods.enable.call($this[0]);_opts.sent=true;_opts.onComplete.call($this[0],textStatus,jqXHR)},error:function(jqXHR,textStatus,error){_statusel.text(_opts.text.error);_opts.onError.call($this[0],textStatus,error,jqXHR)}})},unserialize:function(string){var $this=$(this),_searchquery=string||location.search.substr(1);if(_searchquery){try{values=decodeURIComponent(_searchquery).split('&');var serialized_values=[];$.each(values,function(){var properties=this.split("="),key=properties.shift();properties=properties.join('=');if((typeof key!=='undefined')&&(typeof properties!=='undefined')){key=key.replace(/\+/g," ");if(/\[\]$/.test(key)){key=key.replace('[]','');serialized_values[key]=serialized_values[key]||[];serialized_values[key].push(properties.replace(/\+/g," "))}else{serialized_values[key]=properties.replace(/\+/g," ")}}});values=serialized_values;$this.find("input,textarea,select,div.date,div.slider").each(function(){var _this=$(this),_type=_this.attr("type"),tag_name=this.name||this.id;if(/\[\]$/.test(tag_name))tag_name=tag_name.replace('[]','');if(values[tag_name]!=null){if(_type=="checkbox"){_this.data('wl_initdata',(values[tag_name]=='true')).prop("checked",(values[tag_name]=='true'))}else if(_type=="radio"){$('input[id="'+values[tag_name]+'"]').data('wl_initdata',true).attr("checked",true)}else if(_type=="password"){}else if(_this.data('wl_Date')&&_this.is('input')){if(/(\d\d:\d\d)$/.test(values[tag_name])){var time=values[tag_name].substr(11),date=values[tag_name].substr(0,10);_this.data('wl_initdata',new Date(date)).datepicker('setDate',new Date(date));$('input[data-connect="'+tag_name+'"]').data('wl_initdata',time).val(time).data('wl_Time').time=time}else{_this.data('wl_initdata',new Date(values[tag_name])).datepicker('setDate',new Date(values[tag_name]))}}else if(_this.data('wl_Date')&&_this.is('div')){_this.data('wl_initdata',new Date(values[tag_name])).datepicker('setDate',new Date(values[tag_name]))}else if(_this.data('wl_Color')){_this.data('wl_initdata',values[tag_name]).wl_Color('set','value',values[tag_name])}else if(_this.data('wl_Slider')){if(!_this.data('wl_Slider').connect){if(_this.data('wl_Slider').range){_this.slider('option','values',$.parseData(values[tag_name]))}else{_this.slider('option','value',values[tag_name])}_this.data('wl_initdata',values[tag_name]);_this.wl_Slider("change");_this.wl_Slider("slide")}}else if(_this.data('wl_Multiselect')){_this.data('wl_initdata',values[tag_name]).wl_Multiselect('select',values[tag_name])}else if(_this.data('wl_Editor')){_this.data('wl_initdata',values[tag_name]).val(values[tag_name]).wysiwyg("setContent",values[tag_name])}else{_this.data('wl_initdata',values[tag_name]).val(values[tag_name]).trigger('change')}}})}catch(e){$.msg($this.data('wl_Form').text.parseerror.replace('%e',e))}}},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Form.defaults[key]!==undefined&&$.fn.wl_Form.defaults[key]!==null){$this.data('wl_Form')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Gallery=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Gallery.methods[method]){return $.fn.wl_Gallery.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Gallery')){var opts=$.extend({},$this.data('wl_Gallery'),method)}else{var opts=$.extend({},$.fn.wl_Gallery.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}var $items=$this.find('a');if(!$this.data('wl_Gallery')){$this.data('wl_Gallery',{});$this.sortable({containment:$this,opacity:0.8,distance:5,handle:'img',forceHelperSize:true,placeholder:'sortable_placeholder',forcePlaceholderSize:true,start:function(event,ui){$this.dragging=true;ui.item.trigger('mouseleave')},stop:function(event,ui){$this.dragging=false},update:function(event,ui){}});opts.images=[];$items.attr('rel',opts.group).fancybox(opts.fancybox);$items.each(function(){var _this=$(this),_image=_this.find('img'),_append=$('<span>');if(opts.editBtn)_append.append('<a class="edit">Edit</a>');if(opts.deleteBtn)_append.append('<a class="delete">Delete</a>');if(opts.deleteBtn||opts.editBtn)_this.append(_append);opts.images.push({image:_image.attr('rel')||_image.attr('src'),thumb:_image.attr('src'),title:_image.attr('title'),description:_image.attr('alt')})});if(opts.deleteBtn||opts.editBtn){$this.delegate('li','mouseenter',function(event){if(!$this.dragging){var _this=$(this),_img=_this.find('img'),_pan=_this.find('span');_img.animate({top:-20},200);_pan.animate({top:80},200)}}).delegate('li','mouseleave',function(event){var _this=$(this),_img=_this.find('img'),_pan=_this.find('span');_img.animate({top:0},200);_pan.animate({top:140},200)})}if(opts.editBtn){$this.find('a.edit').bind('click.wl_Gallery touchstart.wl_Gallery',function(event){event.stopPropagation();event.preventDefault();var opts=$this.data('wl_Gallery')||opts,_this=$(this),_element=_this.parent().parent().parent(),_href=_element.find('a')[0].href,_title=_element.find('a')[0].title;opts.onEdit.call($this[0],_element,_href,_title);return false})}if(opts.deleteBtn){$this.find('a.delete').bind('click.wl_Gallery touchstart.wl_Gallery',function(event){event.stopPropagation();event.preventDefault();var opts=$this.data('wl_Gallery')||opts,_this=$(this),_element=_this.parent().parent().parent(),_href=_element.find('a')[0].href,_title=_element.find('a')[0].title;opts.onDelete.call($this[0],_element,_href,_title);return false})}}else{}if(opts)$.extend($this.data('wl_Gallery'),opts)})};$.fn.wl_Gallery.defaults={group:'wl_gallery',editBtn:true,deleteBtn:true,fancybox:{},onEdit:function(element,href,title){},onDelete:function(element,href,title){}};$.fn.wl_Gallery.version='1.2';$.fn.wl_Gallery.methods={set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Gallery.defaults[key]!==undefined||$.fn.wl_Gallery.defaults[key]==null){$this.data('wl_Gallery')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Multiselect=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Multiselect.methods[method]){return $.fn.wl_Multiselect.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Multiselect')){var opts=$.extend({},$this.data('wl_Multiselect'),method)}else{var opts=$.extend({},$.fn.wl_Multiselect.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}if(!$this.data('wl_Multiselect')){$this.data('wl_Multiselect',{});$this.hide();$('<div class="comboselectbox"><div class="combowrap"><ul class="comboselect"></ul></div><div class="comboselectbuttons"><a class="add btn"></a><a class="addall btn"></a><a class="removeall btn"></a><a class="remove btn"></a></div><div class="combowrap"><ul class="comboselect"></ul></div></div>').insertAfter($this)}else{}var $box=$this.next('.comboselectbox'),$add=$box.find('a.add'),$remove=$box.find('a.remove'),$addall=$box.find('a.addall'),$removeall=$box.find('a.removeall'),$lists=$box.find('.comboselect'),$i=$([]);var name=$this.attr('name'),j=0,selected=[];opts.pool=$lists.eq(0),opts.selection=$lists.eq(1);if(!/\[\]$/.test(name))$this.attr('name',name+'[]');$box.height(opts.height);if(opts.items.length){if(opts.selected.length&&!$.isArray(opts.selected))opts.selected=[opts.selected];$.each(opts.items,function(i,data){var name,value,selected='';if(typeof data=='object'){name=data.name;value=data.value}else{name=value=data}if(opts.selected.length&&$.inArray(value,opts.selected)!=-1)selected=' selected';$i=$i.add($('<option value="'+value+'"'+selected+'>'+name+'</option>'))});$i.appendTo($this)}$this.bind('change.wl_Multiselect',function(){refreshPositions()});opts.items=[];opts.selected=[];$.each($this.find('option'),function(i,e){var _this=$(this),name=_this.text(),value=_this.val();var item=$('<li><a>'+name+'</a></li>').append('<a class="add"></a>').data({'pos':i,'value':value,'name':name,'native':_this}).appendTo(opts.pool);opts.items[value]=item;if(_this.is(':selected')){opts.selected.push(value);item.clone(true).data({'pos':j++}).attr('data-value',value).append('<a class="remove"></a>').appendTo(opts.selection).find('.add').remove();item.data('native').prop('selected',true);item.addClass('used');if(!opts.showUsed)item.hide()}});$add.bind('click.wl_Multiselect',function(){var selection=$.map(opts.pool.find('li.selected'),function(el){return $(el).data('value')});$this.wl_Multiselect('select',selection)});$remove.bind('click.wl_Multiselect',function(){var selection=$.map(opts.selection.find('li.selected'),function(el){return $(el).data('value')});$this.wl_Multiselect('unselect',selection)});$addall.bind('click.wl_Multiselect',function(){var selection=$.map(opts.pool.find('li'),function(el){return $(el).data('value')});$this.wl_Multiselect('select',selection)});$removeall.bind('click.wl_Multiselect',function(){var selection=$.map(opts.selection.find('li'),function(el){return $(el).data('value')});$this.wl_Multiselect('unselect',selection)});opts.pool.delegate('li','click.wl_Multiselect',{'list':opts.pool},clickHandler).delegate('li','dblclick.wl_Multiselect',function(){$this.wl_Multiselect('select',$(this).data('value'))}).delegate('a.add','click.wl_Multiselect',function(){$this.wl_Multiselect('select',$(this).parent().data('value'))}).disableSelection();opts.selection.delegate('li','click.wl_Multiselect',{'list':opts.selection},clickHandler).delegate('a.remove','click.wl_Multiselect',function(){$this.wl_Multiselect('unselect',$(this).parent().data('value'))});opts.selection.sortable({containment:opts.selection,distance:20,handle:'a:first',forcePlaceholderSize:true,forceHelperSize:true,update:function(){refreshPositions();opts.onSort.call($this[0],$this.data('wl_Multiselect').selected)},items:'li'});function refreshPositions(){var li=opts.pool.find('li').not('.used'),selected=[];$.each(li,function(i){$(this).data('pos',i)});li=opts.selection.find('li');$.each(li,function(i){var _this=$(this);_this.data('pos',i);opts.items[_this.data('value')].data('native').appendTo($this);selected.push(_this.data('value'))});$this.data('wl_Multiselect').selected=selected}function clickHandler(event){var _this=$(this),selected=event.data.list.find('li.selected');if(_this.hasClass('used'))return false;if(!event.shiftKey&&!event.ctrlKey)selected.removeClass('selected');if(event.shiftKey){var first,second,items=event.data.list.find('li').not('.used');if(_this.data('pos')>event.data.list.data('last')){first=event.data.list.data('last');second=_this.data('pos')}else{first=_this.data('pos');second=event.data.list.data('last')}for(var i=first;i<=second;i++){items.eq(i).addClass('selected')}event.data.list.data('last',second)}else{event.data.list.data('last',_this.data('pos'));_this.toggleClass('selected')}return false}if(opts)$.extend($this.data('wl_Multiselect'),opts)})};$.fn.wl_Multiselect.defaults={height:200,items:[],selected:[],showUsed:false,onAdd:function(values){},onRemove:function(values){},onSelect:function(values){},onUnselect:function(values){},onSort:function(values){}};$.fn.wl_Multiselect.version='1.2';$.fn.wl_Multiselect.methods={add:function(items,select){var $this=$(this),opts=$this.data('wl_Multiselect'),i=opts.itemsum||0,_items={};if(typeof items!='object'){_items[items]=items}else if($.isArray(items)){for(var i=0;i<items.length;i++){_items[items[i]]=items[i]}}else{_items=items}$.each(_items,function(value,name){var _native=$('<option value="'+value+'">'+name+'</option>').appendTo($this);var item=$('<li><a>'+name+'</a></li>').append('<a class="add"></a>').data({'pos':i++,'native':_native,'name':name,'value':value}).appendTo(opts.pool);$this.data('wl_Multiselect').items[value]=item;if(select)$this.wl_Multiselect('select',value)});opts.onAdd.call($this[0],$.map(_items,function(k,v){return k}))},remove:function(values){var $this=$(this),opts=$this.data('wl_Multiselect');if(values&&!$.isArray(values)){values=[values]}$this.wl_Multiselect('unselect',values);if(values){$.each(values,function(i,value){var item=opts.items[value];item.data('native').remove();item.remove();delete opts.items[value];$this.data('wl_Multiselect').items=opts.items})}$this.trigger('change.wl_Multiselect');opts.onRemove.call($this[0],values)},select:function(values){var $this=$(this),opts=$this.data('wl_Multiselect');if(values&&!$.isArray(values)){values=[values]}if(values){$.each(values,function(i,value){var item=opts.items[value];if(item.hasClass('used'))return;item.removeClass('selected').clone(true).attr('data-value',value).append('<a class="remove"></a>').appendTo(opts.selection).find('.add').remove();item.data('native').prop('selected',true);item.addClass('used');if(!opts.showUsed)item.hide()})}$this.trigger('change.wl_Multiselect');opts.onSelect.call($this[0],values)},unselect:function(values){var $this=$(this),opts=$this.data('wl_Multiselect');if(values&&!$.isArray(values)){values=[values]}var li=opts.selection.find('li');if(values){$.each(values,function(i,value){var item=opts.items[value];if(!item.hasClass('used'))return;item.data('native').prop('selected',false);li.filter('[data-value="'+value+'"]').remove();item.removeClass('used');if(!opts.showUsed)item.show()})}$this.trigger('change.wl_Multiselect');opts.onUnselect.call($this[0],values)},clear:function(){var $this=$(this),opts=$this.data('wl_Multiselect');$this.wl_Multiselect('unselect',opts.selected);$this.trigger('change.wl_Multiselect')},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Multiselect.defaults[key]!==undefined){$this.data('wl_Multiselect')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Number=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Number.methods[method]){return $.fn.wl_Number.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Number')){var opts=$.extend({},$this.data('wl_Number'),method)}else{var opts=$.extend({},$.fn.wl_Number.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}if(!$this.data('wl_Number')){$this.data('wl_Number',{});opts.min=$this.attr('min')||opts.min;opts.max=$this.attr('max')||opts.max;opts.step=$this.attr('step')||opts.step;$this.bind({'mousewheel.wl_Number':function(event,delta){var opts=$this.data('wl_Number')||opts;if(opts.mousewheel){event.preventDefault();delta=(delta<0)?-1:1;if(event.shiftKey)delta*=10;$.fn.wl_Number.methods.change.call($this[0],delta)}},'change.wl_Number':function(){var _this=$(this);$.fn.wl_Number.methods.correct.call($this[0]);_this.data('wl_Number').onChange.call($this[0],_this.val())}})}else{}if(opts)$.extend($this.data('wl_Number'),opts)})};$.fn.wl_Number.defaults={step:1,decimals:0,start:0,min:null,max:null,mousewheel:true,onChange:function(value){},onError:function(value){}};$.fn.wl_Number.version='1.0';$.fn.wl_Number.methods={correct:function(){var $this=$(this),val=$this.val().replace(/,/g,'.');if(val)$.fn.wl_Number.methods.printValue.call(this,parseFloat(val))},change:function(delta){var $this=$(this),_current=$this.val()||$this.data('wl_Number').start,_new=parseFloat(_current,10)+(delta*$this.data('wl_Number').step);$.fn.wl_Number.methods.printValue.call(this,_new);$this.trigger('change.wl_Number')},printValue:function(value){var $this=$(this),opts=$this.data('wl_Number')||opts;if(isNaN(value)&&value!=''){opts.onError.call(this,$this.val());$this.val(0).focus().select();$this.trigger('change.wl_Number');return}if(opts.min!=null)value=Math.max(opts.min,value);if(opts.max!=null)value=Math.min(opts.max,value);(opts.decimals)?value=parseFloat(value,opts.decimals).toFixed(opts.decimals):value=Math.round(value);$this.val(value)},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Number.defaults[key]!==undefined||$.fn.wl_Number.defaults[key]==null){$this.data('wl_Number')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Password=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($this.data('wl_Password')&&$this.data('wl_Password').confirmfield){return}if($.fn.wl_Password.methods[method]){return $.fn.wl_Password.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Password')){var opts=$.extend({},$this.data('wl_Password'),method)}else{var opts=$.extend({},$.fn.wl_Password.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}if(!$this.data('wl_Password')){$this.data('wl_Password',{});var $strength=$('<div/>',{'class':'passwordstrength'}).appendTo($this.parent()).hide();if(opts.confirm){opts.connect=this.id+'_confirm';var $confirm=$($this.addClass('password').clone()).attr({'id':opts.connect,'name':opts.connect}).appendTo($this.parent()).removeAttr('required').hide();$confirm.data('wl_Password',{confirmfield:true})}$this.bind({'focus.wl_Password':function(){$this.trigger('keyup.wl_Password')},'blur.wl_Password':function(){var opts=$this.data('wl_Password')||opts;if($this.val()){if(opts.confirm&&!$confirm.val())$strength.text(opts.text.confirm)}else{$strength.hide();if(opts.confirm)$confirm.hide()}},'keyup.wl_Password':function(){var opts=$this.data('wl_Password')||opts;if($this.val()){if(opts.confirm)$confirm.show();var _strength=getStrength($this.val(),opts.minLength);if(opts.showStrength){$strength.show();$strength.attr('class','passwordstrength').addClass('s_'+_strength).text(opts.words[_strength])}$this.data('wl_Password').strength=_strength}else{if(opts.showStrength)$strength.hide();if(opts.confirm)$confirm.val('').hide()}}});if(opts.confirm&&opts.showStrength){$confirm.bind('keyup.wl_Password',function(){var opts=$this.data('wl_Password')||opts;if(!$confirm.val()){$strength.text(opts.text.confirm)}else if($confirm.val()!=$this.val()){$strength.text(opts.text.nomatch)}else{$strength.text(opts.words[$this.data('wl_Password').strength])}})}function getStrength(value,minLength){var score=0;if(value.length<minLength){return score}else{score=Math.min(15,(score+(value.length)*2))}if(value.match(/[a-z]/))score+=1;if(value.match(/[A-Z]/))score+=5;if(value.match(/\d+/))score+=5;if(value.match(/(.*[0-9].*[0-9].*[0-9])/))score+=7;if(value.match(/.[!,@,#,$,%,^,&,*,?,_,~]/))score+=5;if(value.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/))score+=7;if(value.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/))score+=2;if(value.match(/([a-zA-Z])/)&&value.match(/([0-9])/))score+=3;if(value.match(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/))score+=3;return Math.min(5,Math.ceil(score/10))}}else{}if(opts)$.extend($this.data('wl_Password'),opts)})};$.fn.wl_Password.defaults={confirm:true,showStrength:true,words:['too short','bad','medium','good','very good','excellent'],minLength:3,text:{confirm:'please confirm',nomatch:'password doesn\'t match'}};$.fn.wl_Password.version='1.0.1';$.fn.wl_Password.methods={set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Password.defaults[key]!==undefined||$.fn.wl_Password.defaults[key]==null){$this.data('wl_Password')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Slider=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Slider.methods[method]){return $.fn.wl_Slider.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Slider')){var opts=$.extend({},$this.data('wl_Slider'),method)}else{var opts=$.extend({},$.fn.wl_Slider.defaults,method,$this.data())}}else{try{return $this.slider(method,args[1],args[2])}catch(e){$.error('Method "'+method+'" does not exist')}}if(!$this.data('wl_Slider')){$this.data('wl_Slider',{});$this.bind('mousewheel.wl_Slider',function(event,delta){if(opts.mousewheel){delta=(delta<0)?-1:1;event.preventDefault();if($this.data('range')!==true){var _value=$this.slider('value');$.fn.wl_Slider.methods.values.call($this[0],_value+(delta*opts.step));if(opts.tooltip){var _handle=$this.find('a');_handle.tipsy('setTitel',opts.tooltipPattern.replace('%n',_value+(delta*opts.step)));_handle.tipsy('update')}}else{var _values=$this.slider('values');var _handler=$this.find('a'),_h1=_handler.eq(0).offset(),_h2=_handler.eq(1).offset();if(opts.orientation=='horizontal'){if(_h1.left+(_h2.left-_h1.left)/2>event.clientX){$.fn.wl_Slider.methods.values.call($this[0],Math.min(_values[0]+(delta*opts.step),_values[1]),_values[1])}else{$.fn.wl_Slider.methods.values.call($this[0],_values[0],Math.max(_values[1]+(delta*opts.step),_values[0]))}}else if(opts.orientation=='vertical'){if(_h2.top+(_h1.top-_h2.top)/2<event.pageY){$.fn.wl_Slider.methods.values.call($this[0],Math.min(_values[0]+(delta*opts.step),_values[1]),_values[1])}else{$.fn.wl_Slider.methods.values.call($this[0],_values[0],Math.max(_values[1]+(delta*opts.step),_values[0]))}}if(opts.tooltip){_handler.eq(0).tipsy('setTitel',opts.tooltipPattern.replace('%n',_values[0]+(delta*opts.step)));_handler.eq(0).tipsy('update');_handler.eq(1).tipsy('setTitel',opts.tooltipPattern.replace('%n',_values[0]+(delta*opts.step)));_handler.eq(1).tipsy('update')}}$.fn.wl_Slider.methods.slide.call($this[0])}})}else{$this.unbind('slide slidechange').slider('destroy')}$this.slider(opts).bind('slide',function(event,ui){$.fn.wl_Slider.methods.slide.call($this[0],ui.value)}).bind('slidechange',function(event,ui){$.fn.wl_Slider.methods.change.call($this[0],ui.value)});if(opts.connect){if($this.data('range')!==true){var _input=$('#'+opts.connect),_value=_input.val()||$this.data('value')||opts.min;if(!_input.data('wl_Number'))_input.wl_Number();$this.unbind('slide slidechange').slider('value',_value);$this.bind('slide',function(event,ui){_input.val(ui.value);$.fn.wl_Slider.methods.slide.call($this[0],ui.value)}).bind('slidechange',function(event,ui){_input.val(ui.value);$.fn.wl_Slider.methods.change.call($this[0],ui.value)});_input.val(_value).wl_Number('set',$.extend({},opts,{onChange:function(value){$this.slider('value',value);$this.wl_Slider('slide');$this.wl_Slider('change')}}))}else{var _input=$.parseData(opts.connect,true),_input1=$('#'+_input[0]),_input2=$('#'+_input[1]),_value1=_input1.val()||$this.data('values')[0]||opts.min,_value2=_input2.val()||$this.data('values')[1]||opts.max;if(!_input1.data('wl_Number'))_input1.wl_Number();if(!_input2.data('wl_Number'))_input2.wl_Number();$this.unbind('slide slidechange').slider('option','values',[_value1,_value2]).bind('slide',function(event,ui){_input1.val(ui.values[0]);_input2.val(ui.values[1]);$.fn.wl_Slider.methods.slide.call($this[0],ui.values)}).bind('slidechange',function(event,ui){_input1.val(ui.values[0]);_input2.val(ui.values[1]);$.fn.wl_Slider.methods.change.call($this[0],ui.values)});_input1.wl_Number('set',$.extend({},opts,{onChange:function(value){$this.slider('option','values',[value,_input2.val()]);_input2.wl_Number('set','min',parseFloat(value));$this.wl_Slider('slide');$this.wl_Slider('change')},min:opts.min,max:_input2.val()||_value2})).val(_value1);_input2.wl_Number('set',$.extend({},opts,{onChange:function(value){$this.slider('option','values',[_input1.val(),value]);_input1.wl_Number('set','max',parseFloat(value));$this.wl_Slider('slide');$this.wl_Slider('change')},min:_input1.val()||_value1,max:opts.max})).val(_value2)}}if(opts.tooltip){var e=$this.find('.ui-slider-handle');var gravity,handles=[];if($.isArray(opts.tooltipGravity)){if(opts.orientation=='horizontal'){gravity=opts.tooltipGravity[0]}else if(opts.orientation=='vertical'){gravity=opts.tooltipGravity[1]}}else{gravity=opts.tooltipGravity}$.each(e,function(i,handle){var value;handles.push($(handle));if(opts.values){value=opts.values}else if(opts.value){value=[opts.value]}else{value=[0,0]}handles[i].tipsy($.extend({},config.tooltip,{trigger:'manual',gravity:gravity,html:true,fallback:opts.tooltipPattern.replace('%n',value[i]),appendTo:handles[i]}));var tip=handles[i].tipsy('tip');tip.find('.tipsy-inner').css('white-space','nowrap');handles[i].bind({'mouseenter.wl_Slider touchstart.wl_Slider':function(){handles[i].tipsy('show')},'mouseleave.wl_Slider touchend.wl_Slider':function(){handles[i].tipsy('hide')},'mouseenter touchstart':function(){handles[i].data('mouseIsOver',true)},'mouseleave touchend':function(){handles[i].data('mouseIsOver',false)}})});$this.bind('slidestart',function(event,ui){$(ui.handle).unbind('mouseleave.wl_Slider touchstart.wl_Slider mouseenter.wl_Slider touchend.wl_Slider')}).bind('slidestop',function(event,ui){var handle=$(ui.handle);handle.bind({'mouseenter.wl_Slider touchstart.wl_Slider':function(){handle.tipsy('show')},'mouseleave.wl_Slider touchend.wl_Slider':function(){handle.tipsy('hide')}});if(!handle.data('mouseIsOver'))handle.tipsy('hide')}).bind('slide',function(event,ui){var handle=$(ui.handle);handle.tipsy('setTitel',opts.tooltipPattern.replace('%n',ui.value));handle.tipsy('update')})}if(opts.disabled){$this.fn.wl_Slider.methods.disable.call($this[0])}if(opts)$.extend($this.data('wl_Slider'),opts)})};$.fn.wl_Slider.defaults={min:0,max:100,step:1,animate:false,disabled:false,orientation:'horizontal',range:false,mousewheel:true,connect:null,tooltip:false,tooltipGravity:['s','w'],tooltipPattern:'%n',onSlide:function(value){},onChange:function(value){}};$.fn.wl_Slider.version='1.1.1';$.fn.wl_Slider.methods={disable:function(){var $this=$(this),opts=$this.data('wl_Slider');$this.slider('disable');if(opts.connect){if($this.data('range')!==true){$('#'+opts.connect).prop('disabled',true)}else{var _input=$.parseData(opts.connect,true),_input1=$('#'+_input[0]),_input2=$('#'+_input[1]);_input1.attr('disabled',true);_input2.attr('disabled',true)}}$this.data('wl_Slider').disabled=true},enable:function(){var $this=$(this),opts=$this.data('wl_Slider');$this.slider('enable');if($this.data('wl_Slider').connect){if($this.data('range')!==true){$('#'+opts.connect).prop('disabled',false)}else{var _input=$.parseData(opts.connect,true),_input1=$('#'+_input[0]),_input2=$('#'+_input[1]);_input1.removeAttr('disabled');_input2.removeAttr('disabled')}}$this.data('wl_Slider').disabled=false},change:function(value){var $this=$(this),opts=$this.data('wl_Slider');if($this.data('range')!==true){opts.onChange.call(this,value||$this.slider('value'))}else{opts.onChange.call(this,value||$this.slider('values'))}},slide:function(value){var $this=$(this),opts=$this.data('wl_Slider');if($this.data('range')!==true){opts.onSlide.call(this,value||$this.slider('value'))}else{opts.onSlide.call(this,value||$this.slider('values'))}},value:function(){var $this=$(this),opts=$this.data('wl_Slider');if(opts.range!==true){$this.slider('value',arguments[0])}},values:function(){var $this=$(this),opts=$this.data('wl_Slider');if(opts.range===true){if(typeof arguments[0]==='object'){$this.slider('values',0,arguments[0][0]);$this.slider('values',1,arguments[0][1])}else{$this.slider('values',0,arguments[0]);$this.slider('values',1,arguments[1])}}else{$.fn.wl_Slider.methods.value.call(this,arguments[0])}},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}if($this.data('wl_Slider').connect){if($this.data('range')!==true){var _input1=$('#'+$this.data('wl_Slider').connect)}else{var _input=$.parseData($this.data('wl_Slider').connect,true),_input1=$('#'+_input[0]),_input2=$('#'+_input[1])}}$.each(options,function(key,value){if($.fn.wl_Slider.defaults[key]!==undefined||$.fn.wl_Slider.defaults[key]==null){$this.slider('option',key,value).data('wl_Slider')[key]=value;if(_input1)_input1.data(key,value).trigger('change');if(_input2)_input2.data(key,value).trigger('change')}else{$.error('Key "'+key+'" is not defined')}})}};$.wl_Store=function(namespace){if(typeof $.jStorage!='object')$.error('wl_Store requires the jStorage library');var namespace=namespace||'wl_store',save=function(key,value){return $.jStorage.set(namespace+'_'+key,value)},get=function(key){return $.jStorage.get(namespace+'_'+key)};remove=function(key){return $.jStorage.deleteKey(namespace+'_'+key)},flush=function(){return $.jStorage.flush()},index=function(){return $.jStorage.index()};return{save:function(key,value){return save(key,value)},get:function(key){return get(key)},remove:function(key){return remove(key)},flush:function(){return flush()},index:function(){return index()}}};$.fn.wl_Time=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Time.methods[method]){return $.fn.wl_Time.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Time')){var opts=$.extend({},$this.data('wl_Time'),method)}else{var opts=$.extend({},$.fn.wl_Time.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}if(!$this.data('wl_Time')){$this.data('wl_Time',{});$this.bind({'mousewheel.wl_Time':function(event,delta){var opts=$this.data('wl_Time')||opts;if(opts.mousewheel){event.preventDefault();delta=(delta<0)?-1:1;if(event.shiftKey)delta*=60/opts.step;$.fn.wl_Time.methods.change.call($this[0],delta)}},'change.wl_Time':function(){var opts=$this.data('wl_Time')||opts;$.fn.wl_Time.methods.correct.call($this[0]);$.fn.wl_Time.methods.printTime.call($this[0]);opts.onChange.call($this[0],opts.time)}}).after('<span class="timeformat"/>').attr('maxlength',5);if(opts.connect!==null){var _date=$('#'+opts.connect),_oldcallback=opts.onDateChange;_callback=function(offset){var current=new Date(_date.datepicker('getDate')).getTime();if(current)_date.datepicker('setDate',new Date(current+(864e5*offset)));_oldcallback.call($this[0],offset)};opts.onDateChange=_callback}if(opts.value){var now=new Date().getTime(),date;switch(opts.value){case'now':date=new Date(now);break;default:if(!isNaN(opts.value))date=new Date(now+(60000*(opts.value%60)))}opts.time=$.leadingZero(date.getHours())+':'+$.leadingZero(date.getMinutes());$this.val(opts.time)}}else{}if(opts)$.extend($this.data('wl_Time'),opts)})};$.fn.wl_Time.defaults={step:5,timeformat:24,roundtime:true,time:null,value:null,mousewheel:true,onDateChange:function(offset){},onHourChange:function(offset){},onChange:function(value){}};$.fn.wl_Time.version='1.0';$.fn.wl_Time.methods={change:function(delta){var $this=$(this),opts=$this.data('wl_Time'),_current=new Date('2010/01/01 '+($this.data('wl_Time').time||'00:00')),_new=new Date(_current.getTime()+(delta*$this.data('wl_Time').step*60000)),_hours=_new.getHours(),_minutes=_new.getMinutes();if(opts.roundtime){_minutes-=(_minutes%$this.data('wl_Time').step)}$this.data('wl_Time').time=$.leadingZero(_hours)+':'+$.leadingZero(_minutes);$.fn.wl_Time.methods.printTime.call(this);opts.onChange.call(this,$this.data('wl_Time').time);if(Math.abs(_current.getMinutes()-_minutes)==(60-opts.step)){opts.onHourChange.call(this,(_hours-_current.getHours()))}if(Math.abs(_current.getHours()-_hours)==(23)){opts.onDateChange.call(this,(_hours)?-1:1)}},printTime:function(){var $this=$(this),opts=$this.data('wl_Time'),time=opts.time;if(time){time=time.split(':');if(opts.timeformat==12){$this.val($.leadingZero(((time[0]%12==0)?12:time[0]%12))+':'+$.leadingZero(time[1])).next().html((time[0]/12>=1)?'pm':'am')}else{$this.val($.leadingZero(time[0])+':'+$.leadingZero(time[1]))}}},correct:function(){var $this=$(this),val=$this.val(),time;if(val=='')return;if(!/^\d+:\d+$/.test(val)){if(val.length==1){val="0"+val+":00"}else if(val.length==2){val=val+":00"}else if(val.length==3){val=val.substr(0,2)+":"+val.substr(2,3)+"0"}else if(val.length==4){val=val.substr(0,2)+":"+val.substr(2,4)}}time=val.split(':');if(!/\d\d:\d\d$/.test(val)&&val!=""||time[0]>23||time[1]>59){$this.val('00:00').focus().select();$this.data('wl_Time').time='00:00';$.fn.wl_Time.methods.printTime.call(this)}else{$this.data('wl_Time').time=val;$.fn.wl_Time.methods.printTime.call(this)}},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Time.defaults[key]!==undefined||$.fn.wl_Time.defaults[key]==null){$this.data('wl_Time')[key]=value;$this.trigger('change.wl_Time')}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Valid=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Valid.methods[method]){return $.fn.wl_Valid.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Valid')){var opts=$.extend({},$this.data('wl_Valid'),method)}else{var opts=$.extend({},$.fn.wl_Valid.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}if(typeof opts.regex==='string'){opts.regex=new RegExp(opts.regex)}if(!$this.data('wl_Valid')){$this.data('wl_Valid',{});$this.bind({'change.wl_Valid':function(){var opts=$this.data('wl_Valid')||opts;$.fn.wl_Valid.methods.validate.call($this[0]);opts.onChange.call($this[0],$this,$this.val());if(!opts.valid){opts.onError.call($this[0],$this,$this.val())}},'keyup.wl_Valid':function(){var opts=$this.data('wl_Valid')||opts;if(opts.instant){if($this.val().length>=$this.data('wl_Valid').minLength){$this.wl_Valid('validate')}}}})}else{}if(opts)$.extend($this.data('wl_Valid'),opts);$.fn.wl_Valid.methods.validate.call($this)})};$.fn.wl_Valid.defaults={errorClass:'error',instant:true,regex:/.*/,minLength:0,onChange:function($this,value){},onError:function($this,value){}};$.fn.wl_Valid.version='1.0';$.fn.wl_Valid.methods={validate:function(){var $this=$(this),opts=$this.data('wl_Valid')||opts,value=$this.val();opts.valid=(!value||opts.regex.test(value));if(opts.valid||(value==$this.attr('placeholder'))){$this.removeClass(opts.errorClass)}else{$this.addClass(opts.errorClass)}},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Valid.defaults[key]!==undefined||$.fn.wl_Valid.defaults[key]==null){switch(key){case'regex':value=new RegExp(value);break;default:}$this.data('wl_Valid')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};$.fn.wl_Mail=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Valid.methods[method]){return $.fn.wl_Valid.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Valid')){var opts=$.extend({},$this.data('wl_Valid'),method)}else{var opts=$.extend({},$.fn.wl_Mail.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}$this.wl_Valid(opts);if(opts)$.extend($this.data('wl_Valid'),opts)})};$.fn.wl_Mail.defaults={regex:/^([\w-]+(?:\.[\w-]+)*)\@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$|(\[?(\d{1,3}\.){3}\d{1,3}\]?)$/i,onChange:function(element,value){element.val(value.toLowerCase())}};$.fn.wl_URL=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Valid.methods[method]){return $.fn.wl_Valid.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Valid')){var opts=$.extend({},$this.data('wl_Valid'),method)}else{var opts=$.extend({},$.fn.wl_URL.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}$this.wl_Valid(opts);if(opts)$.extend($this.data('wl_Valid'),opts)})};$.fn.wl_URL.defaults={regex:/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w]))*\.+(([\w#!:.?+=&%@!\-\/]))?/,instant:false,onChange:function(element,value){if(value!=''&&!/^(ftp|http|https):\/\//.test(value))element.val('http://'+value).trigger('change.wl_Valid')}};$.fn.wl_Widget=function(method){var args=arguments;return this.each(function(){var $this=$(this);if($.fn.wl_Widget.methods[method]){return $.fn.wl_Widget.methods[method].apply(this,Array.prototype.slice.call(args,1))}else if(typeof method==='object'||!method){if($this.data('wl_Widget')){var opts=$.extend({},$this.data('wl_Widget'),method)}else{var opts=$.extend({},$.fn.wl_Widget.defaults,method,$this.data())}}else{$.error('Method "'+method+'" does not exist')}if(!$this.data('wl_Widget')){$this.data('wl_Widget',{});var $widgets=$this.find('div.widget');$widgets.each(function(){var $widget=$(this),_opts=$.extend({},opts,$widget.data()),$handle=$widget.find('h3.handle'),$content=$widget.find('div').eq(0),$container=$widget.parent();$widget.data('wl_Widget',{});if(_opts.icon){$handle.addClass('icon');$('<a>',{'class':'icon i_'+_opts.icon}).appendTo($handle)}if(_opts.sortable){$widget.addClass('sortable')}if(_opts.collapsible){$('<a>',{'class':'collapse','title':_opts.text.collapse}).appendTo($handle);if(_opts.collapsed){$content.hide();$widget.addClass('collapsed');$handle.find('a.collapse').attr('title',_opts.text.expand)}$handle.delegate('a.collapse','click.wl_Widget touchstart.wl_Widget',function(event){var _opts=$widget.data('wl_Widget')||_opts,_content=$widget.find('div').eq(0);if(_content.is(':hidden')){_content.slideDown(100,function(){$widget.removeClass('collapsed').data('wl_Widget').collapsed=false;$handle.find('a.collapse').attr('title',_opts.text.collapse);_opts.onExpand.call($widget[0]);$.fn.wl_Widget.methods.save();$(window).resize()})}else{$content.slideUp(100,function(){$widget.addClass('collapsed').data('wl_Widget').collapsed=true;$handle.find('a.collapse').attr('title',_opts.text.expand);_opts.onCollapse.call($widget[0]);$.fn.wl_Widget.methods.save()})}return false}).bind('dblclick',function(){$handle.find('a.collapse').trigger('click');return false})}$handle.delegate('a.reload','click.wl_Widget touchstart.wl_Widget',function(event){var _opts=$widget.data('wl_Widget')||_opts,_content=$widget.find('div').eq(0);$widget.addClass('loading');_content.height($content.height());if(_opts.removeContent){_content.html(_opts.text.loading)}_content.load(_opts.load,function(response,status,xhr){$widget.removeClass('loading');_content.height('auto');if(status=="error"){_content.html(xhr.status+" "+xhr.statusText)}if(_opts.reload){clearTimeout($widget.data('wl_Widget').timeout);$widget.data('wl_Widget').timeout=setTimeout(function(){$handle.find('a.reload').trigger('click.wl_Widget')},_opts.reload*1000)}});return false});$handle.delegate('a','click.wl_Widget',function(event){event.stopPropagation();return false});if(_opts)$.extend($widget.data('wl_Widget'),_opts);if(_opts.load){$('<a>',{'class':'reload','title':_opts.text.reload}).appendTo($handle).trigger('click.wl_Widget')}});var $maincontent=$('#content');if(!$maincontent.data('wl_Widget')){$maincontent.data('wl_Widget',{containercount:$('div.widgets').length,currentid:1})}if($maincontent.data('wl_Widget').currentid++>=$maincontent.data('wl_Widget').containercount){var $container=$('div.widgets');var wl_Store=new $.wl_Store('wl_'+location.pathname.toString());$container.each(function(i,cont){var widgets=wl_Store.get('widgets_'+i),$cont=$(this);if(!widgets)return false;$.each(widgets,function(widget,options){var _widget=$('#'+widget);(options.collapsed&&_widget.data('wl_Widget').collapsible)?_widget.addClass('collapsed').find('div').eq(0).hide().data('wl_Widget',{collapsed:true}):_widget.removeClass('collapsed').find('div').eq(0).show().data('wl_Widget',{collapsed:false});if(_widget.length&&(_widget.prevAll('div').length!=options.position||_widget.parent()[0]!==$cont[0])){children=$cont.children('div.widget');if(children.eq(options.position).length){_widget.insertBefore(children.eq(options.position))}else if(children.length){_widget.insertAfter(children.eq(options.position-1))}else{_widget.appendTo($cont)}}})});$container.sortable({items:$container.find('div.widget.sortable'),containment:'#content',opacity:0.8,distance:5,handle:'h3.handle',connectWith:$container,forceHelperSize:true,placeholder:'sortable_placeholder',forcePlaceholderSize:true,zIndex:10000,start:function(event,ui){ui.item.data('wl_Widget').onDrag.call(ui.item[0])},stop:function(event,ui){ui.item.data('wl_Widget').onDrop.call(ui.item[0]);$.fn.wl_Widget.methods.save()}})}}else{}if(opts)$.extend($this.data('wl_Widget'),opts)})};$.fn.wl_Widget.defaults={collapsed:false,load:null,reload:false,removeContent:true,collapsible:true,sortable:true,text:{loading:'loading...',reload:'reload',collapse:'collapse widget',expand:'expand widget'},onDrag:function(){},onDrop:function(){},onExpand:function(){},onCollapse:function(){}};$.fn.wl_Widget.version='1.2';$.fn.wl_Widget.methods={save:function(){var $containers=$('div.widgets'),wl_Store=new $.wl_Store('wl_'+location.pathname.toString());$containers.each(function(containerid,e){var _widgets={};$(this).find('div.widget').each(function(pos,e){var _t=$(this);_widgets[this.id]={position:pos,collapsed:_t.find('div').eq(0).is(':hidden')}});wl_Store.save('widgets_'+containerid,_widgets)})},set:function(){var $this=$(this),options={};if(typeof arguments[0]==='object'){options=arguments[0]}else if(arguments[0]&&arguments[1]!==undefined){options[arguments[0]]=arguments[1]}$.each(options,function(key,value){if($.fn.wl_Widget.defaults[key]!==undefined||$.fn.wl_Widget.defaults[key]==null){$this.data('wl_Widget')[key]=value}else{$.error('Key "'+key+'" is not defined')}})}};